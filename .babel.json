{
  "{\"filename\":\"/app/bot.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/bot.js",
      "filenameRelative": "/app/bot.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "bot.js",
      "sourceFileName": "bot.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "bot"
    },
    "ignored": false,
    "code": "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\n\nconst ObjectId = require('mongodb').ObjectID;\nconst schedule = require('node-schedule');\nconst watson = require('watson-developer-cloud');\nconst mongodb = require(\"mongodb\");\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst sRequest = require('sync-request');\nconst request = require('request');\nconst path = require('path');\nconst dbUtil = require('./dbUtil');\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nlet app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function (req, res) {\n  if (req.query['hub.mode'] === 'subscribe' && req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);\n  }\n});\n\n// Display the web page\napp.get('/', function (req, res) {\n  res.writeHead(200, { 'Content-Type': 'text/html' });\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {\n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function (entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function (event) {\n        callUserProfileAPI(event.sender.id, function (body) {\n          var userData = { userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone };\n          getDB(\"User\", function (collection) {\n            if (!containsObject(event.sender.id, collection)) {\n              addDB(\"User\", userData, event.sender.id);\n            }\n            if (event.message) {\n              receivedMessage(event);\n            } else if (event.postback) {\n              receivedPostback(event);\n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      //userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if (cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\n// Incoming events handling\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n\n  if (messageText) {\n    getProperty(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageText);else {\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n    getProperty(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageAttachments);else sendConfirm(senderID, messageAttachments[0].payload.url, messageAttachments[0].type, \"Attachment\");\n    });\n  }\n}\n\nfunction sendConfirm(senderID, url, fileType, message) {\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\" + url;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function (error, response, body) {\n    console.log(\"DONE!\");\n  });\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" + \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\" + \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\nfunction newReminder(senderID, messData) {\n  var respondText;\n  getProperty(senderID, \"User\", \"counter\", function (counter) {\n    getProperty(senderID, \"User\", \"reminder\", function (reminder) {\n      getProperty(senderID, \"User\", \"timezone\", function (timezone) {\n        console.log(counter);\n        if (counter == 0) {\n          reminder.userid = senderID;\n          reminder.content = messData;\n          incrementCounter(senderID);\n          respondText = {\n            text: \"When? (mm/dd/yy-hh:mm)\"\n          };\n        } else if (counter == 1) {\n          var parts = messData;\n          reminder.date = new Date(20 + parts.substr(6, 2), Number(parts.substr(0, 2)) - 1, parts.substr(3, 2), Number(parts.substr(9, 2)), parts.substr(12, 2));\n          var text = checkDate(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") incrementCounter(senderID);\n          respondText = {\n            text: text\n          };\n        } else if (counter == 2) {\n          if (messData !== \"Y\" && messData !== \"N\") {\n            respondText = {\n              text: \"Invalid character, type again (Y/N).\"\n            };\n          } else if (messData == \"N\") {\n            flipCreating(false, senderID);\n            reminder.date.setHours(reminder.date.getHours() - timezone);\n            addDB(\"Reminder\", reminder, senderID, function (doc) {\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function (x) {\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                    if (err) throw err;\n                    if (docs.length != 0) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };\n            replaceCounter(0, senderID);\n            reminder = {};\n          } else {\n            respondText = {\n              text: \"What is the location? Type skip if none\"\n            };\n            incrementCounter(senderID);\n          }\n        } else if (counter == 3) {\n          if (messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = getLocation(messData);\n            var long, lat;\n            var buttons = [];\n            for (var i = 0; i < Math.min(3, places.length); i++) {\n              var button = { type: \"postback\",\n                title: places[i]['name'],\n                payload: JSON.stringify(places[i]) };\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment: {\n                type: \"template\",\n                payload: {\n                  template_type: \"button\",\n                  text: \"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };\n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              \"message\": respondText\n\n            });\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          } else {\n            respondText = {\n              text: \"Attach any files. Type skip of none\"\n            };\n            incrementCounter(senderID);\n          }\n\n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        } else if (counter == 4) {\n          console.log(reminder);\n          reminder.attachment = { url: \"\", type: \"\" };\n          if (messData[0].type) {\n            sendConfirm(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = { url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type };\n          }\n\n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n            text: \"Finshed creating reminder.\"\n          };\n          flipCreating(false, senderID);\n          replaceCounter(0, senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours() - timezone);\n          addDB(\"Reminder\", reminder, senderID, function (doc) {\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function (x) {\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err;\n                var collection = db.collection(\"Reminder\");\n                collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                  if (err) throw err;\n                  if (docs.length != 0) {\n                    if (reminder.attachment) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\": {\n                          \"attachment\": {\n                            \"type\": reminder.attachment.type,\n                            \"payload\": {\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      });\n                    }\n                    if (reminder.location) {\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\": {\n                            \"type\": \"template\",\n                            \"payload\": {\n                              \"template_type\": \"generic\",\n                              \"elements\": [{\n                                \"title\": location.name,\n                                \"image_url\": \"https://maps.googleapis.com/maps/api/staticmap?center=\" + location.latitude + \",\" + location.longitude + \"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\" + location.latitude + \",\" + location.longitude,\n                                \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                \"buttons\": [{\n                                  \"type\": \"web_url\",\n                                  \"url\": \"https://www.google.com/maps/place/\" + location.name + \"/@\" + location.latitude + \",\" + location.longitude,\n                                  \"title\": \"go to Google Map\"\n                                }]\n                              }]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    } else {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        changeReminder(senderID, reminder);\n      });\n    });\n  });\n}\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n\n  //Do Something after users clicked Get Started button \n  if (event.postback.payload === \"GET_STARTED_PAYLOAD\") {\n    callUserProfileAPI(senderID, function (body) {\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, name);\n    });\n  } else {\n    console.log(\"test2\");\n    getProperty(senderID, \"User\", \"reminder\", function (reminder) {\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      console.log(payload);\n      console.log(reminder);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip of none\"\n        }\n      };\n      changeReminder(senderID, reminder);\n      incrementCounter(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: { 'text': messageText },\n    context: context\n  }, function (err, response) {\n    if (err) console.log('error:', err);else {\n\n      var messageData;\n      if (response.intents[0]) {\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n          case 'list':\n            list(senderID, function (str) {\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: str\n                }\n              });\n            });\n            break;\n          case 'next':\n            nextReminder(senderID, function (str) {\n              var options = { weekday: \"long\", year: \"numeric\", month: \"short\",\n                day: \"numeric\" };\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n                }\n              });\n            });\n            break;\n          case 'create':\n            respond = \"What do you want to remind about?\";\n            flipCreating(true, senderID);\n            break;\n          case 'help':\n            callUserProfileAPI(senderID, function (body) {\n              var name = body.fist_name + \" \" + body.fist_name;\n              sendWelcomeMessage(senderID, name);\n            });\n            break;\n          case 'delete':\n            dbUtil.getSortedList(senderID, \"Reminder\", function (list) {\n              var index = Number(messageText.substr(messageText.length - 1, 1)) - 1;\n              if (index >= 0 && index < list.length) {\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({ \"_id\": ObjectId(id) }, function (err, doc) {\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n            break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            response = \"Good bye!\";\n            break;\n          case 'who':\n            response = \"My name is Bob\";\n            break;\n          default:\n            respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        };\n      } else {\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous', 'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington', 'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates', 'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous', 'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner', 'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random() * 6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        };\n      }\n      if (messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });\n}\n//#next\nfunction nextReminder(senderID, cb) {\n  getList(senderID, \"Reminder\", function (list) {\n    if (list[0]) {\n      cb(list[0]);\n    } else cb(\"No Reminder\");\n  });\n}\n\n//#list\nfunction list(senderID, cb) {\n  getProperty(senderID, \"User\", \"timezone\", function (timezone) {\n    dbUtil.getSortedList(senderID, \"Reminder\", function (list) {\n      var i = 1;\n      var str = \"\";\n      list.forEach(function (reminder) {\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours() + timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\") + \"\\n\";\n        i++;\n      });\n      if (!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n}\nfunction containsObject(id, list) {\n  var i;\n  for (i = 0; i < list.length; i++) {\n    if (list[i].userid == id) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction incrementCounter(senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $inc: { \"counter\": 1 } });\n  });\n}\nfunction replaceCounter(value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"counter\": value } });\n  });\n}\nfunction flipCreating(value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"creating\": value } });\n  });\n}\n//Function for database (#database)\nfunction addDB(name, object, senderID, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.insert(object, function (err, docs) {\n      if (err) console.log(err);\n      if (cb) cb(docs);\n      db.close();\n    });\n  });\n}\nfunction getDB(name, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.find({}, { _id: 0 }).toArray(function (err, docs) {\n      db.close();\n      cb(docs);\n    });\n  });\n}\nfunction changeReminder(senderID, value) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"reminder\": value } });\n  });\n}\nfunction getProperty(senderID, collectionName, property, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.findOne({ \"userid\": senderID }, function (err, ret) {\n      cb(ret[property]);\n    });\n  });\n}\nfunction getList(senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n}\n\nfunction checkDate(testDate, parts, timezone) {\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours() - timezone);\n  var year = Number(20 + parts.substr(6, 2));\n  var month = Number(parts.substr(0, 2)) - 1;\n  var date = Number(parts.substr(3, 2));\n  var hour = Number(parts.substr(9, 2));\n  var minute = Number(parts.substr(12, 2));\n  if (curDate.getTime() > testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours() + timezone);\n  if (year != testDate.getFullYear() || month != testDate.getMonth() || date != testDate.getDate() || hour != testDate.getHours() || minute != testDate.getMinutes()) {\n    return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n}\n\nfunction getLocation(location) {\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n    timeout: 10000\n  });\n  var data = JSON.parse(res.getBody('utf8'));\n\n  for (var i = 0; i < data.results.length; i++) {\n    var place = { \"name\": data.results[i][\"formatted_address\"],\n      \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n      \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n    };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }\n  return places;\n}\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvdC5qcyJdLCJuYW1lcyI6WyJPYmplY3RJZCIsInJlcXVpcmUiLCJPYmplY3RJRCIsInNjaGVkdWxlIiwid2F0c29uIiwibW9uZ29kYiIsImV4cHJlc3MiLCJib2R5UGFyc2VyIiwic1JlcXVlc3QiLCJyZXF1ZXN0IiwicGF0aCIsImRiVXRpbCIsImh0dHAiLCJmcyIsIm1lc3NlbmdlckJ1dHRvbiIsInVzZXJOYW1lIiwiY29udmVyc2F0aW9uIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInZlcnNpb24iLCJ2ZXJzaW9uX2RhdGUiLCJjb250ZXh0IiwiYXBwIiwidXNlIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsIk1vbmdvQ2xpZW50IiwidXJsMSIsImdldCIsInJlcSIsInJlcyIsInF1ZXJ5IiwicHJvY2VzcyIsImVudiIsIlZFUklGWV9UT0tFTiIsImNvbnNvbGUiLCJsb2ciLCJzdGF0dXMiLCJzZW5kIiwiZXJyb3IiLCJzZW5kU3RhdHVzIiwid3JpdGVIZWFkIiwid3JpdGUiLCJlbmQiLCJwb3N0IiwiZGF0YSIsImJvZHkiLCJvYmplY3QiLCJlbnRyeSIsImZvckVhY2giLCJwYWdlSUQiLCJpZCIsInRpbWVPZkV2ZW50IiwidGltZSIsIm1lc3NhZ2luZyIsImV2ZW50IiwiY2FsbFVzZXJQcm9maWxlQVBJIiwic2VuZGVyIiwidXNlckRhdGEiLCJ1c2VyaWQiLCJjb3VudGVyIiwia2V5d29yZHMiLCJjcmVhdGluZyIsInJlbWluZGVyIiwidGltZXpvbmUiLCJnZXREQiIsImNvbGxlY3Rpb24iLCJjb250YWluc09iamVjdCIsImFkZERCIiwibWVzc2FnZSIsInJlY2VpdmVkTWVzc2FnZSIsInBvc3RiYWNrIiwicmVjZWl2ZWRQb3N0YmFjayIsInNlbmRlcklEIiwiY2IiLCJ1cmkiLCJQQUdFX0FDQ0VTU19UT0tFTiIsIm1ldGhvZCIsInJlc3BvbnNlIiwic3RhdHVzQ29kZSIsIkpTT04iLCJwYXJzZSIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJyZWNpcGllbnRJRCIsInJlY2lwaWVudCIsInRpbWVPZk1lc3NhZ2UiLCJ0aW1lc3RhbXAiLCJtZXNzYWdlSWQiLCJtaWQiLCJtZXNzYWdlVGV4dCIsInRleHQiLCJtZXNzYWdlQXR0YWNobWVudHMiLCJhdHRhY2htZW50cyIsImdldFByb3BlcnR5IiwicCIsIm5ld1JlbWluZGVyIiwic2VuZFRleHRNZXNzYWdlIiwic2VuZENvbmZpcm0iLCJwYXlsb2FkIiwidXJsIiwidHlwZSIsImZpbGVUeXBlIiwicmVwbGFjZSIsInVybFJlcSIsInNlbmRXZWxjb21lTWVzc2FnZSIsInNlbmRlcklkIiwibmFtZSIsIm1lc3NhZ2VEYXRhIiwiY2FsbFNlbmRBUEkiLCJzZW5kSGVscE1lc3NhZ2UiLCJtZXNzRGF0YSIsInJlc3BvbmRUZXh0IiwiY29udGVudCIsImluY3JlbWVudENvdW50ZXIiLCJwYXJ0cyIsImRhdGUiLCJEYXRlIiwic3Vic3RyIiwiTnVtYmVyIiwiY2hlY2tEYXRlIiwiZmxpcENyZWF0aW5nIiwic2V0SG91cnMiLCJnZXRIb3VycyIsImRvYyIsIm9wcyIsInNjaGVkdWxlSm9iIiwieCIsImNvbm5lY3QiLCJlcnIiLCJkYiIsImZpbmQiLCJfaWQiLCJ0b0FycmF5IiwiZG9jcyIsImxlbmd0aCIsInJlbW92ZSIsImNsb3NlIiwiYmluZCIsInJlcGxhY2VDb3VudGVyIiwicGxhY2VzIiwiZ2V0TG9jYXRpb24iLCJsb25nIiwibGF0IiwiYnV0dG9ucyIsImkiLCJNYXRoIiwibWluIiwiYnV0dG9uIiwidGl0bGUiLCJzdHJpbmdpZnkiLCJwdXNoIiwiYXR0YWNobWVudCIsInRlbXBsYXRlX3R5cGUiLCJsb2NhdGlvbiIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiY2hhbmdlUmVtaW5kZXIiLCJ0aW1lT2ZQb3N0YmFjayIsImZpc3RfbmFtZSIsIndvcmtzcGFjZV9pZCIsImlucHV0IiwiaW50ZW50cyIsImNvbW1hbmQiLCJpbnRlbnQiLCJyZXNwb25kIiwibGlzdCIsInN0ciIsIm5leHRSZW1pbmRlciIsIm9wdGlvbnMiLCJ3ZWVrZGF5IiwieWVhciIsIm1vbnRoIiwiZGF5IiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwiZ2V0U29ydGVkTGlzdCIsImluZGV4IiwiZnVubnlRdW90ZXMiLCJmbG9vciIsInJhbmRvbSIsInFzIiwiYWNjZXNzX3Rva2VuIiwicmVjaXBpZW50SWQiLCJyZWNpcGllbnRfaWQiLCJtZXNzYWdlX2lkIiwiZ2V0TGlzdCIsImdldERhdGUiLCJnZXRNb250aCIsImdldEZ1bGxZZWFyIiwiaG91ciIsIm1pbnV0ZSIsImdldE1pbnV0ZXMiLCJ1bmRlZmluZWQiLCJmaW5kT25lQW5kVXBkYXRlIiwiJGluYyIsInZhbHVlIiwiJHNldCIsImluc2VydCIsImNvbGxlY3Rpb25OYW1lIiwicHJvcGVydHkiLCJmaW5kT25lIiwicmV0IiwidGVzdERhdGUiLCJjdXJEYXRlIiwiZ2V0VGltZSIsIkdPT0dMRV9BUElfS0VZIiwidGltZW91dCIsImdldEJvZHkiLCJyZXN1bHRzIiwicGxhY2UiLCJzZXJ2ZXIiLCJsaXN0ZW4iLCJQT1JUIiwiYWRkcmVzcyIsInBvcnQiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLE1BQU1BLFdBQVdDLFFBQVEsU0FBUixFQUFtQkMsUUFBcEM7QUFDQSxNQUFNQyxXQUFXRixRQUFRLGVBQVIsQ0FBakI7QUFDQSxNQUFNRyxTQUFTSCxRQUFRLHdCQUFSLENBQWY7QUFDQSxNQUFNSSxVQUFVSixRQUFRLFNBQVIsQ0FBaEI7QUFDQSxNQUFNSyxVQUFVTCxRQUFRLFNBQVIsQ0FBaEI7QUFDQSxNQUFNTSxhQUFhTixRQUFRLGFBQVIsQ0FBbkI7QUFDQSxNQUFNTyxXQUFXUCxRQUFRLGNBQVIsQ0FBakI7QUFDQSxNQUFNUSxVQUFVUixRQUFRLFNBQVIsQ0FBaEI7QUFDQSxNQUFNUyxPQUFPVCxRQUFRLE1BQVIsQ0FBYjtBQUNBLE1BQU1VLFNBQVNWLFFBQVEsVUFBUixDQUFmO0FBQ0EsSUFBSVcsT0FBT1gsUUFBUSxPQUFSLENBQVg7QUFDQSxJQUFJWSxLQUFLWixRQUFRLElBQVIsQ0FBVDs7QUFFQSxJQUFJYSxrQkFBa0IsK1hBQXRCO0FBQ0E7QUFDQSxJQUFJQyxXQUFXLE1BQWY7QUFDQTtBQUNBLElBQUlDLGVBQWVaLE9BQU9ZLFlBQVAsQ0FBb0I7QUFDckNDLFlBQVUsc0NBRDJCO0FBRXJDQyxZQUFVLGNBRjJCO0FBR3JDQyxXQUFTLElBSDRCO0FBSXJDQyxnQkFBYztBQUp1QixDQUFwQixDQUFuQjtBQU1BLElBQUlDLFVBQVUsRUFBZDtBQUNBO0FBQ0EsSUFBSUMsTUFBTWhCLFNBQVY7O0FBRUFnQixJQUFJQyxHQUFKLENBQVFoQixXQUFXaUIsSUFBWCxFQUFSO0FBQ0FGLElBQUlDLEdBQUosQ0FBUWhCLFdBQVdrQixVQUFYLENBQXNCO0FBQzVCQyxZQUFVO0FBRGtCLENBQXRCLENBQVI7QUFHQTtBQUNBLElBQUlDLGNBQWN0QixRQUFRc0IsV0FBMUI7QUFDQSxJQUFJQyxPQUFPLG9FQUFYO0FBQ0E7QUFDQU4sSUFBSU8sR0FBSixDQUFRLFVBQVIsRUFBb0IsVUFBU0MsR0FBVCxFQUFjQyxHQUFkLEVBQW1CO0FBQ3JDLE1BQUlELElBQUlFLEtBQUosQ0FBVSxVQUFWLE1BQTBCLFdBQTFCLElBQ0FGLElBQUlFLEtBQUosQ0FBVSxrQkFBVixNQUFrQ0MsUUFBUUMsR0FBUixDQUFZQyxZQURsRCxFQUNnRTtBQUM5REMsWUFBUUMsR0FBUixDQUFZLG9CQUFaO0FBQ0FOLFFBQUlPLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQlQsSUFBSUUsS0FBSixDQUFVLGVBQVYsQ0FBckI7QUFDRCxHQUpELE1BSU87QUFDTEksWUFBUUksS0FBUixDQUFjLDJEQUFkO0FBQ0FULFFBQUlVLFVBQUosQ0FBZSxHQUFmO0FBQ0Q7QUFDRixDQVREOztBQVdBO0FBQ0FuQixJQUFJTyxHQUFKLENBQVEsR0FBUixFQUFhLFVBQVNDLEdBQVQsRUFBY0MsR0FBZCxFQUFtQjtBQUM5QkEsTUFBSVcsU0FBSixDQUFjLEdBQWQsRUFBbUIsRUFBQyxnQkFBZ0IsV0FBakIsRUFBbkI7QUFDQVgsTUFBSVksS0FBSixDQUFVN0IsZUFBVjtBQUNBaUIsTUFBSWEsR0FBSjtBQUNELENBSkQ7O0FBTUE7QUFDQXRCLElBQUl1QixJQUFKLENBQVMsVUFBVCxFQUFxQixVQUFVZixHQUFWLEVBQWVDLEdBQWYsRUFBb0I7QUFDdkMsTUFBSWUsT0FBT2hCLElBQUlpQixJQUFmO0FBQ0EsTUFBSUQsS0FBS0UsTUFBTCxLQUFnQixNQUFwQixFQUE0QjtBQUMxQjtBQUNBRixTQUFLRyxLQUFMLENBQVdDLE9BQVgsQ0FBbUIsVUFBU0QsS0FBVCxFQUFnQjtBQUNqQyxVQUFJRSxTQUFTRixNQUFNRyxFQUFuQjtBQUNBLFVBQUlDLGNBQWNKLE1BQU1LLElBQXhCO0FBQ0E7QUFDQUwsWUFBTU0sU0FBTixDQUFnQkwsT0FBaEIsQ0FBd0IsVUFBU00sS0FBVCxFQUFnQjtBQUN0Q0MsMkJBQW1CRCxNQUFNRSxNQUFOLENBQWFOLEVBQWhDLEVBQW9DLFVBQVNMLElBQVQsRUFBYztBQUNoRCxjQUFJWSxXQUFXLEVBQUNDLFFBQVFKLE1BQU1FLE1BQU4sQ0FBYU4sRUFBdEIsRUFBMEJTLFNBQVMsQ0FBbkMsRUFBc0NDLFVBQVUsRUFBaEQsRUFBb0RDLFVBQVUsS0FBOUQsRUFBcUVDLFVBQVUsRUFBL0UsRUFBbUZDLFVBQVVsQixLQUFLa0IsUUFBbEcsRUFBZjtBQUNBQyxnQkFBTSxNQUFOLEVBQWMsVUFBU0MsVUFBVCxFQUFvQjtBQUNoQyxnQkFBRyxDQUFDQyxlQUFlWixNQUFNRSxNQUFOLENBQWFOLEVBQTVCLEVBQWdDZSxVQUFoQyxDQUFKLEVBQWdEO0FBQzlDRSxvQkFBTSxNQUFOLEVBQWNWLFFBQWQsRUFBd0JILE1BQU1FLE1BQU4sQ0FBYU4sRUFBckM7QUFDRDtBQUNELGdCQUFJSSxNQUFNYyxPQUFWLEVBQW1CO0FBQ2pCQyw4QkFBZ0JmLEtBQWhCO0FBQ0QsYUFGRCxNQUVPLElBQUlBLE1BQU1nQixRQUFWLEVBQW9CO0FBQ3pCQywrQkFBaUJqQixLQUFqQjtBQUNELGFBRk0sTUFFQTtBQUNMcEIsc0JBQVFDLEdBQVIsQ0FBWSxrQ0FBWixFQUFnRG1CLEtBQWhEO0FBQ0Q7QUFDRixXQVhEO0FBWUQsU0FkRDtBQWdCRCxPQWpCRDtBQWtCRCxLQXRCRDs7QUF3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBekIsUUFBSVUsVUFBSixDQUFlLEdBQWY7QUFDRDtBQUNGLENBbkNEOztBQXFDQTtBQUNBLFNBQVNnQixrQkFBVCxDQUE0QmlCLFFBQTVCLEVBQXNDQyxFQUF0QyxFQUF5QztBQUN2Q2xFLFVBQVE7QUFDTm1FLFNBQUsscUNBQXFDRixRQUFyQyxHQUFnRCxxREFBaEQsR0FBd0d6QyxRQUFRQyxHQUFSLENBQVkyQyxpQkFEbkg7QUFFTkMsWUFBUTtBQUZGLEdBQVIsRUFHRyxVQUFTdEMsS0FBVCxFQUFnQnVDLFFBQWhCLEVBQTBCaEMsSUFBMUIsRUFBZ0M7QUFDakMsUUFBSSxDQUFDUCxLQUFELElBQVV1QyxTQUFTQyxVQUFULElBQXVCLEdBQXJDLEVBQTBDO0FBQ3hDakMsYUFBT2tDLEtBQUtDLEtBQUwsQ0FBV25DLElBQVgsQ0FBUDtBQUNBO0FBQ0FYLGNBQVFDLEdBQVIsQ0FBWSxxREFBcURVLEtBQUtvQyxVQUExRCxHQUF1RSxHQUF2RSxHQUE2RXBDLEtBQUtxQyxTQUE5RjtBQUNBLFVBQUdULEVBQUgsRUFBT0EsR0FBRzVCLElBQUg7QUFDUixLQUxELE1BS087QUFDTFgsY0FBUUksS0FBUixDQUFjLHlCQUFkO0FBQ0E7QUFDQTtBQUNEO0FBQ0YsR0FkRDtBQWVEOztBQUVEO0FBQ0EsU0FBUytCLGVBQVQsQ0FBeUJmLEtBQXpCLEVBQWdDO0FBQzlCLE1BQUlrQixXQUFXbEIsTUFBTUUsTUFBTixDQUFhTixFQUE1QjtBQUNBLE1BQUlpQyxjQUFjN0IsTUFBTThCLFNBQU4sQ0FBZ0JsQyxFQUFsQztBQUNBLE1BQUltQyxnQkFBZ0IvQixNQUFNZ0MsU0FBMUI7QUFDQSxNQUFJbEIsVUFBVWQsTUFBTWMsT0FBcEI7O0FBRUFsQyxVQUFRQyxHQUFSLENBQVksOERBQVosRUFDRXFDLFFBREYsRUFDWVcsV0FEWixFQUN5QkUsYUFEekI7O0FBR0EsTUFBSUUsWUFBWW5CLFFBQVFvQixHQUF4Qjs7QUFFQSxNQUFJQyxjQUFjckIsUUFBUXNCLElBQTFCO0FBQ0EsTUFBSUMscUJBQXFCdkIsUUFBUXdCLFdBQWpDOztBQUVBLE1BQUlILFdBQUosRUFBaUI7QUFDZkksZ0JBQVlyQixRQUFaLEVBQXNCLE1BQXRCLEVBQThCLFVBQTlCLEVBQTBDLFVBQVNzQixDQUFULEVBQVc7QUFDbkQsVUFBR0EsQ0FBSCxFQUFNQyxZQUFZdkIsUUFBWixFQUFzQmlCLFdBQXRCLEVBQU4sS0FDSTtBQUNGLGdCQUFRQSxXQUFSO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFTyw0QkFBZ0J4QixRQUFoQixFQUEwQmlCLFdBQTFCO0FBTko7QUFRRDtBQUNGLEtBWkQ7QUFhRDtBQUNELE1BQUlFLGtCQUFKLEVBQXdCO0FBQ3BCRSxnQkFBWXJCLFFBQVosRUFBc0IsTUFBdEIsRUFBOEIsVUFBOUIsRUFBMEMsVUFBU3NCLENBQVQsRUFBVztBQUNuRCxVQUFHQSxDQUFILEVBQU1DLFlBQVl2QixRQUFaLEVBQXNCbUIsa0JBQXRCLEVBQU4sS0FDS00sWUFBWXpCLFFBQVosRUFBc0JtQixtQkFBbUIsQ0FBbkIsRUFBc0JPLE9BQXRCLENBQThCQyxHQUFwRCxFQUF5RFIsbUJBQW1CLENBQW5CLEVBQXNCUyxJQUEvRSxFQUFvRixZQUFwRjtBQUNOLEtBSEQ7QUFJSDtBQUNGOztBQUVELFNBQVNILFdBQVQsQ0FBcUJ6QixRQUFyQixFQUErQjJCLEdBQS9CLEVBQW9DRSxRQUFwQyxFQUE4Q2pDLE9BQTlDLEVBQXNEO0FBQ3BEK0IsUUFBTUEsSUFBSUcsT0FBSixDQUFZLElBQVosRUFBa0IsS0FBbEIsQ0FBTjtBQUNBLE1BQUlDLFNBQVMsc0RBQW9ESixHQUFqRTtBQUNBakUsVUFBUUMsR0FBUixDQUFZb0UsTUFBWjtBQUNBaEcsVUFBUTtBQUNObUUsU0FBSzZCLE1BREM7QUFFTjNCLFlBQVE7QUFGRixHQUFSLEVBR0csVUFBU3RDLEtBQVQsRUFBZ0J1QyxRQUFoQixFQUEwQmhDLElBQTFCLEVBQWdDO0FBQy9CWCxZQUFRQyxHQUFSLENBQVksT0FBWjtBQUNILEdBTEQ7QUFNRDs7QUFFRCxTQUFTcUUsa0JBQVQsQ0FBNEJDLFFBQTVCLEVBQXNDQyxJQUF0QyxFQUE0QztBQUMxQyxNQUFJQyxjQUFjO0FBQ2hCdkIsZUFBVztBQUNUbEMsVUFBSXVEO0FBREssS0FESztBQUloQnJDLGFBQVM7QUFDUHNCLFlBQU0sb0JBQW9CZ0IsSUFBcEIsR0FBMkIsMkVBQTNCLEdBQ04sK0VBRE0sR0FFTixxRUFGTSxHQUdOLHNGQUhNLEdBSU47QUFMTztBQUpPLEdBQWxCOztBQWFBRSxjQUFZRCxXQUFaO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFTRSxlQUFULENBQXlCSixRQUF6QixFQUFtQztBQUNqQyxNQUFJRSxjQUFjO0FBQ2hCdkIsZUFBVztBQUNUbEMsVUFBSXVEO0FBREssS0FESztBQUloQnJDLGFBQVM7QUFDUHNCLFlBQU0sd0VBQ04sc0ZBRE0sR0FFTiw2RUFGTSxHQUdOLHFJQUhNLEdBSU47QUFMTztBQUpPLEdBQWxCOztBQWFBa0IsY0FBWUQsV0FBWjtBQUNEOztBQUVELFNBQVNaLFdBQVQsQ0FBcUJ2QixRQUFyQixFQUErQnNDLFFBQS9CLEVBQXdDO0FBQ3RDLE1BQUlDLFdBQUo7QUFDQWxCLGNBQVlyQixRQUFaLEVBQXNCLE1BQXRCLEVBQThCLFNBQTlCLEVBQXlDLFVBQVNiLE9BQVQsRUFBaUI7QUFDeERrQyxnQkFBWXJCLFFBQVosRUFBc0IsTUFBdEIsRUFBOEIsVUFBOUIsRUFBMEMsVUFBU1YsUUFBVCxFQUFrQjtBQUMxRCtCLGtCQUFZckIsUUFBWixFQUFzQixNQUF0QixFQUE4QixVQUE5QixFQUEwQyxVQUFTVCxRQUFULEVBQWtCO0FBQzFEN0IsZ0JBQVFDLEdBQVIsQ0FBWXdCLE9BQVo7QUFDQSxZQUFJQSxXQUFXLENBQWYsRUFBaUI7QUFDZkcsbUJBQVNKLE1BQVQsR0FBa0JjLFFBQWxCO0FBQ0FWLG1CQUFTa0QsT0FBVCxHQUFtQkYsUUFBbkI7QUFDQUcsMkJBQWlCekMsUUFBakI7QUFDQXVDLHdCQUFjO0FBQ0VyQixrQkFBTTtBQURSLFdBQWQ7QUFHRCxTQVBELE1BUUssSUFBSS9CLFdBQVcsQ0FBZixFQUFpQjtBQUNwQixjQUFJdUQsUUFBU0osUUFBYjtBQUNBaEQsbUJBQVNxRCxJQUFULEdBQWdCLElBQUlDLElBQUosQ0FBUyxLQUFHRixNQUFNRyxNQUFOLENBQWEsQ0FBYixFQUFlLENBQWYsQ0FBWixFQUE4QkMsT0FBT0osTUFBTUcsTUFBTixDQUFhLENBQWIsRUFBZSxDQUFmLENBQVAsSUFBMEIsQ0FBeEQsRUFBMERILE1BQU1HLE1BQU4sQ0FBYSxDQUFiLEVBQWUsQ0FBZixDQUExRCxFQUE2RUMsT0FBT0osTUFBTUcsTUFBTixDQUFhLENBQWIsRUFBZSxDQUFmLENBQVAsQ0FBN0UsRUFBdUdILE1BQU1HLE1BQU4sQ0FBYSxFQUFiLEVBQWdCLENBQWhCLENBQXZHLENBQWhCO0FBQ0EsY0FBSTNCLE9BQU82QixVQUFVekQsU0FBU3FELElBQW5CLEVBQXlCRCxLQUF6QixFQUFnQ25ELFFBQWhDLENBQVg7QUFDQSxjQUFJMkIsUUFBUSx5REFBWixFQUF1RXVCLGlCQUFpQnpDLFFBQWpCO0FBQ3ZFdUMsd0JBQWM7QUFDRXJCLGtCQUFNQTtBQURSLFdBQWQ7QUFHRCxTQVJJLE1BU0EsSUFBRy9CLFdBQVcsQ0FBZCxFQUFnQjtBQUNuQixjQUFHbUQsYUFBYSxHQUFiLElBQW9CQSxhQUFhLEdBQXBDLEVBQXdDO0FBQ3RDQywwQkFBYztBQUNBckIsb0JBQU07QUFETixhQUFkO0FBR0QsV0FKRCxNQUtLLElBQUdvQixZQUFZLEdBQWYsRUFBbUI7QUFDdEJVLHlCQUFhLEtBQWIsRUFBb0JoRCxRQUFwQjtBQUNBVixxQkFBU3FELElBQVQsQ0FBY00sUUFBZCxDQUF1QjNELFNBQVNxRCxJQUFULENBQWNPLFFBQWQsS0FBeUIzRCxRQUFoRDtBQUNBSSxrQkFBTSxVQUFOLEVBQWtCTCxRQUFsQixFQUE0QlUsUUFBNUIsRUFBc0MsVUFBU21ELEdBQVQsRUFBYTtBQUNqRCxrQkFBSUEsTUFBTUEsSUFBSUMsR0FBSixDQUFRLENBQVIsQ0FBVjtBQUNBM0gsdUJBQVM0SCxXQUFULENBQXFCRixJQUFJUixJQUF6QixFQUErQixVQUFTVyxDQUFULEVBQVc7QUFDeENyRyw0QkFBWXNHLE9BQVosQ0FBb0JyRyxJQUFwQixFQUEwQixVQUFVc0csR0FBVixFQUFlQyxFQUFmLEVBQW1CO0FBQzNDLHNCQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULHNCQUFJL0QsYUFBYWdFLEdBQUdoRSxVQUFILENBQWMsVUFBZCxDQUFqQjtBQUNBQSw2QkFBV2lFLElBQVgsQ0FBZ0IsRUFBQyxPQUFPcEksU0FBUzZILElBQUlRLEdBQWIsQ0FBUixFQUFoQixFQUE0Q0MsT0FBNUMsQ0FBb0QsVUFBU0osR0FBVCxFQUFjSyxJQUFkLEVBQW1CO0FBQ3JFLHdCQUFJTCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULHdCQUFHSyxLQUFLQyxNQUFMLElBQWUsQ0FBbEIsRUFBb0I7QUFDbEIxQixrQ0FBWTtBQUNWeEIsbUNBQVc7QUFDVGxDLDhCQUFJc0I7QUFESyx5QkFERDtBQUlWSixpQ0FBUztBQUNQc0IsZ0NBQU0sdUNBQXVDb0MsRUFBRWQ7QUFEeEM7QUFKQyx1QkFBWjtBQVFBL0MsaUNBQVdzRSxNQUFYLENBQWtCLEVBQUMsT0FBT3pJLFNBQVM2SCxJQUFJUSxHQUFiLENBQVIsRUFBbEI7QUFDQUYseUJBQUdPLEtBQUg7QUFDRDtBQUNGLG1CQWREO0FBZUQsaUJBbEJEO0FBbUJELGVBcEI4QixDQW9CN0JDLElBcEI2QixDQW9CeEIsSUFwQndCLEVBb0JsQmQsR0FwQmtCLENBQS9CO0FBcUJELGFBdkJEO0FBd0JBWiwwQkFBYztBQUNackIsb0JBQU07QUFETSxhQUFkO0FBR0FnRCwyQkFBZSxDQUFmLEVBQWtCbEUsUUFBbEI7QUFDQVYsdUJBQVcsRUFBWDtBQUNELFdBaENJLE1BaUNEO0FBQ0ZpRCwwQkFBYztBQUNBckIsb0JBQU07QUFETixhQUFkO0FBR0F1Qiw2QkFBaUJ6QyxRQUFqQjtBQUNEO0FBQ0YsU0E3Q0ksTUE4Q0EsSUFBR2IsV0FBVyxDQUFkLEVBQWdCO0FBQ25CLGNBQUdtRCxZQUFZLE1BQWYsRUFBdUI7QUFDckI7QUFDQSxnQkFBSTZCLFNBQVNDLFlBQVk5QixRQUFaLENBQWI7QUFDQSxnQkFBSStCLElBQUosRUFBVUMsR0FBVjtBQUNBLGdCQUFJQyxVQUFVLEVBQWQ7QUFDQSxpQkFBSSxJQUFJQyxJQUFFLENBQVYsRUFBYUEsSUFBRUMsS0FBS0MsR0FBTCxDQUFTLENBQVQsRUFBWVAsT0FBT0wsTUFBbkIsQ0FBZixFQUEyQ1UsR0FBM0MsRUFBK0M7QUFDN0Msa0JBQUlHLFNBQVMsRUFBQy9DLE1BQUssVUFBTjtBQUNDZ0QsdUJBQU1ULE9BQU9LLENBQVAsRUFBVSxNQUFWLENBRFA7QUFFQzlDLHlCQUFTbkIsS0FBS3NFLFNBQUwsQ0FBZVYsT0FBT0ssQ0FBUCxDQUFmLENBRlYsRUFBYjtBQUdBRCxzQkFBUU8sSUFBUixDQUFhSCxNQUFiO0FBQ0Q7O0FBRURwQywwQkFBYztBQUNad0MsMEJBQVc7QUFDVG5ELHNCQUFLLFVBREk7QUFFVEYseUJBQVE7QUFDTnNELGlDQUFjLFFBRFI7QUFFTjlELHdCQUFLLHFCQUZDO0FBR05xRCwyQkFBU0E7QUFISDtBQUZDO0FBREMsYUFBZDtBQVVBOztBQUVBN0csb0JBQVFDLEdBQVIsQ0FBWTRHLE9BQVo7QUFDQW5DLHdCQUFZO0FBQ0Z4Qix5QkFBVztBQUNUbEMsb0JBQUlzQjtBQURLLGVBRFQ7QUFJRix5QkFBVXVDOztBQUpSLGFBQVo7QUFPQTtBQUNBO0FBQ0E7QUFDRCxXQW5DRCxNQW9DSTtBQUNKQSwwQkFBYztBQUNFckIsb0JBQU07QUFEUixhQUFkO0FBR0V1Qiw2QkFBaUJ6QyxRQUFqQjtBQUNEOztBQUdEO0FBQ0E7QUFDRCxTQS9DSSxNQWdEQSxJQUFJYixXQUFXLENBQWYsRUFBaUI7QUFDcEJ6QixrQkFBUUMsR0FBUixDQUFZMkIsUUFBWjtBQUNBQSxtQkFBU3lGLFVBQVQsR0FBc0IsRUFBQ3BELEtBQUssRUFBTixFQUFVQyxNQUFNLEVBQWhCLEVBQXRCO0FBQ0EsY0FBSVUsU0FBUyxDQUFULEVBQVlWLElBQWhCLEVBQXFCO0FBQ25CSCx3QkFBWXpCLFFBQVosRUFBc0JzQyxTQUFTLENBQVQsRUFBWVosT0FBWixDQUFvQkMsR0FBMUMsRUFBK0NXLFNBQVMsQ0FBVCxFQUFZVixJQUEzRCxFQUFpRSxZQUFqRTtBQUNBO0FBQ0F0QyxxQkFBU3lGLFVBQVQsR0FBc0IsRUFBQ3BELEtBQUssc0VBQU4sRUFBOEVDLE1BQU1VLFNBQVMsQ0FBVCxFQUFZVixJQUFoRyxFQUF0QjtBQUNEOztBQUVEO0FBQ0FXLHdCQUFjO0FBQ0VyQixrQkFBTTtBQURSLFdBQWQ7QUFHQThCLHVCQUFhLEtBQWIsRUFBb0JoRCxRQUFwQjtBQUNBa0UseUJBQWUsQ0FBZixFQUFpQmxFLFFBQWpCO0FBQ0F0QyxrQkFBUUMsR0FBUixDQUFZLFVBQVo7QUFDQUQsa0JBQVFDLEdBQVIsQ0FBWTJCLFFBQVo7QUFDQUEsbUJBQVNxRCxJQUFULENBQWNNLFFBQWQsQ0FBdUIzRCxTQUFTcUQsSUFBVCxDQUFjTyxRQUFkLEtBQXlCM0QsUUFBaEQ7QUFDQUksZ0JBQU0sVUFBTixFQUFrQkwsUUFBbEIsRUFBNEJVLFFBQTVCLEVBQXNDLFVBQVNtRCxHQUFULEVBQWE7QUFDakQsZ0JBQUlBLE1BQU1BLElBQUlDLEdBQUosQ0FBUSxDQUFSLENBQVY7QUFDQTNILHFCQUFTNEgsV0FBVCxDQUFxQi9ELFNBQVNxRCxJQUE5QixFQUFvQyxVQUFTVyxDQUFULEVBQVc7QUFDN0NyRywwQkFBWXNHLE9BQVosQ0FBb0JyRyxJQUFwQixFQUEwQixVQUFVc0csR0FBVixFQUFlQyxFQUFmLEVBQW1CO0FBQzNDLG9CQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULG9CQUFJL0QsYUFBYWdFLEdBQUdoRSxVQUFILENBQWMsVUFBZCxDQUFqQjtBQUNBQSwyQkFBV2lFLElBQVgsQ0FBZ0IsRUFBQyxPQUFPcEksU0FBUzZILElBQUlRLEdBQWIsQ0FBUixFQUFoQixFQUE0Q0MsT0FBNUMsQ0FBb0QsVUFBU0osR0FBVCxFQUFjSyxJQUFkLEVBQW1CO0FBQ3JFLHNCQUFJTCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULHNCQUFHSyxLQUFLQyxNQUFMLElBQWUsQ0FBbEIsRUFBb0I7QUFDbEIsd0JBQUl4RSxTQUFTeUYsVUFBYixFQUF3QjtBQUN0QjNDLGtDQUFZO0FBQ1Z4QixtQ0FBVztBQUNUbEMsOEJBQUlzQjtBQURLLHlCQUREO0FBSVYsbUNBQVU7QUFDUix3Q0FBYTtBQUNYLG9DQUFRVixTQUFTeUYsVUFBVCxDQUFvQm5ELElBRGpCO0FBRVgsdUNBQVU7QUFDUixxQ0FBT3RDLFNBQVN5RixVQUFULENBQW9CcEQ7QUFEbkI7QUFGQztBQURMO0FBSkEsdUJBQVo7QUFhRDtBQUNELHdCQUFHckMsU0FBUzJGLFFBQVosRUFBcUI7QUFDbkIsMEJBQUlBLFdBQVcxRSxLQUFLQyxLQUFMLENBQVdsQixTQUFTMkYsUUFBcEIsQ0FBZjtBQUNBdkgsOEJBQVFDLEdBQVIsQ0FBWXNILFFBQVo7QUFDQTdDLGtDQUFZO0FBQ1Z4QixtQ0FBVztBQUNUbEMsOEJBQUlzQjtBQURLLHlCQUREO0FBSVZKLGlDQUFTO0FBQ1Asd0NBQWE7QUFDWCxvQ0FBTyxVQURJO0FBRVgsdUNBQVU7QUFDUiwrQ0FBZ0IsU0FEUjtBQUVSLDBDQUFXLENBQ1I7QUFDQyx5Q0FBU3FGLFNBQVMvQyxJQURuQjtBQUVFLDZDQUFZLDJEQUF5RCtDLFNBQVNDLFFBQWxFLEdBQTJFLEdBQTNFLEdBQStFRCxTQUFTRSxTQUF4RixHQUFrRywwREFBbEcsR0FBNkpGLFNBQVNDLFFBQXRLLEdBQStLLEdBQS9LLEdBQW1MRCxTQUFTRSxTQUYxTTtBQUdDLDRDQUFZLDBEQUEwRDdGLFNBQVNrRCxPQUFuRSxHQUE2RSxJQUgxRjtBQUlDLDJDQUFVLENBQ1I7QUFDRSwwQ0FBTyxTQURUO0FBRUUseUNBQU0sdUNBQXFDeUMsU0FBUy9DLElBQTlDLEdBQW1ELElBQW5ELEdBQXdEK0MsU0FBU0MsUUFBakUsR0FBMEUsR0FBMUUsR0FBOEVELFNBQVNFLFNBRi9GO0FBR0UsMkNBQVE7QUFIVixpQ0FEUTtBQUpYLCtCQURRO0FBRkg7QUFGQztBQUROO0FBSkMsdUJBQVo7QUEyQkExRixpQ0FBV3NFLE1BQVgsQ0FBa0IsRUFBQyxPQUFPekksU0FBUzZILElBQUlRLEdBQWIsQ0FBUixFQUFsQjtBQUNBRix5QkFBR08sS0FBSDtBQUNELHFCQWhDRCxNQWlDSTtBQUNGNUIsa0NBQVk7QUFDVnhCLG1DQUFXO0FBQ1RsQyw4QkFBSXNCO0FBREsseUJBREQ7QUFJVkosaUNBQVM7QUFDUHNCLGdDQUFNLHVDQUF1QzVCLFNBQVNrRDtBQUQvQztBQUpDLHVCQUFaO0FBUUEvQyxpQ0FBV3NFLE1BQVgsQ0FBa0IsRUFBQyxPQUFPekksU0FBUzZILElBQUlRLEdBQWIsQ0FBUixFQUFsQjtBQUNBRix5QkFBR08sS0FBSDtBQUNEO0FBQ0Y7QUFDRixpQkFoRUQ7QUFpRUQsZUFwRUQ7QUFxRUQsYUF0RW1DLENBc0VsQ0MsSUF0RWtDLENBc0U3QixJQXRFNkIsRUFzRXZCZCxHQXRFdUIsQ0FBcEM7QUF1RUQsV0F6RUQ7QUEwRUQ7QUFDRCxZQUFJaEIsY0FBYztBQUNoQnZCLHFCQUFXO0FBQ1RsQyxnQkFBSXNCO0FBREssV0FESztBQUloQkosbUJBQVMyQztBQUpPLFNBQWxCO0FBTUE3RSxnQkFBUUMsR0FBUixDQUFZLE1BQVo7QUFDQXlFLG9CQUFZRCxXQUFaO0FBQ0F6RSxnQkFBUUMsR0FBUixDQUFZd0IsT0FBWjtBQUNBaUcsdUJBQWVwRixRQUFmLEVBQXlCVixRQUF6QjtBQUNELE9BeE5EO0FBeU5ELEtBMU5EO0FBMk5ELEdBNU5EO0FBNk5EOztBQUdELFNBQVNTLGdCQUFULENBQTBCakIsS0FBMUIsRUFBaUM7QUFDL0IsTUFBSWtCLFdBQVdsQixNQUFNRSxNQUFOLENBQWFOLEVBQTVCO0FBQ0EsTUFBSWlDLGNBQWM3QixNQUFNOEIsU0FBTixDQUFnQmxDLEVBQWxDO0FBQ0EsTUFBSTJHLGlCQUFpQnZHLE1BQU1nQyxTQUEzQjs7QUFFQTtBQUNBO0FBQ0EsTUFBSVksVUFBVTVDLE1BQU1nQixRQUFOLENBQWU0QixPQUE3Qjs7QUFFQWhFLFVBQVFDLEdBQVIsQ0FBWSxpRUFDVixPQURGLEVBQ1dxQyxRQURYLEVBQ3FCVyxXQURyQixFQUNrQ2UsT0FEbEMsRUFDMkMyRCxjQUQzQzs7QUFHQTtBQUNBOztBQUVBO0FBQ0EsTUFBR3ZHLE1BQU1nQixRQUFOLENBQWU0QixPQUFmLEtBQTJCLHFCQUE5QixFQUFvRDtBQUNsRDNDLHVCQUFtQmlCLFFBQW5CLEVBQTZCLFVBQVMzQixJQUFULEVBQWM7QUFDekMsVUFBSTZELE9BQU83RCxLQUFLaUgsU0FBTCxHQUFpQixHQUFqQixHQUF1QmpILEtBQUtpSCxTQUF2QztBQUNBdEQseUJBQW1CaEMsUUFBbkIsRUFBNkJrQyxJQUE3QjtBQUNELEtBSEQ7QUFLRCxHQU5ELE1BT0k7QUFDRnhFLFlBQVFDLEdBQVIsQ0FBWSxPQUFaO0FBQ0EwRCxnQkFBWXJCLFFBQVosRUFBc0IsTUFBdEIsRUFBOEIsVUFBOUIsRUFBMEMsVUFBU1YsUUFBVCxFQUFrQjtBQUMxRDVCLGNBQVFDLEdBQVIsQ0FBWTJCLFFBQVo7QUFDQUEsZUFBUzJGLFFBQVQsR0FBb0J2RCxPQUFwQjtBQUNBLFVBQUl0RCxPQUFPbUMsS0FBS0MsS0FBTCxDQUFXa0IsT0FBWCxDQUFYO0FBQ0FoRSxjQUFRQyxHQUFSLENBQVkrRCxPQUFaO0FBQ0FoRSxjQUFRQyxHQUFSLENBQVkyQixRQUFaO0FBQ0EsVUFBSTZDLGNBQWM7QUFDaEJ2QixtQkFBVztBQUNUbEMsY0FBSXNCO0FBREssU0FESztBQUloQkosaUJBQVM7QUFDUHNCLGdCQUFNO0FBREM7QUFKTyxPQUFsQjtBQVFBa0UscUJBQWVwRixRQUFmLEVBQXlCVixRQUF6QjtBQUNBbUQsdUJBQWlCekMsUUFBakI7QUFDQW9DLGtCQUFZRCxXQUFaO0FBQ0QsS0FqQkQ7QUFrQkQ7QUFDRjs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxTQUFTWCxlQUFULENBQXlCeEIsUUFBekIsRUFBbUNpQixXQUFuQyxFQUFnRDtBQUM5QzNFLGVBQWFzRCxPQUFiLENBQXFCO0FBQ25CMkYsa0JBQWMsc0NBREs7QUFFbkJDLFdBQU8sRUFBQyxRQUFRdkUsV0FBVCxFQUZZO0FBR25CdEUsYUFBU0E7QUFIVSxHQUFyQixFQUlJLFVBQVM2RyxHQUFULEVBQWNuRCxRQUFkLEVBQXdCO0FBQzFCLFFBQUltRCxHQUFKLEVBQ0U5RixRQUFRQyxHQUFSLENBQVksUUFBWixFQUFzQjZGLEdBQXRCLEVBREYsS0FFSTs7QUFFRixVQUFJckIsV0FBSjtBQUNBLFVBQUc5QixTQUFTb0YsT0FBVCxDQUFpQixDQUFqQixDQUFILEVBQXVCO0FBQ3JCLFlBQUlDLFVBQVVyRixTQUFTb0YsT0FBVCxDQUFpQixDQUFqQixFQUFvQkUsTUFBbEM7QUFDQSxZQUFJQyxVQUFVLEVBQWQ7QUFDQSxnQkFBUUYsT0FBUjtBQUNBLGVBQUssTUFBTDtBQUNFRyxpQkFBSzdGLFFBQUwsRUFBZSxVQUFTOEYsR0FBVCxFQUFhO0FBQzFCMUQsMEJBQVk7QUFDVnhCLDJCQUFXO0FBQ1RsQyxzQkFBSXNCO0FBREssaUJBREQ7QUFJVkoseUJBQVM7QUFDUHNCLHdCQUFNNEU7QUFEQztBQUpDLGVBQVo7QUFRRCxhQVREO0FBVUY7QUFDQSxlQUFLLE1BQUw7QUFDRUMseUJBQWEvRixRQUFiLEVBQXVCLFVBQVM4RixHQUFULEVBQWE7QUFDbEMsa0JBQUlFLFVBQVUsRUFBRUMsU0FBUyxNQUFYLEVBQW1CQyxNQUFNLFNBQXpCLEVBQW9DQyxPQUFPLE9BQTNDO0FBQ1pDLHFCQUFLLFNBRE8sRUFBZDtBQUVBaEUsMEJBQVk7QUFDVnhCLDJCQUFXO0FBQ1RsQyxzQkFBSXNCO0FBREssaUJBREQ7QUFJVkoseUJBQVM7QUFDUHNCLHdCQUFNLHVDQUF1QzRFLElBQUl0RCxPQUEzQyxHQUFxRCxTQUFyRCxHQUFpRXNELElBQUluRCxJQUFKLENBQVMwRCxrQkFBVCxDQUE0QixPQUE1QixFQUFxQ0wsT0FBckM7QUFEaEU7QUFKQyxlQUFaO0FBUUQsYUFYRDtBQVlGO0FBQ0EsZUFBSyxRQUFMO0FBQ0VKLHNCQUFVLG1DQUFWO0FBQ0E1Qyx5QkFBYSxJQUFiLEVBQW1CaEQsUUFBbkI7QUFDRjtBQUNBLGVBQUssTUFBTDtBQUNFakIsK0JBQW1CaUIsUUFBbkIsRUFBNkIsVUFBUzNCLElBQVQsRUFBYztBQUN6QyxrQkFBSTZELE9BQU83RCxLQUFLaUgsU0FBTCxHQUFpQixHQUFqQixHQUF1QmpILEtBQUtpSCxTQUF2QztBQUNBdEQsaUNBQW1CaEMsUUFBbkIsRUFBNkJrQyxJQUE3QjtBQUNELGFBSEQ7QUFJRjtBQUNBLGVBQUssUUFBTDtBQUNJakcsbUJBQU9xSyxhQUFQLENBQXFCdEcsUUFBckIsRUFBK0IsVUFBL0IsRUFBMkMsVUFBUzZGLElBQVQsRUFBYztBQUN2RCxrQkFBSVUsUUFBUXpELE9BQU83QixZQUFZNEIsTUFBWixDQUFtQjVCLFlBQVk2QyxNQUFaLEdBQW1CLENBQXRDLEVBQXlDLENBQXpDLENBQVAsSUFBb0QsQ0FBaEU7QUFDQSxrQkFBR3lDLFNBQVMsQ0FBVCxJQUFjQSxRQUFRVixLQUFLL0IsTUFBOUIsRUFBcUM7QUFDbkMsb0JBQUlwRixLQUFLbUgsS0FBS1UsS0FBTCxFQUFZNUMsR0FBckI7QUFDQTFHLDRCQUFZc0csT0FBWixDQUFvQnJHLElBQXBCLEVBQTBCLFVBQVVzRyxHQUFWLEVBQWVDLEVBQWYsRUFBbUI7QUFDM0Msc0JBQUlELEdBQUosRUFBUyxNQUFNQSxHQUFOO0FBQ1Qsc0JBQUkvRCxhQUFhZ0UsR0FBR2hFLFVBQUgsQ0FBYyxVQUFkLENBQWpCO0FBQ0FBLDZCQUFXc0UsTUFBWCxDQUFrQixFQUFDLE9BQU96SSxTQUFTb0QsRUFBVCxDQUFSLEVBQWxCLEVBQXlDLFVBQVM4RSxHQUFULEVBQWNMLEdBQWQsRUFBa0I7QUFDekRmLGdDQUFZO0FBQ1Z4QixpQ0FBVztBQUNUbEMsNEJBQUlzQjtBQURLLHVCQUREO0FBSVZKLCtCQUFTO0FBQ1BzQiw4QkFBTSxhQUFhMkUsS0FBS1UsS0FBTCxFQUFZL0Q7QUFEeEI7QUFKQyxxQkFBWjtBQVFELG1CQVREO0FBVUQsaUJBYkQ7QUFjRDtBQUNGLGFBbkJEO0FBb0JKO0FBQ0UsZUFBSyxJQUFMO0FBQ0VvRCxzQkFBVSxPQUFWO0FBQ0E7QUFDRixlQUFLLEtBQUw7QUFDRUEsc0JBQVUsZ0JBQVY7QUFDQTtBQUNGLGVBQUssS0FBTDtBQUNFdkYsdUJBQVcsV0FBWDtBQUNBO0FBQ0YsZUFBSyxLQUFMO0FBQ0VBLHVCQUFXLGdCQUFYO0FBQ0E7QUFDSjtBQUNFdUYsc0JBQVVGLE9BQVY7QUF4RUYsU0F5RUM7QUFDRHZELHNCQUFjO0FBQ1p2QixxQkFBVztBQUNUbEMsZ0JBQUlzQjtBQURLLFdBREM7QUFJWkosbUJBQVM7QUFDUHNCLGtCQUFNMEU7QUFEQztBQUpHLFNBQWQ7QUFRRCxPQXJGRCxNQXNGSTtBQUNGLFlBQUlZLGNBQWMsQ0FBQywySUFBRCxFQUNBLHNHQURBLEVBRUEsaUlBRkEsRUFHQSxvRkFIQSxFQUlBLHVHQUpBLEVBS0EsaUZBTEEsQ0FBbEI7QUFNQSxZQUFJaEMsSUFBSUMsS0FBS2dDLEtBQUwsQ0FBV2hDLEtBQUtpQyxNQUFMLEtBQWMsQ0FBekIsQ0FBUjtBQUNBdkUsc0JBQWM7QUFDWnZCLHFCQUFXO0FBQ1RsQyxnQkFBSXNCO0FBREssV0FEQztBQUlaSixtQkFBUztBQUNQc0Isa0JBQU1zRixZQUFZaEMsQ0FBWixJQUFpQjtBQURoQjtBQUpHLFNBQWQ7QUFRRDtBQUNELFVBQUdyQyxZQUFZdkMsT0FBWixDQUFvQnNCLElBQXZCLEVBQTZCa0IsWUFBWUQsV0FBWjtBQUM5QjtBQUNGLEdBbkhEO0FBb0hEOztBQUdELFNBQVNDLFdBQVQsQ0FBcUJELFdBQXJCLEVBQWtDO0FBQ2hDcEcsVUFBUTtBQUNObUUsU0FBSyw2Q0FEQztBQUVOeUcsUUFBSSxFQUFFQyxjQUFjckosUUFBUUMsR0FBUixDQUFZMkMsaUJBQTVCLEVBRkU7QUFHTkMsWUFBUSxNQUhGO0FBSU50RCxVQUFNcUY7O0FBSkEsR0FBUixFQU1HLFVBQVVyRSxLQUFWLEVBQWlCdUMsUUFBakIsRUFBMkJoQyxJQUEzQixFQUFpQztBQUNsQyxRQUFJLENBQUNQLEtBQUQsSUFBVXVDLFNBQVNDLFVBQVQsSUFBdUIsR0FBckMsRUFBMEM7QUFDeEMsVUFBSXVHLGNBQWN4SSxLQUFLeUksWUFBdkI7QUFDQSxVQUFJL0YsWUFBWTFDLEtBQUswSSxVQUFyQjs7QUFFQTtBQUNELEtBTEQsTUFLTztBQUNMckosY0FBUUksS0FBUixDQUFjLHlCQUFkO0FBQ0FKLGNBQVFJLEtBQVIsQ0FBY3VDLFFBQWQ7QUFDQTNDLGNBQVFJLEtBQVIsQ0FBY0EsS0FBZDtBQUNEO0FBQ0YsR0FqQkQ7QUFrQkQ7QUFDRDtBQUNBLFNBQVNpSSxZQUFULENBQXNCL0YsUUFBdEIsRUFBZ0NDLEVBQWhDLEVBQW1DO0FBQ2pDK0csVUFBUWhILFFBQVIsRUFBa0IsVUFBbEIsRUFBOEIsVUFBUzZGLElBQVQsRUFBYztBQUMxQyxRQUFHQSxLQUFLLENBQUwsQ0FBSCxFQUFXO0FBQ1Q1RixTQUFHNEYsS0FBSyxDQUFMLENBQUg7QUFDRCxLQUZELE1BR0s1RixHQUFHLGFBQUg7QUFDTixHQUxEO0FBTUQ7O0FBR0Q7QUFDQSxTQUFTNEYsSUFBVCxDQUFjN0YsUUFBZCxFQUF3QkMsRUFBeEIsRUFBMkI7QUFDekJvQixjQUFZckIsUUFBWixFQUFzQixNQUF0QixFQUE4QixVQUE5QixFQUEwQyxVQUFTVCxRQUFULEVBQWtCO0FBQzFEdEQsV0FBT3FLLGFBQVAsQ0FBcUJ0RyxRQUFyQixFQUErQixVQUEvQixFQUEyQyxVQUFTNkYsSUFBVCxFQUFjO0FBQ3ZELFVBQUlyQixJQUFJLENBQVI7QUFDQSxVQUFJc0IsTUFBTSxFQUFWO0FBQ0FELFdBQUtySCxPQUFMLENBQWEsVUFBU2MsUUFBVCxFQUFrQjtBQUM3QixZQUFJOEcsTUFBTTlHLFNBQVNxRCxJQUFULENBQWNzRSxPQUFkLEVBQVY7QUFDQSxZQUFJZCxRQUFRN0csU0FBU3FELElBQVQsQ0FBY3VFLFFBQWQsS0FBMkIsQ0FBdkM7QUFDQSxZQUFJaEIsT0FBTzVHLFNBQVNxRCxJQUFULENBQWN3RSxXQUFkLEVBQVg7QUFDQSxZQUFJQyxPQUFPOUgsU0FBU3FELElBQVQsQ0FBY08sUUFBZCxLQUF5QjNELFFBQXBDO0FBQ0EsWUFBSThILFNBQVMvSCxTQUFTcUQsSUFBVCxDQUFjMkUsVUFBZCxFQUFiO0FBQ0F4QixlQUFPdEIsSUFBSSxhQUFKLEdBQW9CbEYsU0FBU2tELE9BQTdCLEdBQXVDLGFBQXZDLEdBQXVEMkQsS0FBdkQsR0FBK0QsR0FBL0QsR0FBcUVDLEdBQXJFLEdBQTJFLEdBQTNFLEdBQWlGRixJQUFqRixHQUNILEdBREcsR0FDR2tCLElBREgsR0FDVSxHQURWLEdBQ2dCQyxNQURoQixHQUN5QixpQkFEekIsSUFDOEMvSCxTQUFTMkYsUUFBVCxLQUFzQnNDLFNBQXRCLEdBQWtDaEgsS0FBS0MsS0FBTCxDQUFXbEIsU0FBUzJGLFFBQXBCLEVBQThCL0MsSUFBaEUsR0FBdUUsTUFEckgsSUFDOEgsSUFEckk7QUFFQXNDO0FBQ0QsT0FURDtBQVVBLFVBQUcsQ0FBQ3NCLEdBQUosRUFBU0EsTUFBTSxjQUFOO0FBQ1Q3RixTQUFHNkYsR0FBSDtBQUNELEtBZkQ7QUFnQkQsR0FqQkQ7QUFrQkQ7QUFDRCxTQUFTcEcsY0FBVCxDQUF3QmhCLEVBQXhCLEVBQTRCbUgsSUFBNUIsRUFBa0M7QUFDOUIsTUFBSXJCLENBQUo7QUFDQSxPQUFLQSxJQUFJLENBQVQsRUFBWUEsSUFBSXFCLEtBQUsvQixNQUFyQixFQUE2QlUsR0FBN0IsRUFBa0M7QUFDOUIsUUFBSXFCLEtBQUtyQixDQUFMLEVBQVF0RixNQUFSLElBQWtCUixFQUF0QixFQUEwQjtBQUN0QixhQUFPLElBQVA7QUFDSDtBQUNKOztBQUVELFNBQU8sS0FBUDtBQUNIO0FBQ0QsU0FBUytELGdCQUFULENBQTBCekMsUUFBMUIsRUFBbUM7QUFDakMvQyxjQUFZc0csT0FBWixDQUFvQnJHLElBQXBCLEVBQTBCLFVBQVVzRyxHQUFWLEVBQWVDLEVBQWYsRUFBbUI7QUFDM0MsUUFBSUQsR0FBSixFQUFTLE1BQU1BLEdBQU47QUFDVCxRQUFJL0QsYUFBYWdFLEdBQUdoRSxVQUFILENBQWMsTUFBZCxDQUFqQjtBQUNBQSxlQUFXK0gsZ0JBQVgsQ0FBNEIsRUFBQyxVQUFTeEgsUUFBVixFQUE1QixFQUFnRCxFQUFDeUgsTUFBSyxFQUFDLFdBQVUsQ0FBWCxFQUFOLEVBQWhEO0FBQ0QsR0FKRDtBQUtEO0FBQ0QsU0FBU3ZELGNBQVQsQ0FBd0J3RCxLQUF4QixFQUErQjFILFFBQS9CLEVBQXdDO0FBQ3RDL0MsY0FBWXNHLE9BQVosQ0FBb0JyRyxJQUFwQixFQUEwQixVQUFVc0csR0FBVixFQUFlQyxFQUFmLEVBQW1CO0FBQzNDLFFBQUlELEdBQUosRUFBUyxNQUFNQSxHQUFOO0FBQ1QsUUFBSS9ELGFBQWFnRSxHQUFHaEUsVUFBSCxDQUFjLE1BQWQsQ0FBakI7QUFDQUEsZUFBVytILGdCQUFYLENBQTRCLEVBQUMsVUFBU3hILFFBQVYsRUFBNUIsRUFBZ0QsRUFBQzJILE1BQUssRUFBQyxXQUFZRCxLQUFiLEVBQU4sRUFBaEQ7QUFDRCxHQUpEO0FBS0Q7QUFDRCxTQUFTMUUsWUFBVCxDQUFzQjBFLEtBQXRCLEVBQTZCMUgsUUFBN0IsRUFBc0M7QUFDcEMvQyxjQUFZc0csT0FBWixDQUFvQnJHLElBQXBCLEVBQTBCLFVBQVVzRyxHQUFWLEVBQWVDLEVBQWYsRUFBbUI7QUFDM0MsUUFBSUQsR0FBSixFQUFTLE1BQU1BLEdBQU47QUFDVCxRQUFJL0QsYUFBYWdFLEdBQUdoRSxVQUFILENBQWMsTUFBZCxDQUFqQjtBQUNBQSxlQUFXK0gsZ0JBQVgsQ0FBNEIsRUFBQyxVQUFTeEgsUUFBVixFQUE1QixFQUFnRCxFQUFDMkgsTUFBSyxFQUFDLFlBQWFELEtBQWQsRUFBTixFQUFoRDtBQUNELEdBSkQ7QUFLRDtBQUNEO0FBQ0EsU0FBUy9ILEtBQVQsQ0FBZXVDLElBQWYsRUFBcUI1RCxNQUFyQixFQUE2QjBCLFFBQTdCLEVBQXVDQyxFQUF2QyxFQUEwQztBQUN4Q2hELGNBQVlzRyxPQUFaLENBQW9CckcsSUFBcEIsRUFBMEIsVUFBVXNHLEdBQVYsRUFBZUMsRUFBZixFQUFtQjtBQUMzQyxRQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULFFBQUkvRCxhQUFhZ0UsR0FBR2hFLFVBQUgsQ0FBY3lDLElBQWQsQ0FBakI7QUFDQXpDLGVBQVdtSSxNQUFYLENBQWtCdEosTUFBbEIsRUFBMEIsVUFBU2tGLEdBQVQsRUFBY0ssSUFBZCxFQUFtQjtBQUMzQyxVQUFHTCxHQUFILEVBQVE5RixRQUFRQyxHQUFSLENBQVk2RixHQUFaO0FBQ1IsVUFBR3ZELEVBQUgsRUFBT0EsR0FBRzRELElBQUg7QUFDUEosU0FBR08sS0FBSDtBQUNELEtBSkQ7QUFLRCxHQVJEO0FBU0Q7QUFDRCxTQUFTeEUsS0FBVCxDQUFlMEMsSUFBZixFQUFxQmpDLEVBQXJCLEVBQXdCO0FBQ3RCaEQsY0FBWXNHLE9BQVosQ0FBb0JyRyxJQUFwQixFQUEwQixVQUFVc0csR0FBVixFQUFlQyxFQUFmLEVBQW1CO0FBQzNDLFFBQUlELEdBQUosRUFBUyxNQUFNQSxHQUFOO0FBQ1QsUUFBSS9ELGFBQWFnRSxHQUFHaEUsVUFBSCxDQUFjeUMsSUFBZCxDQUFqQjtBQUNBekMsZUFBV2lFLElBQVgsQ0FBZ0IsRUFBaEIsRUFBbUIsRUFBQ0MsS0FBSSxDQUFMLEVBQW5CLEVBQTRCQyxPQUE1QixDQUFvQyxVQUFTSixHQUFULEVBQWNLLElBQWQsRUFBb0I7QUFDdERKLFNBQUdPLEtBQUg7QUFDQS9ELFNBQUc0RCxJQUFIO0FBQ0QsS0FIRDtBQUlELEdBUEQ7QUFRRDtBQUNELFNBQVN1QixjQUFULENBQXdCcEYsUUFBeEIsRUFBa0MwSCxLQUFsQyxFQUF3QztBQUN0Q3pLLGNBQVlzRyxPQUFaLENBQW9CckcsSUFBcEIsRUFBMEIsVUFBVXNHLEdBQVYsRUFBZUMsRUFBZixFQUFtQjtBQUMzQyxRQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULFFBQUkvRCxhQUFhZ0UsR0FBR2hFLFVBQUgsQ0FBYyxNQUFkLENBQWpCO0FBQ0FBLGVBQVcrSCxnQkFBWCxDQUE0QixFQUFDLFVBQVN4SCxRQUFWLEVBQTVCLEVBQWdELEVBQUMySCxNQUFLLEVBQUMsWUFBYUQsS0FBZCxFQUFOLEVBQWhEO0FBQ0QsR0FKRDtBQUtEO0FBQ0QsU0FBU3JHLFdBQVQsQ0FBcUJyQixRQUFyQixFQUErQjZILGNBQS9CLEVBQStDQyxRQUEvQyxFQUF5RDdILEVBQXpELEVBQTREO0FBQzFEaEQsY0FBWXNHLE9BQVosQ0FBb0JyRyxJQUFwQixFQUEwQixVQUFVc0csR0FBVixFQUFlQyxFQUFmLEVBQW1CO0FBQzNDLFFBQUlELEdBQUosRUFBUyxNQUFNQSxHQUFOO0FBQ1QsUUFBSS9ELGFBQWFnRSxHQUFHaEUsVUFBSCxDQUFjb0ksY0FBZCxDQUFqQjtBQUNBcEksZUFBV3NJLE9BQVgsQ0FBbUIsRUFBQyxVQUFVL0gsUUFBWCxFQUFuQixFQUF5QyxVQUFTd0QsR0FBVCxFQUFjd0UsR0FBZCxFQUFrQjtBQUN6RC9ILFNBQUcrSCxJQUFJRixRQUFKLENBQUg7QUFDRCxLQUZEO0FBR0QsR0FORDtBQU9EO0FBQ0QsU0FBU2QsT0FBVCxDQUFpQmhILFFBQWpCLEVBQTJCNkgsY0FBM0IsRUFBMkM1SCxFQUEzQyxFQUE4QztBQUM1Q2hELGNBQVlzRyxPQUFaLENBQW9CckcsSUFBcEIsRUFBMEIsVUFBVXNHLEdBQVYsRUFBZUMsRUFBZixFQUFtQjtBQUMzQyxRQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULFFBQUkvRCxhQUFhZ0UsR0FBR2hFLFVBQUgsQ0FBY29JLGNBQWQsQ0FBakI7QUFDQXBJLGVBQVdpRSxJQUFYLENBQWdCLEVBQUMsVUFBVTFELFFBQVgsRUFBaEIsRUFBc0M0RCxPQUF0QyxDQUE4QyxVQUFTSixHQUFULEVBQWNLLElBQWQsRUFBbUI7QUFDL0Q1RCxTQUFHNEQsSUFBSDtBQUNELEtBRkQ7QUFHRCxHQU5EO0FBT0Q7O0FBRUQsU0FBU2QsU0FBVCxDQUFtQmtGLFFBQW5CLEVBQTZCdkYsS0FBN0IsRUFBb0NuRCxRQUFwQyxFQUE2QztBQUMzQyxNQUFJMkksVUFBVSxJQUFJdEYsSUFBSixFQUFkO0FBQ0FxRixXQUFTaEYsUUFBVCxDQUFrQmdGLFNBQVMvRSxRQUFULEtBQW9CM0QsUUFBdEM7QUFDQSxNQUFJMkcsT0FBT3BELE9BQU8sS0FBR0osTUFBTUcsTUFBTixDQUFhLENBQWIsRUFBZSxDQUFmLENBQVYsQ0FBWDtBQUNBLE1BQUlzRCxRQUFRckQsT0FBT0osTUFBTUcsTUFBTixDQUFhLENBQWIsRUFBZSxDQUFmLENBQVAsSUFBMEIsQ0FBdEM7QUFDQSxNQUFJRixPQUFPRyxPQUFPSixNQUFNRyxNQUFOLENBQWEsQ0FBYixFQUFlLENBQWYsQ0FBUCxDQUFYO0FBQ0EsTUFBSXVFLE9BQU90RSxPQUFPSixNQUFNRyxNQUFOLENBQWEsQ0FBYixFQUFlLENBQWYsQ0FBUCxDQUFYO0FBQ0EsTUFBSXdFLFNBQVN2RSxPQUFPSixNQUFNRyxNQUFOLENBQWEsRUFBYixFQUFnQixDQUFoQixDQUFQLENBQWI7QUFDQSxNQUFJcUYsUUFBUUMsT0FBUixLQUFrQkYsU0FBU0UsT0FBVCxFQUF0QixFQUEwQyxPQUFPLGtFQUFQO0FBQzFDRixXQUFTaEYsUUFBVCxDQUFrQmdGLFNBQVMvRSxRQUFULEtBQW9CM0QsUUFBdEM7QUFDQSxNQUFJMkcsUUFBTStCLFNBQVNkLFdBQVQsRUFBTixJQUE4QmhCLFNBQU84QixTQUFTZixRQUFULEVBQXJDLElBQTBEdkUsUUFBTXNGLFNBQVNoQixPQUFULEVBQWhFLElBQW9GRyxRQUFNYSxTQUFTL0UsUUFBVCxFQUExRixJQUErR21FLFVBQVFZLFNBQVNYLFVBQVQsRUFBM0gsRUFBaUo7QUFDakosV0FBTyx5Q0FBUDtBQUNDO0FBQ0QsU0FBTyx5REFBUDtBQUNEOztBQUVELFNBQVNsRCxXQUFULENBQXFCYSxRQUFyQixFQUE4QjtBQUM1QixNQUFJZCxTQUFTLEVBQWI7QUFDQSxNQUFJeEMsTUFBTSxzRUFBc0VzRCxRQUF0RSxHQUFpRixPQUFqRixHQUEyRjFILFFBQVFDLEdBQVIsQ0FBWTRLLGNBQWpIO0FBQ0EsTUFBSS9LLE1BQU12QixTQUFTLEtBQVQsRUFBZ0I2RixHQUFoQixFQUFxQjtBQUNyQjBHLGFBQVM7QUFEWSxHQUFyQixDQUFWO0FBR0EsTUFBSWpLLE9BQVFtQyxLQUFLQyxLQUFMLENBQVduRCxJQUFJaUwsT0FBSixDQUFZLE1BQVosQ0FBWCxDQUFaOztBQUVBLE9BQUssSUFBSTlELElBQUksQ0FBYixFQUFnQkEsSUFBSXBHLEtBQUttSyxPQUFMLENBQWF6RSxNQUFqQyxFQUF5Q1UsR0FBekMsRUFBNkM7QUFDM0MsUUFBSWdFLFFBQVEsRUFBQyxRQUFRcEssS0FBS21LLE9BQUwsQ0FBYS9ELENBQWIsRUFBZ0IsbUJBQWhCLENBQVQ7QUFDQSxrQkFBWXBHLEtBQUttSyxPQUFMLENBQWEvRCxDQUFiLEVBQWdCLFVBQWhCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQXhDLENBRFo7QUFFQSxtQkFBYXBHLEtBQUttSyxPQUFMLENBQWEvRCxDQUFiLEVBQWdCLFVBQWhCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQXhDO0FBRmIsS0FBWjtBQUlBO0FBQ0FMLFdBQU9XLElBQVAsQ0FBWTBELEtBQVo7QUFDQTtBQUNEO0FBQ0QsU0FBT3JFLE1BQVA7QUFDRDs7QUFFRDtBQUNBLElBQUlzRSxTQUFTN0wsSUFBSThMLE1BQUosQ0FBV25MLFFBQVFDLEdBQVIsQ0FBWW1MLElBQVosSUFBb0IsSUFBL0IsRUFBcUMsWUFBWTtBQUM1RGpMLFVBQVFDLEdBQVIsQ0FBWSxzQkFBWixFQUFvQzhLLE9BQU9HLE9BQVAsR0FBaUJDLElBQXJEO0FBQ0QsQ0FGWSxDQUFiIiwiZmlsZSI6ImJvdC5qcyIsInNvdXJjZVJvb3QiOiIvYXBwIiwic291cmNlc0NvbnRlbnQiOlsiLy9cbi8vIFRoaXMgaXMgbWFpbiBmaWxlIGNvbnRhaW5pbmcgY29kZSBpbXBsZW1lbnRpbmcgdGhlIEV4cHJlc3Mgc2VydmVyIGFuZCBmdW5jdGlvbmFsaXR5IGZvciB0aGUgRXhwcmVzcyBlY2hvIGJvdC5cbi8vXG4ndXNlIHN0cmljdCc7XG5jb25zdCBPYmplY3RJZCA9IHJlcXVpcmUoJ21vbmdvZGInKS5PYmplY3RJRDtcbmNvbnN0IHNjaGVkdWxlID0gcmVxdWlyZSgnbm9kZS1zY2hlZHVsZScpO1xuY29uc3Qgd2F0c29uID0gcmVxdWlyZSgnd2F0c29uLWRldmVsb3Blci1jbG91ZCcpO1xuY29uc3QgbW9uZ29kYiA9IHJlcXVpcmUoXCJtb25nb2RiXCIpXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG5jb25zdCBzUmVxdWVzdCA9IHJlcXVpcmUoJ3N5bmMtcmVxdWVzdCcpO1xuY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3JlcXVlc3QnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBkYlV0aWwgPSByZXF1aXJlKCcuL2RiVXRpbCcpO1xudmFyIGh0dHAgPSByZXF1aXJlKCdodHRwcycpO1xudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcblxudmFyIG1lc3NlbmdlckJ1dHRvbiA9IFwiPGh0bWw+PGhlYWQ+PHRpdGxlPkZhY2Vib29rIE1lc3NlbmdlciBCb3Q8L3RpdGxlPjwvaGVhZD48Ym9keT48aDE+RmFjZWJvb2sgTWVzc2VuZ2VyIEJvdDwvaDE+VGhpcyBpcyBhIGJvdCBiYXNlZCBvbiBNZXNzZW5nZXIgUGxhdGZvcm0gUXVpY2tTdGFydC4gRm9yIG1vcmUgZGV0YWlscywgc2VlIHRoZWlyIDxhIGhyZWY9XFxcImh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9tZXNzZW5nZXItcGxhdGZvcm0vZ3VpZGVzL3F1aWNrLXN0YXJ0XFxcIj5kb2NzPC9hPi48Zm9vdGVyIGlkPVxcXCJnV2lkZ2V0XFxcIj48L2Zvb3Rlcj48c2NyaXB0IHNyYz1cXFwiaHR0cHM6Ly93aWRnZXQuZ2xpdGNoLm1lL3dpZGdldC5taW4uanNcXFwiPjwvc2NyaXB0PjwvYm9keT48L2h0bWw+XCI7XG4vL1VzZXIncyBkYXRhXG52YXIgdXNlck5hbWUgPSBcInRlc3RcIjtcbi8vIFdhdHNvbiBkYXRhXG52YXIgY29udmVyc2F0aW9uID0gd2F0c29uLmNvbnZlcnNhdGlvbih7XG4gIHVzZXJuYW1lOiAnYTE2MmFjYjgtZDUxMC00YzFlLThlODEtYWE1MTRlZTNiNzY5JyxcbiAgcGFzc3dvcmQ6ICdrV0M0eG1kV2lROFonLFxuICB2ZXJzaW9uOiAndjEnLFxuICB2ZXJzaW9uX2RhdGU6ICcyMDE3LTAyLTAzJ1xufSk7XG52YXIgY29udGV4dCA9IHt9O1xuLy8gVGhlIHJlc3Qgb2YgdGhlIGNvZGUgaW1wbGVtZW50cyB0aGUgcm91dGVzIGZvciBvdXIgRXhwcmVzcyBzZXJ2ZXIuXG5sZXQgYXBwID0gZXhwcmVzcygpO1xuXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHtcbiAgZXh0ZW5kZWQ6IHRydWVcbn0pKTtcbi8vIGRhdGFiYXNlIGNvbmZpZ1xudmFyIE1vbmdvQ2xpZW50ID0gbW9uZ29kYi5Nb25nb0NsaWVudFxudmFyIHVybDEgPSBcIm1vbmdvZGI6Ly90aWVuYW5oMjAwNzpEaWVuMTIzNEBkczE1NzA0MC5tbGFiLmNvbTo1NzA0MC9yZW1pbmRlcmJvdFwiO1xuLy8gV2ViaG9vayB2YWxpZGF0aW9uXG5hcHAuZ2V0KCcvd2ViaG9vaycsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gIGlmIChyZXEucXVlcnlbJ2h1Yi5tb2RlJ10gPT09ICdzdWJzY3JpYmUnICYmXG4gICAgICByZXEucXVlcnlbJ2h1Yi52ZXJpZnlfdG9rZW4nXSA9PT0gcHJvY2Vzcy5lbnYuVkVSSUZZX1RPS0VOKSB7XG4gICAgY29uc29sZS5sb2coXCJWYWxpZGF0aW5nIHdlYmhvb2tcIik7XG4gICAgcmVzLnN0YXR1cygyMDApLnNlbmQocmVxLnF1ZXJ5WydodWIuY2hhbGxlbmdlJ10pO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdmFsaWRhdGlvbi4gTWFrZSBzdXJlIHRoZSB2YWxpZGF0aW9uIHRva2VucyBtYXRjaC5cIik7XG4gICAgcmVzLnNlbmRTdGF0dXMoNDAzKTsgICAgICAgICAgXG4gIH1cbn0pO1xuXG4vLyBEaXNwbGF5IHRoZSB3ZWIgcGFnZVxuYXBwLmdldCgnLycsIGZ1bmN0aW9uKHJlcSwgcmVzKSB7XG4gIHJlcy53cml0ZUhlYWQoMjAwLCB7J0NvbnRlbnQtVHlwZSc6ICd0ZXh0L2h0bWwnfSk7XG4gIHJlcy53cml0ZShtZXNzZW5nZXJCdXR0b24pO1xuICByZXMuZW5kKCk7XG59KTtcblxuLy8gTWVzc2FnZSBwcm9jZXNzaW5nXG5hcHAucG9zdCgnL3dlYmhvb2snLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgdmFyIGRhdGEgPSByZXEuYm9keTtcbiAgaWYgKGRhdGEub2JqZWN0ID09PSAncGFnZScpIHsgICAgXG4gICAgLy8gSXRlcmF0ZSBvdmVyIGVhY2ggZW50cnkgLSB0aGVyZSBtYXkgYmUgbXVsdGlwbGUgaWYgYmF0Y2hlZFxuICAgIGRhdGEuZW50cnkuZm9yRWFjaChmdW5jdGlvbihlbnRyeSkge1xuICAgICAgdmFyIHBhZ2VJRCA9IGVudHJ5LmlkO1xuICAgICAgdmFyIHRpbWVPZkV2ZW50ID0gZW50cnkudGltZTtcbiAgICAgIC8vIEl0ZXJhdGUgb3ZlciBlYWNoIG1lc3NhZ2luZyBldmVudFxuICAgICAgZW50cnkubWVzc2FnaW5nLmZvckVhY2goZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgY2FsbFVzZXJQcm9maWxlQVBJKGV2ZW50LnNlbmRlci5pZCwgZnVuY3Rpb24oYm9keSl7XG4gICAgICAgICAgdmFyIHVzZXJEYXRhID0ge3VzZXJpZDogZXZlbnQuc2VuZGVyLmlkLCBjb3VudGVyOiAwLCBrZXl3b3JkczogW10sIGNyZWF0aW5nOiBmYWxzZSwgcmVtaW5kZXI6IHt9LCB0aW1lem9uZTogYm9keS50aW1lem9uZX07XG4gICAgICAgICAgZ2V0REIoXCJVc2VyXCIsIGZ1bmN0aW9uKGNvbGxlY3Rpb24pe1xuICAgICAgICAgICAgaWYoIWNvbnRhaW5zT2JqZWN0KGV2ZW50LnNlbmRlci5pZCwgY29sbGVjdGlvbikpe1xuICAgICAgICAgICAgICBhZGREQihcIlVzZXJcIiwgdXNlckRhdGEsIGV2ZW50LnNlbmRlci5pZCk7ICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgIHJlY2VpdmVkTWVzc2FnZShldmVudCk7IFxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5wb3N0YmFjaykge1xuICAgICAgICAgICAgICByZWNlaXZlZFBvc3RiYWNrKGV2ZW50KTsgXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldlYmhvb2sgcmVjZWl2ZWQgdW5rbm93biBldmVudDogXCIsIGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBBc3N1bWUgYWxsIHdlbnQgd2VsbC5cbiAgICAvL1xuICAgIC8vIFlvdSBtdXN0IHNlbmQgYmFjayBhIDIwMCwgd2l0aGluIDIwIHNlY29uZHMsIHRvIGxldCB1cyBrbm93XG4gICAgLy8geW91J3ZlIHN1Y2Nlc3NmdWxseSByZWNlaXZlZCB0aGUgY2FsbGJhY2suIE90aGVyd2lzZSwgdGhlIHJlcXVlc3RcbiAgICAvLyB3aWxsIHRpbWUgb3V0IGFuZCB3ZSB3aWxsIGtlZXAgdHJ5aW5nIHRvIHJlc2VuZC5cbiAgICByZXMuc2VuZFN0YXR1cygyMDApO1xuICB9XG59KTtcblxuLy9HZXQgdGhlIFVzZXIgUHJvZmlsZSBBUElcbmZ1bmN0aW9uIGNhbGxVc2VyUHJvZmlsZUFQSShzZW5kZXJJRCwgY2Ipe1xuICByZXF1ZXN0KHtcbiAgICB1cmk6ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92Mi42LycgKyBzZW5kZXJJRCArICc/ZmllbGRzPWZpcnN0X25hbWUsbGFzdF9uYW1lLHRpbWV6b25lJmFjY2Vzc190b2tlbj0nICsgcHJvY2Vzcy5lbnYuUEFHRV9BQ0NFU1NfVE9LRU4sXG4gICAgbWV0aG9kOiAnR0VUJ1xuICB9LCBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UsIGJvZHkpIHtcbiAgICBpZiAoIWVycm9yICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPT0gMjAwKSB7XG4gICAgICBib2R5ID0gSlNPTi5wYXJzZShib2R5KTtcbiAgICAgIC8vdXNlck5hbWUgPSBib2R5LmZpcnN0X25hbWUgKyBcIiBcIiArIGJvZHkubGFzdF9uYW1lO1xuICAgICAgY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCB0aGUgbmFtZSBcIiArIGJvZHkuZmlyc3RfbmFtZSArIFwiIFwiICsgYm9keS5sYXN0X25hbWUpO1xuICAgICAgaWYoY2IpIGNiKGJvZHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICAvL2NvbnNvbGUuZXJyb3IocmVzcG9uc2UpO1xuICAgICAgLy9jb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyBJbmNvbWluZyBldmVudHMgaGFuZGxpbmdcbmZ1bmN0aW9uIHJlY2VpdmVkTWVzc2FnZShldmVudCkge1xuICB2YXIgc2VuZGVySUQgPSBldmVudC5zZW5kZXIuaWQ7XG4gIHZhciByZWNpcGllbnRJRCA9IGV2ZW50LnJlY2lwaWVudC5pZDtcbiAgdmFyIHRpbWVPZk1lc3NhZ2UgPSBldmVudC50aW1lc3RhbXA7XG4gIHZhciBtZXNzYWdlID0gZXZlbnQubWVzc2FnZTtcblxuICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIG1lc3NhZ2UgZm9yIHVzZXIgJWQgYW5kIHBhZ2UgJWQgYXQgJWQgd2l0aCBtZXNzYWdlOlwiLCBcbiAgICBzZW5kZXJJRCwgcmVjaXBpZW50SUQsIHRpbWVPZk1lc3NhZ2UpO1xuXG4gIHZhciBtZXNzYWdlSWQgPSBtZXNzYWdlLm1pZDtcblxuICB2YXIgbWVzc2FnZVRleHQgPSBtZXNzYWdlLnRleHQ7XG4gIHZhciBtZXNzYWdlQXR0YWNobWVudHMgPSBtZXNzYWdlLmF0dGFjaG1lbnRzO1xuICBcbiAgaWYgKG1lc3NhZ2VUZXh0KSB7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcImNyZWF0aW5nXCIsIGZ1bmN0aW9uKHApe1xuICAgICAgaWYocCkgbmV3UmVtaW5kZXIoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KTtcbiAgICAgIGVsc2V7XG4gICAgICAgIHN3aXRjaCAobWVzc2FnZVRleHQpIHtcbiAgICAgICAgICAvL0Nhc2VzIHdoZXJlIHRoZSB0ZXh0IGRvZXNuJ3QgaGF2ZSB0byBnbyB0aHJvdWdoIEJsdWVNaXggQVBJIChOb3RoaW5nIHJpZ2h0IG5vdylcbiAgICAgICAgICAvLyBjYXNlICdnZW5lcmljJzpcbiAgICAgICAgICAvLyAgIHNlbmRHZW5lcmljTWVzc2FnZShzZW5kZXJJRCk7XG4gICAgICAgICAgLy8gICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgc2VuZFRleHRNZXNzYWdlKHNlbmRlcklELCBtZXNzYWdlVGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBpZiAobWVzc2FnZUF0dGFjaG1lbnRzKSB7XG4gICAgICBnZXRQcm9wZXJ0eShzZW5kZXJJRCwgXCJVc2VyXCIsIFwiY3JlYXRpbmdcIiwgZnVuY3Rpb24ocCl7XG4gICAgICAgIGlmKHApIG5ld1JlbWluZGVyKHNlbmRlcklELCBtZXNzYWdlQXR0YWNobWVudHMpO1xuICAgICAgICBlbHNlIHNlbmRDb25maXJtKHNlbmRlcklELCBtZXNzYWdlQXR0YWNobWVudHNbMF0ucGF5bG9hZC51cmwsIG1lc3NhZ2VBdHRhY2htZW50c1swXS50eXBlLFwiQXR0YWNobWVudFwiKTtcbiAgICAgIH0pICAgICAgXG4gIH1cbn1cblxuZnVuY3Rpb24gc2VuZENvbmZpcm0oc2VuZGVySUQsIHVybCwgZmlsZVR5cGUsIG1lc3NhZ2Upe1xuICB1cmwgPSB1cmwucmVwbGFjZSgvJi9nLCAnJTI2Jyk7XG4gIHZhciB1cmxSZXEgPSBcImh0dHBzOi8vcHJvamVjdDEtbWluaHRyaTEyOTYuYzl1c2Vycy5pby90ZXN0P3VybD1cIit1cmw7XG4gIGNvbnNvbGUubG9nKHVybFJlcSk7XG4gIHJlcXVlc3Qoe1xuICAgIHVyaTogdXJsUmVxLFxuICAgIG1ldGhvZDogJ0dFVCdcbiAgfSwgZnVuY3Rpb24oZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkRPTkUhXCIpO1xuICB9KVxufVxuXG5mdW5jdGlvbiBzZW5kV2VsY29tZU1lc3NhZ2Uoc2VuZGVySWQsIG5hbWUpIHtcbiAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgIHJlY2lwaWVudDoge1xuICAgICAgaWQ6IHNlbmRlcklkXG4gICAgfSxcbiAgICBtZXNzYWdlOiB7XG4gICAgICB0ZXh0OiBcIldlbGNvbWUgYWJvYXJkIFwiICsgbmFtZSArIFwiISBNeSBuYW1lIGlzIEJvYi4gUmlnaHQgbm93IEknbSBnb25uYSB3YWxrIHlvdSB0aHJvdWdoIHRoZSBiYXNpYyBzdGVwcy5cXG5cIiArXG4gICAgICBcIlRvIHRhbGsgdG8gbWUsIHlvdSBkb24ndCBoYXZlIHRvIHNheSBleGFjdCBjb21tYW5kcyBldmVyeXRpbWUuIEZvciBleGFtcGxlOlxcblwiICsgXG4gICAgICBcIi0gU2V0IHVwIG5ldyByZW1pbmRlcnM6ICdJIHdhbnQgdG8gbWFrZS9jcmVhdGUvaGF2ZSBuZXcgcmVtaW5kZXInXFxuXCIgKyBcbiAgICAgIFwiLSBSZXRyaWV2ZSB0aGUgbmV4dCByZW1pbmRlcjogJ0kgd2FudCB0byBzZWUgdGhlIG5leHQvdXBjb21pbmcvZm9sbG93aW5nIHJlbWluZGVyJ1xcblwiICsgXG4gICAgICBcIi0gUmV0cmlldmUgdGhlIGxpc3Qgb2YgcmVtaW5kZXJzOiAnSSB3YW50IHRvIGxpc3Qvc2hvdy9nZXQgYWxsIHJlbWluZGVycydcXG5hbmQgbWFueSBtb3JlLi4uXCJcbiAgICB9XG4gIH07XG5cbiAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xufVxuXG4vL1NlbmQgdGhlIG1lc3NhZ2Ugd2hlbiB0aGUgdXNlciB1c2UgJ2hlbHAnIGNvbW1hbmRcbmZ1bmN0aW9uIHNlbmRIZWxwTWVzc2FnZShzZW5kZXJJZCkge1xuICB2YXIgbWVzc2FnZURhdGEgPSB7XG4gICAgcmVjaXBpZW50OiB7XG4gICAgICBpZDogc2VuZGVySWRcbiAgICB9LFxuICAgIG1lc3NhZ2U6IHtcbiAgICAgIHRleHQ6IFwiLSBTZXQgdXAgbmV3IHJlbWluZGVyczogJ0kgd2FudCB0byBtYWtlL2NyZWF0ZS9oYXZlIG5ldyByZW1pbmRlcidcXG5cIiArIFxuICAgICAgXCItIFJldHJpZXZlIHRoZSBuZXh0IHJlbWluZGVyOiAnSSB3YW50IHRvIHNlZSB0aGUgbmV4dC91cGNvbWluZy9mb2xsb3dpbmcgcmVtaW5kZXInXFxuXCIgKyBcbiAgICAgIFwiLSBSZXRyaWV2ZSB0aGUgbGlzdCBvZiByZW1pbmRlcnM6ICdJIHdhbnQgdG8gbGlzdC9zaG93L2dldCBhbGwgcmVtaW5kZXJzJ1xcblwiICsgXG4gICAgICBcIi0gRGVsZXRlIGEgcmVtaW5kZXI6ICdJIHdhbnQgdG8gcmVtb3ZlL2RlbGV0ZS9kZXN0cm95JyBbaW5kZXhdIChpbmRleCBpcyB0aGUgaW5kZXggbnVtYmVyIG9mIHRoZSByZW1pbmRlciBpbiB0aGUgbGlzdCBvZiByZW1pbmRlcnMpXCIgK1xuICAgICAgXCItIEhlbHA6ICdoZWxwL2luc3RydWN0aW9uL2NvbW1hbmQnXCJcbiAgICB9XG4gIH07XG5cbiAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xufVxuXG5mdW5jdGlvbiBuZXdSZW1pbmRlcihzZW5kZXJJRCwgbWVzc0RhdGEpe1xuICB2YXIgcmVzcG9uZFRleHQ7XG4gIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJjb3VudGVyXCIsIGZ1bmN0aW9uKGNvdW50ZXIpe1xuICAgIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJyZW1pbmRlclwiLCBmdW5jdGlvbihyZW1pbmRlcil7XG4gICAgICBnZXRQcm9wZXJ0eShzZW5kZXJJRCwgXCJVc2VyXCIsIFwidGltZXpvbmVcIiwgZnVuY3Rpb24odGltZXpvbmUpe1xuICAgICAgICBjb25zb2xlLmxvZyhjb3VudGVyKTtcbiAgICAgICAgaWYgKGNvdW50ZXIgPT0gMCl7XG4gICAgICAgICAgcmVtaW5kZXIudXNlcmlkID0gc2VuZGVySUQ7XG4gICAgICAgICAgcmVtaW5kZXIuY29udGVudCA9IG1lc3NEYXRhO1xuICAgICAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgICAgIHJlc3BvbmRUZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIldoZW4/IChtbS9kZC95eS1oaDptbSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb3VudGVyID09IDEpe1xuICAgICAgICAgIHZhciBwYXJ0cyA9ICBtZXNzRGF0YTtcbiAgICAgICAgICByZW1pbmRlci5kYXRlID0gbmV3IERhdGUoMjArcGFydHMuc3Vic3RyKDYsMiksTnVtYmVyKHBhcnRzLnN1YnN0cigwLDIpKS0xLHBhcnRzLnN1YnN0cigzLDIpLCBOdW1iZXIocGFydHMuc3Vic3RyKDksMikpLHBhcnRzLnN1YnN0cigxMiwyKSk7XG4gICAgICAgICAgdmFyIHRleHQgPSBjaGVja0RhdGUocmVtaW5kZXIuZGF0ZSwgcGFydHMsIHRpbWV6b25lKTtcbiAgICAgICAgICBpZiAodGV4dCA9PSBcIkRvIHlvdSB3YW50IGFkZCBtb3JlIGluZm9ybWF0aW9uPyAoWSBmb3IgeWVzLCBOIGZvciBObylcIikgaW5jcmVtZW50Q291bnRlcihzZW5kZXJJRCk7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihjb3VudGVyID09IDIpe1xuICAgICAgICAgIGlmKG1lc3NEYXRhICE9PSBcIllcIiAmJiBtZXNzRGF0YSAhPT0gXCJOXCIpe1xuICAgICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiSW52YWxpZCBjaGFyYWN0ZXIsIHR5cGUgYWdhaW4gKFkvTikuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYobWVzc0RhdGEgPT0gXCJOXCIpe1xuICAgICAgICAgICAgZmxpcENyZWF0aW5nKGZhbHNlLCBzZW5kZXJJRCk7XG4gICAgICAgICAgICByZW1pbmRlci5kYXRlLnNldEhvdXJzKHJlbWluZGVyLmRhdGUuZ2V0SG91cnMoKS10aW1lem9uZSk7XG4gICAgICAgICAgICBhZGREQihcIlJlbWluZGVyXCIsIHJlbWluZGVyLCBzZW5kZXJJRCwgZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgICAgdmFyIGRvYyA9IGRvYy5vcHNbMF07XG4gICAgICAgICAgICAgIHNjaGVkdWxlLnNjaGVkdWxlSm9iKGRvYy5kYXRlLCBmdW5jdGlvbih4KXtcbiAgICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlJlbWluZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5maW5kKHtcIl9pZFwiOiBPYmplY3RJZChkb2MuX2lkKX0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRvY3MubGVuZ3RoICE9IDApe1xuICAgICAgICAgICAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgeC5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0uYmluZChudWxsLCBkb2MpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgIHRleHQ6IFwiRXZlbnQgYWRkZWQgc3VjY2Vzc2Z1bGx5IVwiXG4gICAgICAgICAgICB9OyAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVwbGFjZUNvdW50ZXIoMCAsc2VuZGVySUQpO1xuICAgICAgICAgICAgcmVtaW5kZXIgPSB7fTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHJlc3BvbmRUZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIldoYXQgaXMgdGhlIGxvY2F0aW9uPyBUeXBlIHNraXAgaWYgbm9uZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9OyAgXG4gICAgICAgICAgICBpbmNyZW1lbnRDb3VudGVyKHNlbmRlcklEKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihjb3VudGVyID09IDMpe1xuICAgICAgICAgIGlmKG1lc3NEYXRhICE9IFwic2tpcFwiKSB7XG4gICAgICAgICAgICAvL3JlbWluZGVyLmxvY2F0aW9uID0gbWVzc2FnZVRleHQ7XG4gICAgICAgICAgICB2YXIgcGxhY2VzID0gZ2V0TG9jYXRpb24obWVzc0RhdGEpO1xuICAgICAgICAgICAgdmFyIGxvbmcsIGxhdDtcbiAgICAgICAgICAgIHZhciBidXR0b25zID0gW107XG4gICAgICAgICAgICBmb3IodmFyIGk9MDsgaTxNYXRoLm1pbigzLCBwbGFjZXMubGVuZ3RoKTsgaSsrKXtcbiAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IHt0eXBlOlwicG9zdGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTpwbGFjZXNbaV1bJ25hbWUnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShwbGFjZXNbaV0pfVxuICAgICAgICAgICAgICBidXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgIGF0dGFjaG1lbnQ6e1xuICAgICAgICAgICAgICAgIHR5cGU6XCJ0ZW1wbGF0ZVwiLFxuICAgICAgICAgICAgICAgIHBheWxvYWQ6e1xuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVfdHlwZTpcImJ1dHRvblwiLFxuICAgICAgICAgICAgICAgICAgdGV4dDpcIkNob29zZSBhIGxvY2F0aW9uOiBcIixcbiAgICAgICAgICAgICAgICAgIGJ1dHRvbnM6IGJ1dHRvbnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07ICBcbiAgICAgICAgICAgIC8vcmVzcG9uZFRleHQuYXR0YWNobWVudC5wYXlsb2FkLmJ1dHRvbnMgPSBidXR0b25zO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhidXR0b25zKTtcbiAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6cmVzcG9uZFRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0eXBlb2YgcmVzcG9uZFRleHQuYXR0YWNobWVudC5wYXlsb2FkLmJ1dHRvbnMpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uZFRleHQuYXR0YWNobWVudC5wYXlsb2FkLmJ1dHRvbnMpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uZFRleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNle1xuICAgICAgICAgIHJlc3BvbmRUZXh0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIkF0dGFjaCBhbnkgZmlsZXMuIFR5cGUgc2tpcCBvZiBub25lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07ICBcbiAgICAgICAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBcbiAgICAgICAgICAvL3Jlc3BvbmRUZXh0ID0gXCJBdHRhY2ggYW55IGZpbGVzLiBUeXBlIHNraXAgb2Ygbm9uZVwiO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb3VudGVyID09IDQpe1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlbWluZGVyKTtcbiAgICAgICAgICByZW1pbmRlci5hdHRhY2htZW50ID0ge3VybDogXCJcIiwgdHlwZTogXCJcIn1cbiAgICAgICAgICBpZiAobWVzc0RhdGFbMF0udHlwZSl7XG4gICAgICAgICAgICBzZW5kQ29uZmlybShzZW5kZXJJRCwgbWVzc0RhdGFbMF0ucGF5bG9hZC51cmwsIG1lc3NEYXRhWzBdLnR5cGUsIFwiQXR0YWNobWVudFwiKTtcbiAgICAgICAgICAgIC8vTGF0ZXIgd2lsbCBjaGVjayBmb3IgdG90YWwgZWxlbWVudCBpbiBkYXRhYmFzZSBmaWxlc1xuICAgICAgICAgICAgcmVtaW5kZXIuYXR0YWNobWVudCA9IHt1cmw6IFwiaHR0cHM6Ly9wcmV2aWV3LmM5dXNlcnMuaW8vbWluaHRyaTEyOTYvcHJvamVjdDEvZmlsZS11cGxvYWQvdGVzdC5wbmdcIiwgdHlwZTogbWVzc0RhdGFbMF0udHlwZX07XG4gICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAvL2FkZERCKFwiUmVtaW5kZXJcIiwgcmVtaW5kZXIsIHNlbmRlcklEKTtcbiAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJGaW5zaGVkIGNyZWF0aW5nIHJlbWluZGVyLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9OyAgICAgICAgICAgIFxuICAgICAgICAgIGZsaXBDcmVhdGluZyhmYWxzZSwgc2VuZGVySUQpO1xuICAgICAgICAgIHJlcGxhY2VDb3VudGVyKDAsc2VuZGVySUQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3VjY2VzcyFcIik7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVtaW5kZXIpO1xuICAgICAgICAgIHJlbWluZGVyLmRhdGUuc2V0SG91cnMocmVtaW5kZXIuZGF0ZS5nZXRIb3VycygpLXRpbWV6b25lKTtcbiAgICAgICAgICBhZGREQihcIlJlbWluZGVyXCIsIHJlbWluZGVyLCBzZW5kZXJJRCwgZnVuY3Rpb24oZG9jKXtcbiAgICAgICAgICAgIHZhciBkb2MgPSBkb2Mub3BzWzBdO1xuICAgICAgICAgICAgc2NoZWR1bGUuc2NoZWR1bGVKb2IocmVtaW5kZXIuZGF0ZSwgZnVuY3Rpb24oeCl7XG4gICAgICAgICAgICAgIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJSZW1pbmRlclwiKTtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmZpbmQoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgICAgICAgICAgICAgICBpZihkb2NzLmxlbmd0aCAhPSAwKXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWluZGVyLmF0dGFjaG1lbnQpeyAgXG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhdHRhY2htZW50XCI6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiByZW1pbmRlci5hdHRhY2htZW50LnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXlsb2FkXCI6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cmxcIjogcmVtaW5kZXIuYXR0YWNobWVudC51cmxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYocmVtaW5kZXIubG9jYXRpb24pe1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IEpTT04ucGFyc2UocmVtaW5kZXIubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICBjYWxsU2VuZEFQSSh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcImF0dGFjaG1lbnRcIjp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6XCJ0ZW1wbGF0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGF5bG9hZFwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGVtcGxhdGVfdHlwZVwiOlwiZ2VuZXJpY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbGVtZW50c1wiOltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCI6IGxvY2F0aW9uLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaW1hZ2VfdXJsXCI6XCJodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RhdGljbWFwP2NlbnRlcj1cIitsb2NhdGlvbi5sYXRpdHVkZStcIixcIitsb2NhdGlvbi5sb25naXR1ZGUrXCImem9vbT0xNSZzaXplPTYwMHgzMDAmbWFwdHlwZT1yb2FkbWFwJm1hcmtlcnM9Y29sb3I6cmVkfFwiK2xvY2F0aW9uLmxhdGl0dWRlK1wiLFwiK2xvY2F0aW9uLmxvbmdpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YnRpdGxlXCI6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG8gYXQgdGhpcyBsb2NhdGlvbjogXFxcIlwiICsgcmVtaW5kZXIuY29udGVudCArIFwiXFxcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYnV0dG9uc1wiOltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6XCJ3ZWJfdXJsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6XCJodHRwczovL3d3dy5nb29nbGUuY29tL21hcHMvcGxhY2UvXCIrbG9jYXRpb24ubmFtZStcIi9AXCIrbG9jYXRpb24ubGF0aXR1ZGUrXCIsXCIrbG9jYXRpb24ubG9uZ2l0dWRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCI6XCJnbyB0byBHb29nbGUgTWFwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnJlbW92ZSh7XCJfaWRcIjogT2JqZWN0SWQoZG9jLl9pZCl9KTtcbiAgICAgICAgICAgICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJIZXJlIGlzIHNvbWV0aGluZyB5b3UgbmVlZCB0byBkbzogXCIgKyByZW1pbmRlci5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0uYmluZChudWxsLCBkb2MpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVzc2FnZURhdGEgPSB7XG4gICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbmRUZXh0XG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwidGVzdFwiKTtcbiAgICAgICAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZyhjb3VudGVyKTtcbiAgICAgICAgY2hhbmdlUmVtaW5kZXIoc2VuZGVySUQsIHJlbWluZGVyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn1cblxuXG5mdW5jdGlvbiByZWNlaXZlZFBvc3RiYWNrKGV2ZW50KSB7XG4gIHZhciBzZW5kZXJJRCA9IGV2ZW50LnNlbmRlci5pZDtcbiAgdmFyIHJlY2lwaWVudElEID0gZXZlbnQucmVjaXBpZW50LmlkO1xuICB2YXIgdGltZU9mUG9zdGJhY2sgPSBldmVudC50aW1lc3RhbXA7XG5cbiAgLy8gVGhlICdwYXlsb2FkJyBwYXJhbSBpcyBhIGRldmVsb3Blci1kZWZpbmVkIGZpZWxkIHdoaWNoIGlzIHNldCBpbiBhIHBvc3RiYWNrIFxuICAvLyBidXR0b24gZm9yIFN0cnVjdHVyZWQgTWVzc2FnZXMuIFxuICB2YXIgcGF5bG9hZCA9IGV2ZW50LnBvc3RiYWNrLnBheWxvYWQ7XG5cbiAgY29uc29sZS5sb2coXCJSZWNlaXZlZCBwb3N0YmFjayBmb3IgdXNlciAlZCBhbmQgcGFnZSAlZCB3aXRoIHBheWxvYWQgJyVzJyBcIiArIFxuICAgIFwiYXQgJWRcIiwgc2VuZGVySUQsIHJlY2lwaWVudElELCBwYXlsb2FkLCB0aW1lT2ZQb3N0YmFjayk7XG5cbiAgLy8gV2hlbiBhIHBvc3RiYWNrIGlzIGNhbGxlZCwgd2UnbGwgc2VuZCBhIG1lc3NhZ2UgYmFjayB0byB0aGUgc2VuZGVyIHRvIFxuICAvLyBsZXQgdGhlbSBrbm93IGl0IHdhcyBzdWNjZXNzZnVsXG4gIFxuICAvL0RvIFNvbWV0aGluZyBhZnRlciB1c2VycyBjbGlja2VkIEdldCBTdGFydGVkIGJ1dHRvbiBcbiAgaWYoZXZlbnQucG9zdGJhY2sucGF5bG9hZCA9PT0gXCJHRVRfU1RBUlRFRF9QQVlMT0FEXCIpe1xuICAgIGNhbGxVc2VyUHJvZmlsZUFQSShzZW5kZXJJRCwgZnVuY3Rpb24oYm9keSl7XG4gICAgICB2YXIgbmFtZSA9IGJvZHkuZmlzdF9uYW1lICsgXCIgXCIgKyBib2R5LmZpc3RfbmFtZTtcbiAgICAgIHNlbmRXZWxjb21lTWVzc2FnZShzZW5kZXJJRCwgbmFtZSk7XG4gICAgfSlcbiAgICBcbiAgfVxuICBlbHNle1xuICAgIGNvbnNvbGUubG9nKFwidGVzdDJcIik7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcInJlbWluZGVyXCIsIGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgIGNvbnNvbGUubG9nKHJlbWluZGVyKTtcbiAgICAgIHJlbWluZGVyLmxvY2F0aW9uID0gcGF5bG9hZDtcbiAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShwYXlsb2FkKTtcbiAgICAgIGNvbnNvbGUubG9nKHBheWxvYWQpO1xuICAgICAgY29uc29sZS5sb2cocmVtaW5kZXIpO1xuICAgICAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgIHRleHQ6IFwiQXR0YWNoIGFueSBmaWxlcy4gVHlwZSBza2lwIG9mIG5vbmVcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY2hhbmdlUmVtaW5kZXIoc2VuZGVySUQsIHJlbWluZGVyKTtcbiAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgIH0pO1xuICB9XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBTZW5kaW5nIGhlbHBlcnNcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5mdW5jdGlvbiBzZW5kVGV4dE1lc3NhZ2Uoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KSB7XG4gIGNvbnZlcnNhdGlvbi5tZXNzYWdlKHtcbiAgICB3b3Jrc3BhY2VfaWQ6ICcxZTc1NzNmNS05MzlkLTQ3ZTMtODY5MC01ZWYxYzA5NDZiNjMnLFxuICAgIGlucHV0OiB7J3RleHQnOiBtZXNzYWdlVGV4dH0sXG4gICAgY29udGV4dDogY29udGV4dFxuICB9LCAgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuICAgIGlmIChlcnIpXG4gICAgICBjb25zb2xlLmxvZygnZXJyb3I6JywgZXJyKTtcbiAgICBlbHNle1xuICAgICAgXG4gICAgICB2YXIgbWVzc2FnZURhdGE7XG4gICAgICBpZihyZXNwb25zZS5pbnRlbnRzWzBdKXtcbiAgICAgICAgdmFyIGNvbW1hbmQgPSByZXNwb25zZS5pbnRlbnRzWzBdLmludGVudDtcbiAgICAgICAgdmFyIHJlc3BvbmQgPSBcIlwiO1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgY2FzZSAnbGlzdCc6XG4gICAgICAgICAgbGlzdChzZW5kZXJJRCwgZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBzdHJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICduZXh0JzpcbiAgICAgICAgICBuZXh0UmVtaW5kZXIoc2VuZGVySUQsIGZ1bmN0aW9uKHN0cil7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHsgd2Vla2RheTogXCJsb25nXCIsIHllYXI6IFwibnVtZXJpY1wiLCBtb250aDogXCJzaG9ydFwiLCAgXG4gICAgICAgICAgICAgIGRheTogXCJudW1lcmljXCIgfTsgIFxuICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgc3RyLmNvbnRlbnQgKyBcIiBhZnRlciBcIiArIHN0ci5kYXRlLnRvTG9jYWxlVGltZVN0cmluZyhcImVuLVVTXCIsIG9wdGlvbnMpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICByZXNwb25kID0gXCJXaGF0IGRvIHlvdSB3YW50IHRvIHJlbWluZCBhYm91dD9cIjtcbiAgICAgICAgICBmbGlwQ3JlYXRpbmcodHJ1ZSwgc2VuZGVySUQpO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaGVscCc6XG4gICAgICAgICAgY2FsbFVzZXJQcm9maWxlQVBJKHNlbmRlcklELCBmdW5jdGlvbihib2R5KXtcbiAgICAgICAgICAgIHZhciBuYW1lID0gYm9keS5maXN0X25hbWUgKyBcIiBcIiArIGJvZHkuZmlzdF9uYW1lO1xuICAgICAgICAgICAgc2VuZFdlbGNvbWVNZXNzYWdlKHNlbmRlcklELCBuYW1lKTtcbiAgICAgICAgICB9KSAgXG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgZGJVdGlsLmdldFNvcnRlZExpc3Qoc2VuZGVySUQsIFwiUmVtaW5kZXJcIiwgZnVuY3Rpb24obGlzdCl7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IE51bWJlcihtZXNzYWdlVGV4dC5zdWJzdHIobWVzc2FnZVRleHQubGVuZ3RoLTEsIDEpKS0xO1xuICAgICAgICAgICAgICBpZihpbmRleCA+PSAwICYmIGluZGV4IDwgbGlzdC5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxpc3RbaW5kZXhdLl9pZDtcbiAgICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlJlbWluZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGlkKX0sIGZ1bmN0aW9uKGVyciwgZG9jKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcImRlbGV0ZWQgXCIgKyBsaXN0W2luZGV4XS5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnaGknOlxuICAgICAgICAgICAgcmVzcG9uZCA9IFwiSGVsbG9cIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RoeCc6XG4gICAgICAgICAgICByZXNwb25kID0gXCJZb3UncmUgd2VsY29tZVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnYnllJzpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gXCJHb29kIGJ5ZSFcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3dobyc6XG4gICAgICAgICAgICByZXNwb25zZSA9IFwiTXkgbmFtZSBpcyBCb2JcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJlc3BvbmQgPSBjb21tYW5kO1xuICAgICAgICB9O1xuICAgICAgICBtZXNzYWdlRGF0YSA9IHtcbiAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdGV4dDogcmVzcG9uZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZXtcbiAgICAgICAgdmFyIGZ1bm55UXVvdGVzID0gWydcIkhvdyBkbyB5b3UgZ2V0IGEgc3dlZXQgbGl0dGxlIDgwLXllYXItb2xkIGxhZHkgdG8gc2F5IHRoZSBGIHdvcmQ/IEdldCBhbm90aGVyIHN3ZWV0IGxpdHRsZSA4MC15ZWFyLW9sZCBsYWR5IHRvIHllbGwgXCJCSU5HTyFcIiAtIEFub255bW91cycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdLbm93bGVkZ2UgaXMga25vd2luZyBhIHRvbWF0byBpcyBhIGZydWl0OyB3aXNkb20gaXMgbm90IHB1dHRpbmcgaXQgaW4gYSBmcnVpdCBzYWxhZC4gLSBNaWxlcyBLaW5ndG9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ0J5IGFsbCBtZWFucywgbWFycnkuIElmIHlvdSBnZXQgYSBnb29kIHdpZmUsIHlvdeKAmWxsIGJlY29tZSBoYXBweTsgaWYgeW91IGdldCBhIGJhZCBvbmUsIHlvdeKAmWxsIGJlY29tZSBhIHBoaWxvc29waGVyLiAtIFNvY3JhdGVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RoZSBiZXN0IHdheSB0byBsaWUgaXMgdG8gdGVsbCB0aGUgdHJ1dGggLiAuIC4gY2FyZWZ1bGx5IGVkaXRlZCB0cnV0aC4gLSBBbm9ueW1vdXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnSWYgeW91IHN0ZWFsIGZyb20gb25lIGF1dGhvciwgaXTigJlzIHBsYWdpYXJpc207IGlmIHlvdSBzdGVhbCBmcm9tIG1hbnksIGl04oCZcyByZXNlYXJjaC4gLSBXaWxzb24gTWl6bmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lmIGV2b2x1dGlvbiByZWFsbHkgd29ya3MsIGhvdyBjb21lIG1vdGhlcnMgb25seSBoYXZlIHR3byBoYW5kcz8gLSBNaWx0b24gQmVybGUnXTtcbiAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqNik7XG4gICAgICAgIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICB0ZXh0OiBmdW5ueVF1b3Rlc1tpXSArIFwiXFxuU29ycnkgZm9yIG5vdCB1bmRlcnN0YW5kaW5nIHlvdS4gQnV0IGFib3ZlIGlzIGEgZnVubnkgcXVvdGVcIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYobWVzc2FnZURhdGEubWVzc2FnZS50ZXh0KSBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSk7XG4gICAgfVxuICB9KTtcbn1cblxuXG5mdW5jdGlvbiBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSkge1xuICByZXF1ZXN0KHtcbiAgICB1cmk6ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92Mi42L21lL21lc3NhZ2VzJyxcbiAgICBxczogeyBhY2Nlc3NfdG9rZW46IHByb2Nlc3MuZW52LlBBR0VfQUNDRVNTX1RPS0VOIH0sXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAganNvbjogbWVzc2FnZURhdGFcblxuICB9LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgaWYgKCFlcnJvciAmJiByZXNwb25zZS5zdGF0dXNDb2RlID09IDIwMCkge1xuICAgICAgdmFyIHJlY2lwaWVudElkID0gYm9keS5yZWNpcGllbnRfaWQ7XG4gICAgICB2YXIgbWVzc2FnZUlkID0gYm9keS5tZXNzYWdlX2lkO1xuXG4gICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHNlbnQgZ2VuZXJpYyBtZXNzYWdlIHdpdGggaWQgJXMgdG8gcmVjaXBpZW50ICVzXCIsIG1lc3NhZ2VJZCwgcmVjaXBpZW50SWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICBjb25zb2xlLmVycm9yKHJlc3BvbnNlKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfSk7ICBcbn1cbi8vI25leHRcbmZ1bmN0aW9uIG5leHRSZW1pbmRlcihzZW5kZXJJRCwgY2Ipe1xuICBnZXRMaXN0KHNlbmRlcklELCBcIlJlbWluZGVyXCIsIGZ1bmN0aW9uKGxpc3Qpe1xuICAgIGlmKGxpc3RbMF0pe1xuICAgICAgY2IobGlzdFswXSk7XG4gICAgfSBcbiAgICBlbHNlIGNiKFwiTm8gUmVtaW5kZXJcIik7XG4gIH0pO1xufVxuXG5cbi8vI2xpc3RcbmZ1bmN0aW9uIGxpc3Qoc2VuZGVySUQsIGNiKXtcbiAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcInRpbWV6b25lXCIsIGZ1bmN0aW9uKHRpbWV6b25lKXtcbiAgICBkYlV0aWwuZ2V0U29ydGVkTGlzdChzZW5kZXJJRCwgXCJSZW1pbmRlclwiLCBmdW5jdGlvbihsaXN0KXtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgICAgdmFyIGRheSA9IHJlbWluZGVyLmRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICB2YXIgbW9udGggPSByZW1pbmRlci5kYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgICAgICB2YXIgeWVhciA9IHJlbWluZGVyLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgdmFyIGhvdXIgPSByZW1pbmRlci5kYXRlLmdldEhvdXJzKCkrdGltZXpvbmU7XG4gICAgICAgIHZhciBtaW51dGUgPSByZW1pbmRlci5kYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgc3RyICs9IGkgKyBcIi4gQ29udGVudDogXCIgKyByZW1pbmRlci5jb250ZW50ICsgXCJcXG4gICBEYXRlOiBcIiArIG1vbnRoICsgXCIvXCIgKyBkYXkgKyBcIi9cIiArIHllYXIgXG4gICAgICAgICAgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZSArIFwiXFxuICAgTG9jYXRpb246IFwiICsgKHJlbWluZGVyLmxvY2F0aW9uICE9PSB1bmRlZmluZWQgPyBKU09OLnBhcnNlKHJlbWluZGVyLmxvY2F0aW9uKS5uYW1lIDogXCJub25lXCIpKyBcIlxcblwiO1xuICAgICAgICBpKys7XG4gICAgICB9KTtcbiAgICAgIGlmKCFzdHIpIHN0ciA9IFwiTm8gcmVtaW5kZXJzXCI7XG4gICAgICBjYihzdHIpO1xuICAgIH0pO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGNvbnRhaW5zT2JqZWN0KGlkLCBsaXN0KSB7XG4gICAgdmFyIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGxpc3RbaV0udXNlcmlkID09IGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskaW5jOntcImNvdW50ZXJcIjoxfX0pO1xuICB9KVxufVxuZnVuY3Rpb24gcmVwbGFjZUNvdW50ZXIodmFsdWUsIHNlbmRlcklEKXtcbiAgTW9uZ29DbGllbnQuY29ubmVjdCh1cmwxLCBmdW5jdGlvbiAoZXJyLCBkYikge1xuICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlVzZXJcIik7XG4gICAgY29sbGVjdGlvbi5maW5kT25lQW5kVXBkYXRlKHtcInVzZXJpZFwiOnNlbmRlcklEfSx7JHNldDp7XCJjb3VudGVyXCIgOiB2YWx1ZX19KTtcbiAgfSlcbn1cbmZ1bmN0aW9uIGZsaXBDcmVhdGluZyh2YWx1ZSwgc2VuZGVySUQpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskc2V0OntcImNyZWF0aW5nXCIgOiB2YWx1ZX19KTtcbiAgfSlcbn1cbi8vRnVuY3Rpb24gZm9yIGRhdGFiYXNlICgjZGF0YWJhc2UpXG5mdW5jdGlvbiBhZGREQihuYW1lLCBvYmplY3QsIHNlbmRlcklELCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24obmFtZSk7XG4gICAgY29sbGVjdGlvbi5pbnNlcnQob2JqZWN0LCBmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgaWYoZXJyKSBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgaWYoY2IpIGNiKGRvY3MpO1xuICAgICAgZGIuY2xvc2UoKTtcbiAgICB9KTtcbiAgfSlcbn1cbmZ1bmN0aW9uIGdldERCKG5hbWUsIGNiKXtcbiAgTW9uZ29DbGllbnQuY29ubmVjdCh1cmwxLCBmdW5jdGlvbiAoZXJyLCBkYikge1xuICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihuYW1lKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe30se19pZDowfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3MpIHtcbiAgICAgIGRiLmNsb3NlKCk7XG4gICAgICBjYihkb2NzKTtcbiAgICB9KVxuICB9KVxufVxuZnVuY3Rpb24gY2hhbmdlUmVtaW5kZXIoc2VuZGVySUQsIHZhbHVlKXtcbiAgTW9uZ29DbGllbnQuY29ubmVjdCh1cmwxLCBmdW5jdGlvbiAoZXJyLCBkYikge1xuICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlVzZXJcIik7XG4gICAgY29sbGVjdGlvbi5maW5kT25lQW5kVXBkYXRlKHtcInVzZXJpZFwiOnNlbmRlcklEfSx7JHNldDp7XCJyZW1pbmRlclwiIDogdmFsdWV9fSk7XG4gIH0pXG59XG5mdW5jdGlvbiBnZXRQcm9wZXJ0eShzZW5kZXJJRCwgY29sbGVjdGlvbk5hbWUsIHByb3BlcnR5LCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZSh7XCJ1c2VyaWRcIjogc2VuZGVySUR9LCBmdW5jdGlvbihlcnIsIHJldCl7XG4gICAgICBjYihyZXRbcHJvcGVydHldKTtcbiAgICB9KTtcbiAgfSlcbn1cbmZ1bmN0aW9uIGdldExpc3Qoc2VuZGVySUQsIGNvbGxlY3Rpb25OYW1lLCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZCh7XCJ1c2VyaWRcIjogc2VuZGVySUR9KS50b0FycmF5KGZ1bmN0aW9uKGVyciwgZG9jcyl7XG4gICAgICBjYihkb2NzKTtcbiAgICB9KTtcbiAgfSlcbn1cblxuZnVuY3Rpb24gY2hlY2tEYXRlKHRlc3REYXRlLCBwYXJ0cywgdGltZXpvbmUpe1xuICB2YXIgY3VyRGF0ZSA9IG5ldyBEYXRlKCk7XG4gIHRlc3REYXRlLnNldEhvdXJzKHRlc3REYXRlLmdldEhvdXJzKCktdGltZXpvbmUpO1xuICB2YXIgeWVhciA9IE51bWJlcigyMCtwYXJ0cy5zdWJzdHIoNiwyKSk7XG4gIHZhciBtb250aCA9IE51bWJlcihwYXJ0cy5zdWJzdHIoMCwyKSktMTtcbiAgdmFyIGRhdGUgPSBOdW1iZXIocGFydHMuc3Vic3RyKDMsMikpO1xuICB2YXIgaG91ciA9IE51bWJlcihwYXJ0cy5zdWJzdHIoOSwyKSk7XG4gIHZhciBtaW51dGUgPSBOdW1iZXIocGFydHMuc3Vic3RyKDEyLDIpKTtcbiAgaWYgKGN1ckRhdGUuZ2V0VGltZSgpPnRlc3REYXRlLmdldFRpbWUoKSkgcmV0dXJuIFwiSW52YWxpZCBkYXRlISBQbGVhc2UgaW5zZXJ0IHRpbWUgaW4gdGhlIGZ1dHVyZSBmb3IgeW91ciByZW1pbmRlclwiO1xuICB0ZXN0RGF0ZS5zZXRIb3Vycyh0ZXN0RGF0ZS5nZXRIb3VycygpK3RpbWV6b25lKTtcbiAgaWYgKHllYXIhPXRlc3REYXRlLmdldEZ1bGxZZWFyKCl8fG1vbnRoIT10ZXN0RGF0ZS5nZXRNb250aCgpfHxkYXRlIT10ZXN0RGF0ZS5nZXREYXRlKCl8fGhvdXIhPXRlc3REYXRlLmdldEhvdXJzKCl8fG1pbnV0ZSE9dGVzdERhdGUuZ2V0TWludXRlcygpKXtcbiAgcmV0dXJuIFwiSW52YWxpZCBkYXRlIGZvcm1hdCEgUGxlYXNlIHR5cGUgYWdhaW4hXCI7XG4gIH1cbiAgcmV0dXJuIFwiRG8geW91IHdhbnQgYWRkIG1vcmUgaW5mb3JtYXRpb24/IChZIGZvciB5ZXMsIE4gZm9yIE5vKVwiO1xufVxuXG5mdW5jdGlvbiBnZXRMb2NhdGlvbihsb2NhdGlvbil7XG4gIHZhciBwbGFjZXMgPSBbXTtcbiAgdmFyIHVybCA9IFwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3BsYWNlL3RleHRzZWFyY2gvanNvbj9xdWVyeT1cIiArIGxvY2F0aW9uICsgXCIma2V5PVwiICsgcHJvY2Vzcy5lbnYuR09PR0xFX0FQSV9LRVk7XG4gIHZhciByZXMgPSBzUmVxdWVzdCgnR0VUJywgdXJsLCB7XG4gICAgICAgICAgICB0aW1lb3V0OiAxMDAwMCAgXG4gICAgICAgIH0pO1xuICB2YXIgZGF0YSA9ICBKU09OLnBhcnNlKHJlcy5nZXRCb2R5KCd1dGY4JykpO1xuICBcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnJlc3VsdHMubGVuZ3RoOyBpKyspe1xuICAgIHZhciBwbGFjZSA9IHtcIm5hbWVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZm9ybWF0dGVkX2FkZHJlc3NcIl0sIFxuICAgICAgICAgICAgICAgIFwibGF0aXR1ZGVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZ2VvbWV0cnlcIl1bXCJsb2NhdGlvblwiXVtcImxhdFwiXSxcbiAgICAgICAgICAgICAgICBcImxvbmdpdHVkZVwiOiBkYXRhLnJlc3VsdHNbaV1bXCJnZW9tZXRyeVwiXVtcImxvY2F0aW9uXCJdW1wibG5nXCJdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAvL3ZhciBtZXNzYWdlSWQgPSBib2R5Lm1lc3NhZ2VfaWQ7XG4gICAgcGxhY2VzLnB1c2gocGxhY2UpO1xuICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCBwbGFjZSBcIisgcGxhY2UubmFtZSArIFwiIGxvbmdpdHVkZSA9IFwiICsgcGxhY2UubG9uZ2l0dWRlKTtcbiAgfSAgXG4gIHJldHVybiBwbGFjZXM7XG59XG5cbi8vIFNldCBFeHByZXNzIHRvIGxpc3RlbiBvdXQgZm9yIEhUVFAgcmVxdWVzdHNcbnZhciBzZXJ2ZXIgPSBhcHAubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMCwgZnVuY3Rpb24gKCkge1xuICBjb25zb2xlLmxvZyhcIkxpc3RlbmluZyBvbiBwb3J0ICVzXCIsIHNlcnZlci5hZGRyZXNzKCkucG9ydCk7XG59KTtcbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "bot.js"
      ],
      "names": [
        "ObjectId",
        "require",
        "ObjectID",
        "schedule",
        "watson",
        "mongodb",
        "express",
        "bodyParser",
        "sRequest",
        "request",
        "path",
        "dbUtil",
        "http",
        "fs",
        "messengerButton",
        "userName",
        "conversation",
        "username",
        "password",
        "version",
        "version_date",
        "context",
        "app",
        "use",
        "json",
        "urlencoded",
        "extended",
        "MongoClient",
        "url1",
        "get",
        "req",
        "res",
        "query",
        "process",
        "env",
        "VERIFY_TOKEN",
        "console",
        "log",
        "status",
        "send",
        "error",
        "sendStatus",
        "writeHead",
        "write",
        "end",
        "post",
        "data",
        "body",
        "object",
        "entry",
        "forEach",
        "pageID",
        "id",
        "timeOfEvent",
        "time",
        "messaging",
        "event",
        "callUserProfileAPI",
        "sender",
        "userData",
        "userid",
        "counter",
        "keywords",
        "creating",
        "reminder",
        "timezone",
        "getDB",
        "collection",
        "containsObject",
        "addDB",
        "message",
        "receivedMessage",
        "postback",
        "receivedPostback",
        "senderID",
        "cb",
        "uri",
        "PAGE_ACCESS_TOKEN",
        "method",
        "response",
        "statusCode",
        "JSON",
        "parse",
        "first_name",
        "last_name",
        "recipientID",
        "recipient",
        "timeOfMessage",
        "timestamp",
        "messageId",
        "mid",
        "messageText",
        "text",
        "messageAttachments",
        "attachments",
        "getProperty",
        "p",
        "newReminder",
        "sendTextMessage",
        "sendConfirm",
        "payload",
        "url",
        "type",
        "fileType",
        "replace",
        "urlReq",
        "sendWelcomeMessage",
        "senderId",
        "name",
        "messageData",
        "callSendAPI",
        "sendHelpMessage",
        "messData",
        "respondText",
        "content",
        "incrementCounter",
        "parts",
        "date",
        "Date",
        "substr",
        "Number",
        "checkDate",
        "flipCreating",
        "setHours",
        "getHours",
        "doc",
        "ops",
        "scheduleJob",
        "x",
        "connect",
        "err",
        "db",
        "find",
        "_id",
        "toArray",
        "docs",
        "length",
        "remove",
        "close",
        "bind",
        "replaceCounter",
        "places",
        "getLocation",
        "long",
        "lat",
        "buttons",
        "i",
        "Math",
        "min",
        "button",
        "title",
        "stringify",
        "push",
        "attachment",
        "template_type",
        "location",
        "latitude",
        "longitude",
        "changeReminder",
        "timeOfPostback",
        "fist_name",
        "workspace_id",
        "input",
        "intents",
        "command",
        "intent",
        "respond",
        "list",
        "str",
        "nextReminder",
        "options",
        "weekday",
        "year",
        "month",
        "day",
        "toLocaleTimeString",
        "getSortedList",
        "index",
        "funnyQuotes",
        "floor",
        "random",
        "qs",
        "access_token",
        "recipientId",
        "recipient_id",
        "message_id",
        "getList",
        "getDate",
        "getMonth",
        "getFullYear",
        "hour",
        "minute",
        "getMinutes",
        "undefined",
        "findOneAndUpdate",
        "$inc",
        "value",
        "$set",
        "insert",
        "collectionName",
        "property",
        "findOne",
        "ret",
        "testDate",
        "curDate",
        "getTime",
        "GOOGLE_API_KEY",
        "timeout",
        "getBody",
        "results",
        "place",
        "server",
        "listen",
        "PORT",
        "address",
        "port"
      ],
      "mappings": "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",
      "file": "bot.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\nconst ObjectId = require('mongodb').ObjectID;\nconst schedule = require('node-schedule');\nconst watson = require('watson-developer-cloud');\nconst mongodb = require(\"mongodb\")\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst sRequest = require('sync-request');\nconst request = require('request');\nconst path = require('path');\nconst dbUtil = require('./dbUtil');\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nlet app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function(req, res) {\n  if (req.query['hub.mode'] === 'subscribe' &&\n      req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);          \n  }\n});\n\n// Display the web page\napp.get('/', function(req, res) {\n  res.writeHead(200, {'Content-Type': 'text/html'});\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {    \n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function(entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function(event) {\n        callUserProfileAPI(event.sender.id, function(body){\n          var userData = {userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone};\n          getDB(\"User\", function(collection){\n            if(!containsObject(event.sender.id, collection)){\n              addDB(\"User\", userData, event.sender.id);              \n            }\n            if (event.message) {\n              receivedMessage(event); \n            } else if (event.postback) {\n              receivedPostback(event); \n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n        \n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb){\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function(error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      //userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if(cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\n// Incoming events handling\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", \n    senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n  \n  if (messageText) {\n    getProperty(senderID, \"User\", \"creating\", function(p){\n      if(p) newReminder(senderID, messageText);\n      else{\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n      getProperty(senderID, \"User\", \"creating\", function(p){\n        if(p) newReminder(senderID, messageAttachments);\n        else sendConfirm(senderID, messageAttachments[0].payload.url, messageAttachments[0].type,\"Attachment\");\n      })      \n  }\n}\n\nfunction sendConfirm(senderID, url, fileType, message){\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\"+url;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function(error, response, body) {\n      console.log(\"DONE!\");\n  })\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" +\n      \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \n      \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \n      \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\" +\n      \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\nfunction newReminder(senderID, messData){\n  var respondText;\n  getProperty(senderID, \"User\", \"counter\", function(counter){\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      getProperty(senderID, \"User\", \"timezone\", function(timezone){\n        console.log(counter);\n        if (counter == 0){\n          reminder.userid = senderID;\n          reminder.content = messData;\n          incrementCounter(senderID);\n          respondText = {\n                          text: \"When? (mm/dd/yy-hh:mm)\"\n                        };\n        }\n        else if (counter == 1){\n          var parts =  messData;\n          reminder.date = new Date(20+parts.substr(6,2),Number(parts.substr(0,2))-1,parts.substr(3,2), Number(parts.substr(9,2)),parts.substr(12,2));\n          var text = checkDate(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") incrementCounter(senderID);\n          respondText = {\n                          text: text\n                        };\n        }\n        else if(counter == 2){\n          if(messData !== \"Y\" && messData !== \"N\"){\n            respondText = {\n                          text: \"Invalid character, type again (Y/N).\"\n                        };\n          }\n          else if(messData == \"N\"){\n            flipCreating(false, senderID);\n            reminder.date.setHours(reminder.date.getHours()-timezone);\n            addDB(\"Reminder\", reminder, senderID, function(doc){\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function(x){\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                    if (err) throw err\n                    if(docs.length != 0){\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };            \n            replaceCounter(0 ,senderID);\n            reminder = {};\n          }\n          else{\n            respondText = {\n                          text: \"What is the location? Type skip if none\"\n                        };  \n            incrementCounter(senderID);\n          }\n        }\n        else if(counter == 3){\n          if(messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = getLocation(messData);\n            var long, lat;\n            var buttons = [];\n            for(var i=0; i<Math.min(3, places.length); i++){\n              var button = {type:\"postback\",\n                            title:places[i]['name'],\n                            payload: JSON.stringify(places[i])}\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment:{\n                type:\"template\",\n                payload:{\n                  template_type:\"button\",\n                  text:\"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };  \n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      \"message\":respondText\n                        \n          })\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          }\n          else{\n          respondText = {\n                          text: \"Attach any files. Type skip of none\"\n                        };  \n            incrementCounter(senderID);\n          }\n          \n          \n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        }\n        else if (counter == 4){\n          console.log(reminder);\n          reminder.attachment = {url: \"\", type: \"\"}\n          if (messData[0].type){\n            sendConfirm(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = {url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type};\n          }\n                    \n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n                          text: \"Finshed creating reminder.\"\n                        };            \n          flipCreating(false, senderID);\n          replaceCounter(0,senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours()-timezone);\n          addDB(\"Reminder\", reminder, senderID, function(doc){\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function(x){\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err\n                var collection = db.collection(\"Reminder\");\n                collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                  if (err) throw err\n                  if(docs.length != 0){\n                    if (reminder.attachment){  \n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\":{\n                          \"attachment\":{\n                            \"type\": reminder.attachment.type,\n                            \"payload\":{\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      })\n                    }                    \n                    if(reminder.location){\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\":{\n                            \"type\":\"template\",\n                            \"payload\":{\n                              \"template_type\":\"generic\",\n                              \"elements\":[\n                                 {\n                                  \"title\": location.name,\n                                   \"image_url\":\"https://maps.googleapis.com/maps/api/staticmap?center=\"+location.latitude+\",\"+location.longitude+\"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\"+location.latitude+\",\"+location.longitude,\n                                  \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                  \"buttons\":[\n                                    {\n                                      \"type\":\"web_url\",\n                                      \"url\":\"https://www.google.com/maps/place/\"+location.name+\"/@\"+location.latitude+\",\"+location.longitude,\n                                      \"title\":\"go to Google Map\"\n                                    }\n                                  ]      \n                                }\n                              ]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                    else{\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        changeReminder(senderID, reminder);\n      });\n    });\n  });\n}\n\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \n    \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n  \n  //Do Something after users clicked Get Started button \n  if(event.postback.payload === \"GET_STARTED_PAYLOAD\"){\n    callUserProfileAPI(senderID, function(body){\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, name);\n    })\n    \n  }\n  else{\n    console.log(\"test2\");\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      console.log(payload);\n      console.log(reminder);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip of none\"\n        }\n      };\n      changeReminder(senderID, reminder);\n      incrementCounter(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: {'text': messageText},\n    context: context\n  },  function(err, response) {\n    if (err)\n      console.log('error:', err);\n    else{\n      \n      var messageData;\n      if(response.intents[0]){\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n        case 'list':\n          list(senderID, function(str){\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: str\n              }\n            });\n          });\n        break;\n        case 'next':\n          nextReminder(senderID, function(str){\n            var options = { weekday: \"long\", year: \"numeric\", month: \"short\",  \n              day: \"numeric\" };  \n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n              }\n            });\n          });\n        break;\n        case 'create':\n          respond = \"What do you want to remind about?\";\n          flipCreating(true, senderID);\n        break;\n        case 'help':\n          callUserProfileAPI(senderID, function(body){\n            var name = body.fist_name + \" \" + body.fist_name;\n            sendWelcomeMessage(senderID, name);\n          })  \n        break;\n        case 'delete':\n            dbUtil.getSortedList(senderID, \"Reminder\", function(list){\n              var index = Number(messageText.substr(messageText.length-1, 1))-1;\n              if(index >= 0 && index < list.length){\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({\"_id\": ObjectId(id)}, function(err, doc){\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n        break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            response = \"Good bye!\";\n            break;\n          case 'who':\n            response = \"My name is Bob\";\n            break;\n        default:\n          respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        }\n      }\n      else{\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous',\n                          'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington',\n                          'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates',\n                          'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous',\n                          'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner',\n                          'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random()*6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        }\n      }\n      if(messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });  \n}\n//#next\nfunction nextReminder(senderID, cb){\n  getList(senderID, \"Reminder\", function(list){\n    if(list[0]){\n      cb(list[0]);\n    } \n    else cb(\"No Reminder\");\n  });\n}\n\n\n//#list\nfunction list(senderID, cb){\n  getProperty(senderID, \"User\", \"timezone\", function(timezone){\n    dbUtil.getSortedList(senderID, \"Reminder\", function(list){\n      var i = 1;\n      var str = \"\";\n      list.forEach(function(reminder){\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours()+timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year \n          + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\")+ \"\\n\";\n        i++;\n      });\n      if(!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n}\nfunction containsObject(id, list) {\n    var i;\n    for (i = 0; i < list.length; i++) {\n        if (list[i].userid == id) {\n            return true;\n        }\n    }\n\n    return false;\n}\nfunction incrementCounter(senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$inc:{\"counter\":1}});\n  })\n}\nfunction replaceCounter(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"counter\" : value}});\n  })\n}\nfunction flipCreating(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"creating\" : value}});\n  })\n}\n//Function for database (#database)\nfunction addDB(name, object, senderID, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.insert(object, function(err, docs){\n      if(err) console.log(err);\n      if(cb) cb(docs);\n      db.close();\n    });\n  })\n}\nfunction getDB(name, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.find({},{_id:0}).toArray(function(err, docs) {\n      db.close();\n      cb(docs);\n    })\n  })\n}\nfunction changeReminder(senderID, value){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"reminder\" : value}});\n  })\n}\nfunction getProperty(senderID, collectionName, property, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.findOne({\"userid\": senderID}, function(err, ret){\n      cb(ret[property]);\n    });\n  })\n}\nfunction getList(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}\n\nfunction checkDate(testDate, parts, timezone){\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours()-timezone);\n  var year = Number(20+parts.substr(6,2));\n  var month = Number(parts.substr(0,2))-1;\n  var date = Number(parts.substr(3,2));\n  var hour = Number(parts.substr(9,2));\n  var minute = Number(parts.substr(12,2));\n  if (curDate.getTime()>testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours()+timezone);\n  if (year!=testDate.getFullYear()||month!=testDate.getMonth()||date!=testDate.getDate()||hour!=testDate.getHours()||minute!=testDate.getMinutes()){\n  return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n}\n\nfunction getLocation(location){\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n            timeout: 10000  \n        });\n  var data =  JSON.parse(res.getBody('utf8'));\n  \n  for (var i = 0; i < data.results.length; i++){\n    var place = {\"name\": data.results[i][\"formatted_address\"], \n                \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n                \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n                };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }  \n  return places;\n}\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n"
      ]
    },
    "mtime": 1491877261565
  },
  "{\"filename\":\"/app/dbUtil.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/dbUtil.js",
      "filenameRelative": "/app/dbUtil.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "dbUtil.js",
      "sourceFileName": "dbUtil.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "dbUtil"
    },
    "ignored": false,
    "code": "const mongodb = require(\"mongodb\");\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function (senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }, { \"sort\": [\"date\"] }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiVXRpbC5qcyJdLCJuYW1lcyI6WyJtb25nb2RiIiwicmVxdWlyZSIsIk1vbmdvQ2xpZW50IiwidXJsMSIsImV4cG9ydHMiLCJnZXRTb3J0ZWRMaXN0Iiwic2VuZGVySUQiLCJjb2xsZWN0aW9uTmFtZSIsImNiIiwiY29ubmVjdCIsImVyciIsImRiIiwiY29sbGVjdGlvbiIsImZpbmQiLCJ0b0FycmF5IiwiZG9jcyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsVUFBVUMsUUFBUSxTQUFSLENBQWhCO0FBQ0EsSUFBSUMsY0FBY0YsUUFBUUUsV0FBMUI7QUFDQSxJQUFJQyxPQUFPLG9FQUFYO0FBQ0FDLFFBQVFDLGFBQVIsR0FBd0IsVUFBU0MsUUFBVCxFQUFtQkMsY0FBbkIsRUFBbUNDLEVBQW5DLEVBQXNDO0FBQzVETixjQUFZTyxPQUFaLENBQW9CTixJQUFwQixFQUEwQixVQUFVTyxHQUFWLEVBQWVDLEVBQWYsRUFBbUI7QUFDM0MsUUFBSUQsR0FBSixFQUFTLE1BQU1BLEdBQU47QUFDVCxRQUFJRSxhQUFhRCxHQUFHQyxVQUFILENBQWNMLGNBQWQsQ0FBakI7QUFDQUssZUFBV0MsSUFBWCxDQUFnQixFQUFDLFVBQVVQLFFBQVgsRUFBaEIsRUFBc0MsRUFBQyxRQUFPLENBQUMsTUFBRCxDQUFSLEVBQXRDLEVBQXlEUSxPQUF6RCxDQUFpRSxVQUFTSixHQUFULEVBQWNLLElBQWQsRUFBbUI7QUFDbEZQLFNBQUdPLElBQUg7QUFDRCxLQUZEO0FBR0QsR0FORDtBQU9ELENBUkQiLCJmaWxlIjoiZGJVdGlsLmpzIiwic291cmNlUm9vdCI6Ii9hcHAiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb2RiID0gcmVxdWlyZShcIm1vbmdvZGJcIilcbnZhciBNb25nb0NsaWVudCA9IG1vbmdvZGIuTW9uZ29DbGllbnRcbnZhciB1cmwxID0gXCJtb25nb2RiOi8vdGllbmFuaDIwMDc6RGllbjEyMzRAZHMxNTcwNDAubWxhYi5jb206NTcwNDAvcmVtaW5kZXJib3RcIjtcbmV4cG9ydHMuZ2V0U29ydGVkTGlzdCA9IGZ1bmN0aW9uKHNlbmRlcklELCBjb2xsZWN0aW9uTmFtZSwgY2Ipe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe1widXNlcmlkXCI6IHNlbmRlcklEfSwge1wic29ydFwiOltcImRhdGVcIl19KS50b0FycmF5KGZ1bmN0aW9uKGVyciwgZG9jcyl7XG4gICAgICBjYihkb2NzKTtcbiAgICB9KTtcbiAgfSlcbn1cbiJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "dbUtil.js"
      ],
      "names": [
        "mongodb",
        "require",
        "MongoClient",
        "url1",
        "exports",
        "getSortedList",
        "senderID",
        "collectionName",
        "cb",
        "connect",
        "err",
        "db",
        "collection",
        "find",
        "toArray",
        "docs"
      ],
      "mappings": "AAAA,MAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAIC,cAAcF,QAAQE,WAA1B;AACA,IAAIC,OAAO,oEAAX;AACAC,QAAQC,aAAR,GAAwB,UAASC,QAAT,EAAmBC,cAAnB,EAAmCC,EAAnC,EAAsC;AAC5DN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcL,cAAd,CAAjB;AACAK,eAAWC,IAAX,CAAgB,EAAC,UAAUP,QAAX,EAAhB,EAAsC,EAAC,QAAO,CAAC,MAAD,CAAR,EAAtC,EAAyDQ,OAAzD,CAAiE,UAASJ,GAAT,EAAcK,IAAd,EAAmB;AAClFP,SAAGO,IAAH;AACD,KAFD;AAGD,GAND;AAOD,CARD",
      "file": "dbUtil.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "const mongodb = require(\"mongodb\")\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}, {\"sort\":[\"date\"]}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}\n"
      ]
    },
    "mtime": 1491876698059
  },
  "{\"filename\":\"/app/server.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/server.js",
      "filenameRelative": "/app/server.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "server.js",
      "sourceFileName": "server.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "server"
    },
    "ignored": false,
    "code": "'use strict';\n\nrequire('babel-register');\nrequire('./bot.js');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxRQUFRLGdCQUFSO0FBQ0FBLFFBQVEsVUFBUiIsImZpbGUiOiJzZXJ2ZXIuanMiLCJzb3VyY2VSb290IjoiL2FwcCIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2JhYmVsLXJlZ2lzdGVyJyk7ICBcbnJlcXVpcmUoJy4vYm90LmpzJyk7ICAiXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "server.js"
      ],
      "names": [
        "require"
      ],
      "mappings": ";;AAAAA,QAAQ,gBAAR;AACAA,QAAQ,UAAR",
      "file": "server.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "require('babel-register');  \nrequire('./bot.js');  "
      ]
    },
    "mtime": 1520898427000
  },
  "{\"filename\":\"/app/bot.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./dbUtil",
            "imported": [
              "getSortedList",
              "incrementCounter",
              "replaceCounter",
              "flipCreating",
              "addDB",
              "getDB",
              "changeReminder",
              "getProperty",
              "getList"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getSortedList",
                "local": "getSortedList"
              },
              {
                "kind": "named",
                "imported": "incrementCounter",
                "local": "incrementCounter"
              },
              {
                "kind": "named",
                "imported": "replaceCounter",
                "local": "replaceCounter"
              },
              {
                "kind": "named",
                "imported": "flipCreating",
                "local": "flipCreating"
              },
              {
                "kind": "named",
                "imported": "addDB",
                "local": "addDB"
              },
              {
                "kind": "named",
                "imported": "getDB",
                "local": "getDB"
              },
              {
                "kind": "named",
                "imported": "changeReminder",
                "local": "changeReminder"
              },
              {
                "kind": "named",
                "imported": "getProperty",
                "local": "getProperty"
              },
              {
                "kind": "named",
                "imported": "getList",
                "local": "getList"
              }
            ]
          },
          {
            "source": "./Util.js",
            "imported": [
              "nextReminder",
              "checkDate",
              "containsObject",
              "list",
              "getLocation"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "nextReminder",
                "local": "nextReminder"
              },
              {
                "kind": "named",
                "imported": "checkDate",
                "local": "checkDate"
              },
              {
                "kind": "named",
                "imported": "containsObject",
                "local": "containsObject"
              },
              {
                "kind": "named",
                "imported": "list",
                "local": "list"
              },
              {
                "kind": "named",
                "imported": "getLocation",
                "local": "getLocation"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/bot.js",
      "filenameRelative": "/app/bot.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "bot.js",
      "sourceFileName": "bot.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "bot"
    },
    "ignored": false,
    "code": "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\n\nvar _dbUtil = require('./dbUtil');\n\nvar _Util = require('./Util.js');\n\nvar ObjectId = require('mongodb').ObjectID;\nvar schedule = require('node-schedule');\nvar watson = require('watson-developer-cloud');\nvar mongodb = require(\"mongodb\");\nvar express = require('express');\nvar bodyParser = require('body-parser');\nvar request = require('request');\nvar path = require('path');\n\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nvar app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function (req, res) {\n  if (req.query['hub.mode'] === 'subscribe' && req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);\n  }\n});\n\n// Display the web page\napp.get('/', function (req, res) {\n  res.writeHead(200, { 'Content-Type': 'text/html' });\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {\n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function (entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function (event) {\n        callUserProfileAPI(event.sender.id, function (body) {\n          var userData = { userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone };\n          (0, _dbUtil.getDB)(\"User\", function (collection) {\n            if (!(0, _Util.containsObject)(event.sender.id, collection)) {\n              (0, _dbUtil.addDB)(\"User\", userData, event.sender.id);\n            }\n            if (event.message) {\n              receivedMessage(event);\n            } else if (event.postback) {\n              receivedPostback(event);\n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n\n  if (messageText) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageText);else {\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageAttachments);else getAttachment(senderID, messageAttachments[0].payload.url, messageAttachments[0].type, \"Attachment\");\n    });\n  }\n}\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n\n  //Do Something after users clicked Get Started button \n  if (event.postback.payload === \"GET_STARTED_PAYLOAD\") {\n    callUserProfileAPI(senderID, function (body) {\n      console.log(body);\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, userName);\n    });\n  } else {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"reminder\", function (reminder) {\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      //console.log(payload);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip if none\"\n        }\n      };\n      (0, _dbUtil.changeReminder)(senderID, reminder);\n      (0, _dbUtil.incrementCounter)(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: { 'text': messageText },\n    context: context\n  }, function (err, response) {\n    if (err) console.log('error:', err);else {\n\n      var messageData;\n      if (response.intents[0]) {\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n          case 'list':\n            (0, _Util.list)(senderID, function (str) {\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: str\n                }\n              });\n            });\n            break;\n          case 'next':\n            (0, _Util.nextReminder)(senderID, function (str) {\n              var options = { weekday: \"long\", year: \"numeric\", month: \"short\",\n                day: \"numeric\" };\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n                }\n              });\n            });\n            break;\n          case 'create':\n            respond = \"What do you want to remind about?\";\n            (0, _dbUtil.flipCreating)(true, senderID);\n            break;\n          case 'help':\n            sendHelpMessage(senderID);\n            break;\n          case 'delete':\n            (0, _dbUtil.getSortedList)(senderID, \"Reminder\", function (list) {\n              var index = Number(messageText.substr(messageText.length - 1, 1)) - 1;\n              if (index >= 0 && index < list.length) {\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({ \"_id\": ObjectId(id) }, function (err, doc) {\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n            break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            respond = \"Good bye!\";\n            break;\n          case 'who':\n            respond = \"My name is Bob\";\n            break;\n          default:\n            respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        };\n      } else {\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous', 'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington', 'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates', 'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous', 'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner', 'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random() * 6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        };\n      }\n      if (messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" + \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\\n\" + \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\nfunction getAttachment(senderID, url, fileType, message) {\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\" + url + \"&type=\" + fileType + \"&userid=\" + senderID;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function (error, response, body) {\n    console.log(\"DONE!\");\n  });\n}\n\nfunction countAttachment(senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"Attachments\");\n    collection.find({ \"userid\": senderID }).count(function (err, result) {\n      console.log(count);\n      var count = result;\n    });\n  });\n}\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });\n}\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if (cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\nfunction newReminder(senderID, messData) {\n  var respondText;\n  (0, _dbUtil.getProperty)(senderID, \"User\", \"counter\", function (counter) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"reminder\", function (reminder) {\n      (0, _dbUtil.getProperty)(senderID, \"User\", \"timezone\", function (timezone) {\n        console.log(counter);\n        if (counter == 0) {\n          reminder.userid = senderID;\n          reminder.content = messData;\n          (0, _dbUtil.incrementCounter)(senderID);\n          respondText = {\n            text: \"When? (mm/dd/yy-hh:mm)\"\n          };\n        } else if (counter == 1) {\n          var parts = messData;\n          reminder.date = new Date(20 + parts.substr(6, 2), Number(parts.substr(0, 2)) - 1, parts.substr(3, 2), Number(parts.substr(9, 2)), parts.substr(12, 2));\n          var text = (0, _Util.checkDate)(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") (0, _dbUtil.incrementCounter)(senderID);\n          respondText = {\n            text: text\n          };\n        } else if (counter == 2) {\n          if (messData !== \"Y\" && messData !== \"N\") {\n            respondText = {\n              text: \"Invalid character, type again (Y/N).\"\n            };\n          } else if (messData == \"N\") {\n            (0, _dbUtil.flipCreating)(false, senderID);\n            reminder.date.setHours(reminder.date.getHours() - timezone);\n            (0, _dbUtil.addDB)(\"Reminder\", reminder, senderID, function (doc) {\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function (x) {\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                    if (err) throw err;\n                    if (docs.length != 0) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };\n            (0, _dbUtil.replaceCounter)(0, senderID);\n            reminder = {};\n          } else {\n            respondText = {\n              text: \"What is the location? Type skip if none\"\n            };\n            (0, _dbUtil.incrementCounter)(senderID);\n          }\n        } else if (counter == 3) {\n          if (messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = (0, _Util.getLocation)(messData);\n            var long, lat;\n            var buttons = [];\n            for (var i = 0; i < Math.min(3, places.length); i++) {\n              var button = { type: \"postback\",\n                title: places[i]['name'],\n                payload: JSON.stringify(places[i]) };\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment: {\n                type: \"template\",\n                payload: {\n                  template_type: \"button\",\n                  text: \"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };\n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              \"message\": respondText\n\n            });\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          } else {\n            respondText = {\n              text: \"Attach any files. Type skip of none\"\n            };\n            (0, _dbUtil.incrementCounter)(senderID);\n          }\n\n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        } else if (counter == 4) {\n          console.log(reminder);\n          reminder.attachment = { url: \"\", type: \"\" };\n          if (messData[0].type) {\n            getAttachment(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = { url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type };\n          }\n\n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n            text: \"Finshed creating reminder.\"\n          };\n          (0, _dbUtil.flipCreating)(false, senderID);\n          (0, _dbUtil.replaceCounter)(0, senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours() - timezone);\n          (0, _dbUtil.addDB)(\"Reminder\", reminder, senderID, function (doc) {\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function (x) {\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err;\n                var collection = db.collection(\"Reminder\");\n                collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                  if (err) throw err;\n                  if (docs.length != 0) {\n                    if (reminder.attachment) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\": {\n                          \"attachment\": {\n                            \"type\": reminder.attachment.type,\n                            \"payload\": {\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      });\n                    }\n                    if (reminder.location) {\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\": {\n                            \"type\": \"template\",\n                            \"payload\": {\n                              \"template_type\": \"generic\",\n                              \"elements\": [{\n                                \"title\": location.name,\n                                \"image_url\": \"https://maps.googleapis.com/maps/api/staticmap?center=\" + location.latitude + \",\" + location.longitude + \"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\" + location.latitude + \",\" + location.longitude,\n                                \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                \"buttons\": [{\n                                  \"type\": \"web_url\",\n                                  \"url\": \"https://www.google.com/maps/place/\" + location.name + \"/@\" + location.latitude + \",\" + location.longitude,\n                                  \"title\": \"go to Google Map\"\n                                }]\n                              }]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    } else {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        (0, _dbUtil.changeReminder)(senderID, reminder);\n      });\n    });\n  });\n}\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvdC5qcyJdLCJuYW1lcyI6WyJPYmplY3RJZCIsInJlcXVpcmUiLCJPYmplY3RJRCIsInNjaGVkdWxlIiwid2F0c29uIiwibW9uZ29kYiIsImV4cHJlc3MiLCJib2R5UGFyc2VyIiwicmVxdWVzdCIsInBhdGgiLCJodHRwIiwiZnMiLCJtZXNzZW5nZXJCdXR0b24iLCJ1c2VyTmFtZSIsImNvbnZlcnNhdGlvbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJ2ZXJzaW9uIiwidmVyc2lvbl9kYXRlIiwiY29udGV4dCIsImFwcCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJNb25nb0NsaWVudCIsInVybDEiLCJnZXQiLCJyZXEiLCJyZXMiLCJxdWVyeSIsInByb2Nlc3MiLCJlbnYiLCJWRVJJRllfVE9LRU4iLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwic2VuZCIsImVycm9yIiwic2VuZFN0YXR1cyIsIndyaXRlSGVhZCIsIndyaXRlIiwiZW5kIiwicG9zdCIsImRhdGEiLCJib2R5Iiwib2JqZWN0IiwiZW50cnkiLCJmb3JFYWNoIiwicGFnZUlEIiwiaWQiLCJ0aW1lT2ZFdmVudCIsInRpbWUiLCJtZXNzYWdpbmciLCJldmVudCIsImNhbGxVc2VyUHJvZmlsZUFQSSIsInNlbmRlciIsInVzZXJEYXRhIiwidXNlcmlkIiwiY291bnRlciIsImtleXdvcmRzIiwiY3JlYXRpbmciLCJyZW1pbmRlciIsInRpbWV6b25lIiwiY29sbGVjdGlvbiIsIm1lc3NhZ2UiLCJyZWNlaXZlZE1lc3NhZ2UiLCJwb3N0YmFjayIsInJlY2VpdmVkUG9zdGJhY2siLCJzZW5kZXJJRCIsInJlY2lwaWVudElEIiwicmVjaXBpZW50IiwidGltZU9mTWVzc2FnZSIsInRpbWVzdGFtcCIsIm1lc3NhZ2VJZCIsIm1pZCIsIm1lc3NhZ2VUZXh0IiwidGV4dCIsIm1lc3NhZ2VBdHRhY2htZW50cyIsImF0dGFjaG1lbnRzIiwicCIsIm5ld1JlbWluZGVyIiwic2VuZFRleHRNZXNzYWdlIiwiZ2V0QXR0YWNobWVudCIsInBheWxvYWQiLCJ1cmwiLCJ0eXBlIiwidGltZU9mUG9zdGJhY2siLCJuYW1lIiwiZmlzdF9uYW1lIiwic2VuZFdlbGNvbWVNZXNzYWdlIiwibG9jYXRpb24iLCJKU09OIiwicGFyc2UiLCJtZXNzYWdlRGF0YSIsImNhbGxTZW5kQVBJIiwid29ya3NwYWNlX2lkIiwiaW5wdXQiLCJlcnIiLCJyZXNwb25zZSIsImludGVudHMiLCJjb21tYW5kIiwiaW50ZW50IiwicmVzcG9uZCIsInN0ciIsIm9wdGlvbnMiLCJ3ZWVrZGF5IiwieWVhciIsIm1vbnRoIiwiZGF5IiwiY29udGVudCIsImRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJzZW5kSGVscE1lc3NhZ2UiLCJsaXN0IiwiaW5kZXgiLCJOdW1iZXIiLCJzdWJzdHIiLCJsZW5ndGgiLCJfaWQiLCJjb25uZWN0IiwiZGIiLCJyZW1vdmUiLCJkb2MiLCJmdW5ueVF1b3RlcyIsImkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzZW5kZXJJZCIsImZpbGVUeXBlIiwicmVwbGFjZSIsInVybFJlcSIsInVyaSIsIm1ldGhvZCIsImNvdW50QXR0YWNobWVudCIsImZpbmQiLCJjb3VudCIsInJlc3VsdCIsInFzIiwiYWNjZXNzX3Rva2VuIiwiUEFHRV9BQ0NFU1NfVE9LRU4iLCJzdGF0dXNDb2RlIiwicmVjaXBpZW50SWQiLCJyZWNpcGllbnRfaWQiLCJtZXNzYWdlX2lkIiwiY2IiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwibWVzc0RhdGEiLCJyZXNwb25kVGV4dCIsInBhcnRzIiwiRGF0ZSIsInNldEhvdXJzIiwiZ2V0SG91cnMiLCJvcHMiLCJzY2hlZHVsZUpvYiIsIngiLCJ0b0FycmF5IiwiZG9jcyIsImNsb3NlIiwiYmluZCIsInBsYWNlcyIsImxvbmciLCJsYXQiLCJidXR0b25zIiwibWluIiwiYnV0dG9uIiwidGl0bGUiLCJzdHJpbmdpZnkiLCJwdXNoIiwiYXR0YWNobWVudCIsInRlbXBsYXRlX3R5cGUiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsInNlcnZlciIsImxpc3RlbiIsIlBPUlQiLCJhZGRyZXNzIiwicG9ydCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBU0E7O0FBRUE7O0FBVkEsSUFBTUEsV0FBV0MsUUFBUSxTQUFSLEVBQW1CQyxRQUFwQztBQUNBLElBQU1DLFdBQVdGLFFBQVEsZUFBUixDQUFqQjtBQUNBLElBQU1HLFNBQVNILFFBQVEsd0JBQVIsQ0FBZjtBQUNBLElBQU1JLFVBQVVKLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1LLFVBQVVMLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1NLGFBQWFOLFFBQVEsYUFBUixDQUFuQjtBQUNBLElBQU1PLFVBQVVQLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1RLE9BQU9SLFFBQVEsTUFBUixDQUFiOztBQUlBLElBQUlTLE9BQU9ULFFBQVEsT0FBUixDQUFYO0FBQ0EsSUFBSVUsS0FBS1YsUUFBUSxJQUFSLENBQVQ7O0FBRUEsSUFBSVcsa0JBQWtCLCtYQUF0QjtBQUNBO0FBQ0EsSUFBSUMsV0FBVyxNQUFmO0FBQ0E7QUFDQSxJQUFJQyxlQUFlVixPQUFPVSxZQUFQLENBQW9CO0FBQ3JDQyxZQUFVLHNDQUQyQjtBQUVyQ0MsWUFBVSxjQUYyQjtBQUdyQ0MsV0FBUyxJQUg0QjtBQUlyQ0MsZ0JBQWM7QUFKdUIsQ0FBcEIsQ0FBbkI7QUFNQSxJQUFJQyxVQUFVLEVBQWQ7QUFDQTtBQUNBLElBQUlDLE1BQU1kLFNBQVY7O0FBRUFjLElBQUlDLEdBQUosQ0FBUWQsV0FBV2UsSUFBWCxFQUFSO0FBQ0FGLElBQUlDLEdBQUosQ0FBUWQsV0FBV2dCLFVBQVgsQ0FBc0I7QUFDNUJDLFlBQVU7QUFEa0IsQ0FBdEIsQ0FBUjtBQUdBO0FBQ0EsSUFBSUMsY0FBY3BCLFFBQVFvQixXQUExQjtBQUNBLElBQUlDLE9BQU8sb0VBQVg7QUFDQTtBQUNBTixJQUFJTyxHQUFKLENBQVEsVUFBUixFQUFvQixVQUFTQyxHQUFULEVBQWND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QUFXakosUUFBUUMsR0FBUixDQUFZaUosSUFBWixJQUFvQixJQUEvQixFQUFxQyxZQUFZO0FBQzVEL0ksVUFBUUMsR0FBUixDQUFZLHNCQUFaLEVBQW9DNEksT0FBT0csT0FBUCxHQUFpQkMsSUFBckQ7QUFDRCxDQUZZLENBQWIiLCJmaWxlIjoiYm90LmpzIiwic291cmNlUm9vdCI6Ii9hcHAiLCJzb3VyY2VzQ29udGVudCI6WyIvL1xuLy8gVGhpcyBpcyBtYWluIGZpbGUgY29udGFpbmluZyBjb2RlIGltcGxlbWVudGluZyB0aGUgRXhwcmVzcyBzZXJ2ZXIgYW5kIGZ1bmN0aW9uYWxpdHkgZm9yIHRoZSBFeHByZXNzIGVjaG8gYm90LlxuLy9cbid1c2Ugc3RyaWN0JztcbmNvbnN0IE9iamVjdElkID0gcmVxdWlyZSgnbW9uZ29kYicpLk9iamVjdElEO1xuY29uc3Qgc2NoZWR1bGUgPSByZXF1aXJlKCdub2RlLXNjaGVkdWxlJyk7XG5jb25zdCB3YXRzb24gPSByZXF1aXJlKCd3YXRzb24tZGV2ZWxvcGVyLWNsb3VkJyk7XG5jb25zdCBtb25nb2RiID0gcmVxdWlyZShcIm1vbmdvZGJcIilcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcbmNvbnN0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0Jyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuaW1wb3J0IHtnZXRTb3J0ZWRMaXN0LCBpbmNyZW1lbnRDb3VudGVyLCByZXBsYWNlQ291bnRlciwgZmxpcENyZWF0aW5nLCBcbiAgICAgICAgYWRkREIsIGdldERCLCBjaGFuZ2VSZW1pbmRlciwgZ2V0UHJvcGVydHksIGdldExpc3R9IGZyb20gJy4vZGJVdGlsJztcbmltcG9ydCB7bmV4dFJlbWluZGVyLCBjaGVja0RhdGUsIGNvbnRhaW5zT2JqZWN0LCBsaXN0LCBnZXRMb2NhdGlvbn0gZnJvbSAnLi9VdGlsLmpzJztcbnZhciBodHRwID0gcmVxdWlyZSgnaHR0cHMnKTtcbnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbnZhciBtZXNzZW5nZXJCdXR0b24gPSBcIjxodG1sPjxoZWFkPjx0aXRsZT5GYWNlYm9vayBNZXNzZW5nZXIgQm90PC90aXRsZT48L2hlYWQ+PGJvZHk+PGgxPkZhY2Vib29rIE1lc3NlbmdlciBCb3Q8L2gxPlRoaXMgaXMgYSBib3QgYmFzZWQgb24gTWVzc2VuZ2VyIFBsYXRmb3JtIFF1aWNrU3RhcnQuIEZvciBtb3JlIGRldGFpbHMsIHNlZSB0aGVpciA8YSBocmVmPVxcXCJodHRwczovL2RldmVsb3BlcnMuZmFjZWJvb2suY29tL2RvY3MvbWVzc2VuZ2VyLXBsYXRmb3JtL2d1aWRlcy9xdWljay1zdGFydFxcXCI+ZG9jczwvYT4uPGZvb3RlciBpZD1cXFwiZ1dpZGdldFxcXCI+PC9mb290ZXI+PHNjcmlwdCBzcmM9XFxcImh0dHBzOi8vd2lkZ2V0LmdsaXRjaC5tZS93aWRnZXQubWluLmpzXFxcIj48L3NjcmlwdD48L2JvZHk+PC9odG1sPlwiO1xuLy9Vc2VyJ3MgZGF0YVxudmFyIHVzZXJOYW1lID0gXCJ0ZXN0XCI7XG4vLyBXYXRzb24gZGF0YVxudmFyIGNvbnZlcnNhdGlvbiA9IHdhdHNvbi5jb252ZXJzYXRpb24oe1xuICB1c2VybmFtZTogJ2ExNjJhY2I4LWQ1MTAtNGMxZS04ZTgxLWFhNTE0ZWUzYjc2OScsXG4gIHBhc3N3b3JkOiAna1dDNHhtZFdpUThaJyxcbiAgdmVyc2lvbjogJ3YxJyxcbiAgdmVyc2lvbl9kYXRlOiAnMjAxNy0wMi0wMydcbn0pO1xudmFyIGNvbnRleHQgPSB7fTtcbi8vIFRoZSByZXN0IG9mIHRoZSBjb2RlIGltcGxlbWVudHMgdGhlIHJvdXRlcyBmb3Igb3VyIEV4cHJlc3Mgc2VydmVyLlxubGV0IGFwcCA9IGV4cHJlc3MoKTtcblxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7XG4gIGV4dGVuZGVkOiB0cnVlXG59KSk7XG4vLyBkYXRhYmFzZSBjb25maWdcbnZhciBNb25nb0NsaWVudCA9IG1vbmdvZGIuTW9uZ29DbGllbnRcbnZhciB1cmwxID0gXCJtb25nb2RiOi8vdGllbmFuaDIwMDc6RGllbjEyMzRAZHMxNTcwNDAubWxhYi5jb206NTcwNDAvcmVtaW5kZXJib3RcIjtcbi8vIFdlYmhvb2sgdmFsaWRhdGlvblxuYXBwLmdldCgnL3dlYmhvb2snLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICBpZiAocmVxLnF1ZXJ5WydodWIubW9kZSddID09PSAnc3Vic2NyaWJlJyAmJlxuICAgICAgcmVxLnF1ZXJ5WydodWIudmVyaWZ5X3Rva2VuJ10gPT09IHByb2Nlc3MuZW52LlZFUklGWV9UT0tFTikge1xuICAgIGNvbnNvbGUubG9nKFwiVmFsaWRhdGluZyB3ZWJob29rXCIpO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlcS5xdWVyeVsnaHViLmNoYWxsZW5nZSddKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHZhbGlkYXRpb24uIE1ha2Ugc3VyZSB0aGUgdmFsaWRhdGlvbiB0b2tlbnMgbWF0Y2guXCIpO1xuICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7ICAgICAgICAgIFxuICB9XG59KTtcblxuLy8gRGlzcGxheSB0aGUgd2ViIHBhZ2VcbmFwcC5nZXQoJy8nLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICByZXMud3JpdGVIZWFkKDIwMCwgeydDb250ZW50LVR5cGUnOiAndGV4dC9odG1sJ30pO1xuICByZXMud3JpdGUobWVzc2VuZ2VyQnV0dG9uKTtcbiAgcmVzLmVuZCgpO1xufSk7XG5cbi8vIE1lc3NhZ2UgcHJvY2Vzc2luZ1xuYXBwLnBvc3QoJy93ZWJob29rJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHZhciBkYXRhID0gcmVxLmJvZHk7XG4gIGlmIChkYXRhLm9iamVjdCA9PT0gJ3BhZ2UnKSB7ICAgIFxuICAgIC8vIEl0ZXJhdGUgb3ZlciBlYWNoIGVudHJ5IC0gdGhlcmUgbWF5IGJlIG11bHRpcGxlIGlmIGJhdGNoZWRcbiAgICBkYXRhLmVudHJ5LmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgIHZhciBwYWdlSUQgPSBlbnRyeS5pZDtcbiAgICAgIHZhciB0aW1lT2ZFdmVudCA9IGVudHJ5LnRpbWU7XG4gICAgICAvLyBJdGVyYXRlIG92ZXIgZWFjaCBtZXNzYWdpbmcgZXZlbnRcbiAgICAgIGVudHJ5Lm1lc3NhZ2luZy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGNhbGxVc2VyUHJvZmlsZUFQSShldmVudC5zZW5kZXIuaWQsIGZ1bmN0aW9uKGJvZHkpe1xuICAgICAgICAgIHZhciB1c2VyRGF0YSA9IHt1c2VyaWQ6IGV2ZW50LnNlbmRlci5pZCwgY291bnRlcjogMCwga2V5d29yZHM6IFtdLCBjcmVhdGluZzogZmFsc2UsIHJlbWluZGVyOiB7fSwgdGltZXpvbmU6IGJvZHkudGltZXpvbmV9O1xuICAgICAgICAgIGdldERCKFwiVXNlclwiLCBmdW5jdGlvbihjb2xsZWN0aW9uKXtcbiAgICAgICAgICAgIGlmKCFjb250YWluc09iamVjdChldmVudC5zZW5kZXIuaWQsIGNvbGxlY3Rpb24pKXtcbiAgICAgICAgICAgICAgYWRkREIoXCJVc2VyXCIsIHVzZXJEYXRhLCBldmVudC5zZW5kZXIuaWQpOyAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlbnQubWVzc2FnZSkge1xuICAgICAgICAgICAgICByZWNlaXZlZE1lc3NhZ2UoZXZlbnQpOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQucG9zdGJhY2spIHtcbiAgICAgICAgICAgICAgcmVjZWl2ZWRQb3N0YmFjayhldmVudCk7IFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXZWJob29rIHJlY2VpdmVkIHVua25vd24gZXZlbnQ6IFwiLCBldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gQXNzdW1lIGFsbCB3ZW50IHdlbGwuXG4gICAgLy9cbiAgICAvLyBZb3UgbXVzdCBzZW5kIGJhY2sgYSAyMDAsIHdpdGhpbiAyMCBzZWNvbmRzLCB0byBsZXQgdXMga25vd1xuICAgIC8vIHlvdSd2ZSBzdWNjZXNzZnVsbHkgcmVjZWl2ZWQgdGhlIGNhbGxiYWNrLiBPdGhlcndpc2UsIHRoZSByZXF1ZXN0XG4gICAgLy8gd2lsbCB0aW1lIG91dCBhbmQgd2Ugd2lsbCBrZWVwIHRyeWluZyB0byByZXNlbmQuXG4gICAgcmVzLnNlbmRTdGF0dXMoMjAwKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIHJlY2VpdmVkTWVzc2FnZShldmVudCkge1xuICB2YXIgc2VuZGVySUQgPSBldmVudC5zZW5kZXIuaWQ7XG4gIHZhciByZWNpcGllbnRJRCA9IGV2ZW50LnJlY2lwaWVudC5pZDtcbiAgdmFyIHRpbWVPZk1lc3NhZ2UgPSBldmVudC50aW1lc3RhbXA7XG4gIHZhciBtZXNzYWdlID0gZXZlbnQubWVzc2FnZTtcblxuICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIG1lc3NhZ2UgZm9yIHVzZXIgJWQgYW5kIHBhZ2UgJWQgYXQgJWQgd2l0aCBtZXNzYWdlOlwiLCBcbiAgICBzZW5kZXJJRCwgcmVjaXBpZW50SUQsIHRpbWVPZk1lc3NhZ2UpO1xuXG4gIHZhciBtZXNzYWdlSWQgPSBtZXNzYWdlLm1pZDtcblxuICB2YXIgbWVzc2FnZVRleHQgPSBtZXNzYWdlLnRleHQ7XG4gIHZhciBtZXNzYWdlQXR0YWNobWVudHMgPSBtZXNzYWdlLmF0dGFjaG1lbnRzO1xuICBcbiAgaWYgKG1lc3NhZ2VUZXh0KSB7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcImNyZWF0aW5nXCIsIGZ1bmN0aW9uKHApe1xuICAgICAgaWYocCkgbmV3UmVtaW5kZXIoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KTtcbiAgICAgIGVsc2V7XG4gICAgICAgIHN3aXRjaCAobWVzc2FnZVRleHQpIHtcbiAgICAgICAgICAvL0Nhc2VzIHdoZXJlIHRoZSB0ZXh0IGRvZXNuJ3QgaGF2ZSB0byBnbyB0aHJvdWdoIEJsdWVNaXggQVBJIChOb3RoaW5nIHJpZ2h0IG5vdylcbiAgICAgICAgICAvLyBjYXNlICdnZW5lcmljJzpcbiAgICAgICAgICAvLyAgIHNlbmRHZW5lcmljTWVzc2FnZShzZW5kZXJJRCk7XG4gICAgICAgICAgLy8gICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgc2VuZFRleHRNZXNzYWdlKHNlbmRlcklELCBtZXNzYWdlVGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBpZiAobWVzc2FnZUF0dGFjaG1lbnRzKSB7XG4gICAgICBnZXRQcm9wZXJ0eShzZW5kZXJJRCwgXCJVc2VyXCIsIFwiY3JlYXRpbmdcIiwgZnVuY3Rpb24ocCl7XG4gICAgICAgIGlmKHApIG5ld1JlbWluZGVyKHNlbmRlcklELCBtZXNzYWdlQXR0YWNobWVudHMpO1xuICAgICAgICBlbHNlIGdldEF0dGFjaG1lbnQoc2VuZGVySUQsIG1lc3NhZ2VBdHRhY2htZW50c1swXS5wYXlsb2FkLnVybCwgbWVzc2FnZUF0dGFjaG1lbnRzWzBdLnR5cGUsXCJBdHRhY2htZW50XCIpO1xuICAgICAgfSkgICAgICBcbiAgfVxufVxuXG5mdW5jdGlvbiByZWNlaXZlZFBvc3RiYWNrKGV2ZW50KSB7XG4gIHZhciBzZW5kZXJJRCA9IGV2ZW50LnNlbmRlci5pZDtcbiAgdmFyIHJlY2lwaWVudElEID0gZXZlbnQucmVjaXBpZW50LmlkO1xuICB2YXIgdGltZU9mUG9zdGJhY2sgPSBldmVudC50aW1lc3RhbXA7XG5cbiAgLy8gVGhlICdwYXlsb2FkJyBwYXJhbSBpcyBhIGRldmVsb3Blci1kZWZpbmVkIGZpZWxkIHdoaWNoIGlzIHNldCBpbiBhIHBvc3RiYWNrIFxuICAvLyBidXR0b24gZm9yIFN0cnVjdHVyZWQgTWVzc2FnZXMuIFxuICB2YXIgcGF5bG9hZCA9IGV2ZW50LnBvc3RiYWNrLnBheWxvYWQ7XG5cbiAgY29uc29sZS5sb2coXCJSZWNlaXZlZCBwb3N0YmFjayBmb3IgdXNlciAlZCBhbmQgcGFnZSAlZCB3aXRoIHBheWxvYWQgJyVzJyBcIiArIFxuICAgIFwiYXQgJWRcIiwgc2VuZGVySUQsIHJlY2lwaWVudElELCBwYXlsb2FkLCB0aW1lT2ZQb3N0YmFjayk7XG5cbiAgLy8gV2hlbiBhIHBvc3RiYWNrIGlzIGNhbGxlZCwgd2UnbGwgc2VuZCBhIG1lc3NhZ2UgYmFjayB0byB0aGUgc2VuZGVyIHRvIFxuICAvLyBsZXQgdGhlbSBrbm93IGl0IHdhcyBzdWNjZXNzZnVsXG4gIFxuICAvL0RvIFNvbWV0aGluZyBhZnRlciB1c2VycyBjbGlja2VkIEdldCBTdGFydGVkIGJ1dHRvbiBcbiAgaWYoZXZlbnQucG9zdGJhY2sucGF5bG9hZCA9PT0gXCJHRVRfU1RBUlRFRF9QQVlMT0FEXCIpe1xuICAgIGNhbGxVc2VyUHJvZmlsZUFQSShzZW5kZXJJRCwgZnVuY3Rpb24oYm9keSl7XG4gICAgICBjb25zb2xlLmxvZyhib2R5KTtcbiAgICAgIHZhciBuYW1lID0gYm9keS5maXN0X25hbWUgKyBcIiBcIiArIGJvZHkuZmlzdF9uYW1lO1xuICAgICAgc2VuZFdlbGNvbWVNZXNzYWdlKHNlbmRlcklELCB1c2VyTmFtZSk7XG4gICAgfSlcbiAgICBcbiAgfVxuICBlbHNle1xuICAgIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJyZW1pbmRlclwiLCBmdW5jdGlvbihyZW1pbmRlcil7XG4gICAgICBjb25zb2xlLmxvZyhyZW1pbmRlcik7XG4gICAgICByZW1pbmRlci5sb2NhdGlvbiA9IHBheWxvYWQ7XG4gICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocGF5bG9hZCk7XG4gICAgICAvL2NvbnNvbGUubG9nKHBheWxvYWQpO1xuICAgICAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgIHRleHQ6IFwiQXR0YWNoIGFueSBmaWxlcy4gVHlwZSBza2lwIGlmIG5vbmVcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY2hhbmdlUmVtaW5kZXIoc2VuZGVySUQsIHJlbWluZGVyKTtcbiAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgIH0pO1xuICB9XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBTZW5kaW5nIGhlbHBlcnNcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5mdW5jdGlvbiBzZW5kVGV4dE1lc3NhZ2Uoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KSB7XG4gIGNvbnZlcnNhdGlvbi5tZXNzYWdlKHtcbiAgICB3b3Jrc3BhY2VfaWQ6ICcxZTc1NzNmNS05MzlkLTQ3ZTMtODY5MC01ZWYxYzA5NDZiNjMnLFxuICAgIGlucHV0OiB7J3RleHQnOiBtZXNzYWdlVGV4dH0sXG4gICAgY29udGV4dDogY29udGV4dFxuICB9LCAgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuICAgIGlmIChlcnIpXG4gICAgICBjb25zb2xlLmxvZygnZXJyb3I6JywgZXJyKTtcbiAgICBlbHNle1xuICAgICAgXG4gICAgICB2YXIgbWVzc2FnZURhdGE7XG4gICAgICBpZihyZXNwb25zZS5pbnRlbnRzWzBdKXtcbiAgICAgICAgdmFyIGNvbW1hbmQgPSByZXNwb25zZS5pbnRlbnRzWzBdLmludGVudDtcbiAgICAgICAgdmFyIHJlc3BvbmQgPSBcIlwiO1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgY2FzZSAnbGlzdCc6XG4gICAgICAgICAgbGlzdChzZW5kZXJJRCwgZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBzdHJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICduZXh0JzpcbiAgICAgICAgICBuZXh0UmVtaW5kZXIoc2VuZGVySUQsIGZ1bmN0aW9uKHN0cil7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHsgd2Vla2RheTogXCJsb25nXCIsIHllYXI6IFwibnVtZXJpY1wiLCBtb250aDogXCJzaG9ydFwiLCAgXG4gICAgICAgICAgICAgIGRheTogXCJudW1lcmljXCIgfTsgIFxuICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgc3RyLmNvbnRlbnQgKyBcIiBhZnRlciBcIiArIHN0ci5kYXRlLnRvTG9jYWxlVGltZVN0cmluZyhcImVuLVVTXCIsIG9wdGlvbnMpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICByZXNwb25kID0gXCJXaGF0IGRvIHlvdSB3YW50IHRvIHJlbWluZCBhYm91dD9cIjtcbiAgICAgICAgICBmbGlwQ3JlYXRpbmcodHJ1ZSwgc2VuZGVySUQpO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaGVscCc6ICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgIHNlbmRIZWxwTWVzc2FnZShzZW5kZXJJRCk7ICAgICAgICAgIFxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgIGdldFNvcnRlZExpc3Qoc2VuZGVySUQsIFwiUmVtaW5kZXJcIiwgZnVuY3Rpb24obGlzdCl7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IE51bWJlcihtZXNzYWdlVGV4dC5zdWJzdHIobWVzc2FnZVRleHQubGVuZ3RoLTEsIDEpKS0xO1xuICAgICAgICAgICAgICBpZihpbmRleCA+PSAwICYmIGluZGV4IDwgbGlzdC5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxpc3RbaW5kZXhdLl9pZDtcbiAgICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlJlbWluZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGlkKX0sIGZ1bmN0aW9uKGVyciwgZG9jKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcImRlbGV0ZWQgXCIgKyBsaXN0W2luZGV4XS5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnaGknOlxuICAgICAgICAgICAgcmVzcG9uZCA9IFwiSGVsbG9cIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RoeCc6XG4gICAgICAgICAgICByZXNwb25kID0gXCJZb3UncmUgd2VsY29tZVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnYnllJzpcbiAgICAgICAgICAgIHJlc3BvbmQgPSBcIkdvb2QgYnllIVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnd2hvJzpcbiAgICAgICAgICAgIHJlc3BvbmQgPSBcIk15IG5hbWUgaXMgQm9iXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXNwb25kID0gY29tbWFuZDtcbiAgICAgICAgfTtcbiAgICAgICAgbWVzc2FnZURhdGEgPSB7XG4gICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgIHRleHQ6IHJlc3BvbmRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIHZhciBmdW5ueVF1b3RlcyA9IFsnXCJIb3cgZG8geW91IGdldCBhIHN3ZWV0IGxpdHRsZSA4MC15ZWFyLW9sZCBsYWR5IHRvIHNheSB0aGUgRiB3b3JkPyBHZXQgYW5vdGhlciBzd2VldCBsaXR0bGUgODAteWVhci1vbGQgbGFkeSB0byB5ZWxsIFwiQklOR08hXCIgLSBBbm9ueW1vdXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnS25vd2xlZGdlIGlzIGtub3dpbmcgYSB0b21hdG8gaXMgYSBmcnVpdDsgd2lzZG9tIGlzIG5vdCBwdXR0aW5nIGl0IGluIGEgZnJ1aXQgc2FsYWQuIC0gTWlsZXMgS2luZ3RvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdCeSBhbGwgbWVhbnMsIG1hcnJ5LiBJZiB5b3UgZ2V0IGEgZ29vZCB3aWZlLCB5b3XigJlsbCBiZWNvbWUgaGFwcHk7IGlmIHlvdSBnZXQgYSBiYWQgb25lLCB5b3XigJlsbCBiZWNvbWUgYSBwaGlsb3NvcGhlci4gLSBTb2NyYXRlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdUaGUgYmVzdCB3YXkgdG8gbGllIGlzIHRvIHRlbGwgdGhlIHRydXRoIC4gLiAuIGNhcmVmdWxseSBlZGl0ZWQgdHJ1dGguIC0gQW5vbnltb3VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lmIHlvdSBzdGVhbCBmcm9tIG9uZSBhdXRob3IsIGl04oCZcyBwbGFnaWFyaXNtOyBpZiB5b3Ugc3RlYWwgZnJvbSBtYW55LCBpdOKAmXMgcmVzZWFyY2guIC0gV2lsc29uIE1pem5lcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdJZiBldm9sdXRpb24gcmVhbGx5IHdvcmtzLCBob3cgY29tZSBtb3RoZXJzIG9ubHkgaGF2ZSB0d28gaGFuZHM/IC0gTWlsdG9uIEJlcmxlJ107XG4gICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjYpO1xuICAgICAgICBtZXNzYWdlRGF0YSA9IHtcbiAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdGV4dDogZnVubnlRdW90ZXNbaV0gKyBcIlxcblNvcnJ5IGZvciBub3QgdW5kZXJzdGFuZGluZyB5b3UuIEJ1dCBhYm92ZSBpcyBhIGZ1bm55IHF1b3RlXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKG1lc3NhZ2VEYXRhLm1lc3NhZ2UudGV4dCkgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNlbmRXZWxjb21lTWVzc2FnZShzZW5kZXJJZCwgbmFtZSkge1xuICB2YXIgbWVzc2FnZURhdGEgPSB7XG4gICAgcmVjaXBpZW50OiB7XG4gICAgICBpZDogc2VuZGVySWRcbiAgICB9LFxuICAgIG1lc3NhZ2U6IHtcbiAgICAgIHRleHQ6IFwiV2VsY29tZSBhYm9hcmQgXCIgKyBuYW1lICsgXCIhIE15IG5hbWUgaXMgQm9iLiBSaWdodCBub3cgSSdtIGdvbm5hIHdhbGsgeW91IHRocm91Z2ggdGhlIGJhc2ljIHN0ZXBzLlxcblwiICtcbiAgICAgIFwiVG8gdGFsayB0byBtZSwgeW91IGRvbid0IGhhdmUgdG8gc2F5IGV4YWN0IGNvbW1hbmRzIGV2ZXJ5dGltZS4gRm9yIGV4YW1wbGU6XFxuXCIgKyBcbiAgICAgIFwiLSBTZXQgdXAgbmV3IHJlbWluZGVyczogJ0kgd2FudCB0byBtYWtlL2NyZWF0ZS9oYXZlIG5ldyByZW1pbmRlcidcXG5cIiArIFxuICAgICAgXCItIFJldHJpZXZlIHRoZSBuZXh0IHJlbWluZGVyOiAnSSB3YW50IHRvIHNlZSB0aGUgbmV4dC91cGNvbWluZy9mb2xsb3dpbmcgcmVtaW5kZXInXFxuXCIgKyBcbiAgICAgIFwiLSBSZXRyaWV2ZSB0aGUgbGlzdCBvZiByZW1pbmRlcnM6ICdJIHdhbnQgdG8gbGlzdC9zaG93L2dldCBhbGwgcmVtaW5kZXJzJ1xcbmFuZCBtYW55IG1vcmUuLi5cIlxuICAgIH1cbiAgfTtcblxuICBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSk7XG59XG5cbi8vU2VuZCB0aGUgbWVzc2FnZSB3aGVuIHRoZSB1c2VyIHVzZSAnaGVscCcgY29tbWFuZFxuZnVuY3Rpb24gc2VuZEhlbHBNZXNzYWdlKHNlbmRlcklkKSB7XG4gIHZhciBtZXNzYWdlRGF0YSA9IHtcbiAgICByZWNpcGllbnQ6IHtcbiAgICAgIGlkOiBzZW5kZXJJZFxuICAgIH0sXG4gICAgbWVzc2FnZToge1xuICAgICAgdGV4dDogXCItIFNldCB1cCBuZXcgcmVtaW5kZXJzOiAnSSB3YW50IHRvIG1ha2UvY3JlYXRlL2hhdmUgbmV3IHJlbWluZGVyJ1xcblwiICsgXG4gICAgICBcIi0gUmV0cmlldmUgdGhlIG5leHQgcmVtaW5kZXI6ICdJIHdhbnQgdG8gc2VlIHRoZSBuZXh0L3VwY29taW5nL2ZvbGxvd2luZyByZW1pbmRlcidcXG5cIiArIFxuICAgICAgXCItIFJldHJpZXZlIHRoZSBsaXN0IG9mIHJlbWluZGVyczogJ0kgd2FudCB0byBsaXN0L3Nob3cvZ2V0IGFsbCByZW1pbmRlcnMnXFxuXCIgKyBcbiAgICAgIFwiLSBEZWxldGUgYSByZW1pbmRlcjogJ0kgd2FudCB0byByZW1vdmUvZGVsZXRlL2Rlc3Ryb3knIFtpbmRleF0gKGluZGV4IGlzIHRoZSBpbmRleCBudW1iZXIgb2YgdGhlIHJlbWluZGVyIGluIHRoZSBsaXN0IG9mIHJlbWluZGVycylcXG5cIiArXG4gICAgICBcIi0gSGVscDogJ2hlbHAvaW5zdHJ1Y3Rpb24vY29tbWFuZCdcIlxuICAgIH1cbiAgfTtcblxuICBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSk7XG59XG5cblxuZnVuY3Rpb24gZ2V0QXR0YWNobWVudChzZW5kZXJJRCwgdXJsLCBmaWxlVHlwZSwgbWVzc2FnZSl7XG4gIHVybCA9IHVybC5yZXBsYWNlKC8mL2csICclMjYnKTtcbiAgdmFyIHVybFJlcSA9IFwiaHR0cHM6Ly9wcm9qZWN0MS1taW5odHJpMTI5Ni5jOXVzZXJzLmlvL3Rlc3Q/dXJsPVwiK3VybCtcIiZ0eXBlPVwiK2ZpbGVUeXBlK1wiJnVzZXJpZD1cIitzZW5kZXJJRDtcbiAgY29uc29sZS5sb2codXJsUmVxKTtcbiAgcmVxdWVzdCh7XG4gICAgdXJpOiB1cmxSZXEsXG4gICAgbWV0aG9kOiAnR0VUJ1xuICB9LCBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UsIGJvZHkpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRE9ORSFcIik7XG4gIH0pXG59XG5cbmZ1bmN0aW9uIGNvdW50QXR0YWNobWVudChzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJBdHRhY2htZW50c1wiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe1widXNlcmlkXCI6IHNlbmRlcklEfSkuY291bnQoZnVuY3Rpb24oZXJyLCByZXN1bHQpe1xuICAgICAgY29uc29sZS5sb2coY291bnQpO1xuICAgICAgdmFyIGNvdW50ID0gcmVzdWx0O1xuICAgIH0pO1xuICB9KVxufVxuXG5mdW5jdGlvbiBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSkge1xuICByZXF1ZXN0KHtcbiAgICB1cmk6ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92Mi42L21lL21lc3NhZ2VzJyxcbiAgICBxczogeyBhY2Nlc3NfdG9rZW46IHByb2Nlc3MuZW52LlBBR0VfQUNDRVNTX1RPS0VOIH0sXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAganNvbjogbWVzc2FnZURhdGFcblxuICB9LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgaWYgKCFlcnJvciAmJiByZXNwb25zZS5zdGF0dXNDb2RlID09IDIwMCkge1xuICAgICAgdmFyIHJlY2lwaWVudElkID0gYm9keS5yZWNpcGllbnRfaWQ7XG4gICAgICB2YXIgbWVzc2FnZUlkID0gYm9keS5tZXNzYWdlX2lkO1xuXG4gICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHNlbnQgZ2VuZXJpYyBtZXNzYWdlIHdpdGggaWQgJXMgdG8gcmVjaXBpZW50ICVzXCIsIG1lc3NhZ2VJZCwgcmVjaXBpZW50SWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICBjb25zb2xlLmVycm9yKHJlc3BvbnNlKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfSk7ICBcbn1cblxuXG4vL0dldCB0aGUgVXNlciBQcm9maWxlIEFQSVxuZnVuY3Rpb24gY2FsbFVzZXJQcm9maWxlQVBJKHNlbmRlcklELCBjYil7XG4gIHJlcXVlc3Qoe1xuICAgIHVyaTogJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YyLjYvJyArIHNlbmRlcklEICsgJz9maWVsZHM9Zmlyc3RfbmFtZSxsYXN0X25hbWUsdGltZXpvbmUmYWNjZXNzX3Rva2VuPScgKyBwcm9jZXNzLmVudi5QQUdFX0FDQ0VTU19UT0tFTixcbiAgICBtZXRob2Q6ICdHRVQnXG4gIH0sIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSwgYm9keSkge1xuICAgIGlmICghZXJyb3IgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9PSAyMDApIHtcbiAgICAgIGJvZHkgPSBKU09OLnBhcnNlKGJvZHkpO1xuICAgICAgdXNlck5hbWUgPSBib2R5LmZpcnN0X25hbWUgKyBcIiBcIiArIGJvZHkubGFzdF9uYW1lO1xuICAgICAgY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCB0aGUgbmFtZSBcIiArIGJvZHkuZmlyc3RfbmFtZSArIFwiIFwiICsgYm9keS5sYXN0X25hbWUpO1xuICAgICAgaWYoY2IpIGNiKGJvZHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICAvL2NvbnNvbGUuZXJyb3IocmVzcG9uc2UpO1xuICAgICAgLy9jb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuXG5cbmZ1bmN0aW9uIG5ld1JlbWluZGVyKHNlbmRlcklELCBtZXNzRGF0YSl7XG4gIHZhciByZXNwb25kVGV4dDtcbiAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcImNvdW50ZXJcIiwgZnVuY3Rpb24oY291bnRlcil7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcInJlbWluZGVyXCIsIGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJ0aW1lem9uZVwiLCBmdW5jdGlvbih0aW1lem9uZSl7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvdW50ZXIpO1xuICAgICAgICBpZiAoY291bnRlciA9PSAwKXtcbiAgICAgICAgICByZW1pbmRlci51c2VyaWQgPSBzZW5kZXJJRDtcbiAgICAgICAgICByZW1pbmRlci5jb250ZW50ID0gbWVzc0RhdGE7XG4gICAgICAgICAgaW5jcmVtZW50Q291bnRlcihzZW5kZXJJRCk7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiV2hlbj8gKG1tL2RkL3l5LWhoOm1tKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvdW50ZXIgPT0gMSl7XG4gICAgICAgICAgdmFyIHBhcnRzID0gIG1lc3NEYXRhO1xuICAgICAgICAgIHJlbWluZGVyLmRhdGUgPSBuZXcgRGF0ZSgyMCtwYXJ0cy5zdWJzdHIoNiwyKSxOdW1iZXIocGFydHMuc3Vic3RyKDAsMikpLTEscGFydHMuc3Vic3RyKDMsMiksIE51bWJlcihwYXJ0cy5zdWJzdHIoOSwyKSkscGFydHMuc3Vic3RyKDEyLDIpKTtcbiAgICAgICAgICB2YXIgdGV4dCA9IGNoZWNrRGF0ZShyZW1pbmRlci5kYXRlLCBwYXJ0cywgdGltZXpvbmUpO1xuICAgICAgICAgIGlmICh0ZXh0ID09IFwiRG8geW91IHdhbnQgYWRkIG1vcmUgaW5mb3JtYXRpb24/IChZIGZvciB5ZXMsIE4gZm9yIE5vKVwiKSBpbmNyZW1lbnRDb3VudGVyKHNlbmRlcklEKTtcbiAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGNvdW50ZXIgPT0gMil7XG4gICAgICAgICAgaWYobWVzc0RhdGEgIT09IFwiWVwiICYmIG1lc3NEYXRhICE9PSBcIk5cIil7XG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJJbnZhbGlkIGNoYXJhY3RlciwgdHlwZSBhZ2FpbiAoWS9OKS5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihtZXNzRGF0YSA9PSBcIk5cIil7XG4gICAgICAgICAgICBmbGlwQ3JlYXRpbmcoZmFsc2UsIHNlbmRlcklEKTtcbiAgICAgICAgICAgIHJlbWluZGVyLmRhdGUuc2V0SG91cnMocmVtaW5kZXIuZGF0ZS5nZXRIb3VycygpLXRpbWV6b25lKTtcbiAgICAgICAgICAgIGFkZERCKFwiUmVtaW5kZXJcIiwgcmVtaW5kZXIsIHNlbmRlcklELCBmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICB2YXIgZG9jID0gZG9jLm9wc1swXTtcbiAgICAgICAgICAgICAgc2NoZWR1bGUuc2NoZWR1bGVKb2IoZG9jLmRhdGUsIGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiUmVtaW5kZXJcIik7XG4gICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmZpbmQoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgICAgaWYoZG9jcy5sZW5ndGggIT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJIZXJlIGlzIHNvbWV0aGluZyB5b3UgbmVlZCB0byBkbzogXCIgKyB4LmNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnJlbW92ZSh7XCJfaWRcIjogT2JqZWN0SWQoZG9jLl9pZCl9KTtcbiAgICAgICAgICAgICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfS5iaW5kKG51bGwsIGRvYykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgdGV4dDogXCJFdmVudCBhZGRlZCBzdWNjZXNzZnVsbHkhXCJcbiAgICAgICAgICAgIH07ICAgICAgICAgICAgXG4gICAgICAgICAgICByZXBsYWNlQ291bnRlcigwICxzZW5kZXJJRCk7XG4gICAgICAgICAgICByZW1pbmRlciA9IHt9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiV2hhdCBpcyB0aGUgbG9jYXRpb24/IFR5cGUgc2tpcCBpZiBub25lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07ICBcbiAgICAgICAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGNvdW50ZXIgPT0gMyl7XG4gICAgICAgICAgaWYobWVzc0RhdGEgIT0gXCJza2lwXCIpIHtcbiAgICAgICAgICAgIC8vcmVtaW5kZXIubG9jYXRpb24gPSBtZXNzYWdlVGV4dDtcbiAgICAgICAgICAgIHZhciBwbGFjZXMgPSBnZXRMb2NhdGlvbihtZXNzRGF0YSk7XG4gICAgICAgICAgICB2YXIgbG9uZywgbGF0O1xuICAgICAgICAgICAgdmFyIGJ1dHRvbnMgPSBbXTtcbiAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpPE1hdGgubWluKDMsIHBsYWNlcy5sZW5ndGgpOyBpKyspe1xuICAgICAgICAgICAgICB2YXIgYnV0dG9uID0ge3R5cGU6XCJwb3N0YmFja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOnBsYWNlc1tpXVsnbmFtZSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KHBsYWNlc1tpXSl9XG4gICAgICAgICAgICAgIGJ1dHRvbnMucHVzaChidXR0b24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgYXR0YWNobWVudDp7XG4gICAgICAgICAgICAgICAgdHlwZTpcInRlbXBsYXRlXCIsXG4gICAgICAgICAgICAgICAgcGF5bG9hZDp7XG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV90eXBlOlwiYnV0dG9uXCIsXG4gICAgICAgICAgICAgICAgICB0ZXh0OlwiQ2hvb3NlIGEgbG9jYXRpb246IFwiLFxuICAgICAgICAgICAgICAgICAgYnV0dG9uczogYnV0dG9uc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTsgIFxuICAgICAgICAgICAgLy9yZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyA9IGJ1dHRvbnM7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGJ1dHRvbnMpO1xuICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjpyZXNwb25kVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHR5cGVvZiByZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25kVGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiQXR0YWNoIGFueSBmaWxlcy4gVHlwZSBza2lwIG9mIG5vbmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTsgIFxuICAgICAgICAgICAgaW5jcmVtZW50Q291bnRlcihzZW5kZXJJRCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIFxuICAgICAgICAgIC8vcmVzcG9uZFRleHQgPSBcIkF0dGFjaCBhbnkgZmlsZXMuIFR5cGUgc2tpcCBvZiBub25lXCI7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvdW50ZXIgPT0gNCl7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVtaW5kZXIpO1xuICAgICAgICAgIHJlbWluZGVyLmF0dGFjaG1lbnQgPSB7dXJsOiBcIlwiLCB0eXBlOiBcIlwifVxuICAgICAgICAgIGlmIChtZXNzRGF0YVswXS50eXBlKXtcbiAgICAgICAgICAgIGdldEF0dGFjaG1lbnQoc2VuZGVySUQsIG1lc3NEYXRhWzBdLnBheWxvYWQudXJsLCBtZXNzRGF0YVswXS50eXBlLCBcIkF0dGFjaG1lbnRcIik7XG4gICAgICAgICAgICAvL0xhdGVyIHdpbGwgY2hlY2sgZm9yIHRvdGFsIGVsZW1lbnQgaW4gZGF0YWJhc2UgZmlsZXNcbiAgICAgICAgICAgIHJlbWluZGVyLmF0dGFjaG1lbnQgPSB7dXJsOiBcImh0dHBzOi8vcHJldmlldy5jOXVzZXJzLmlvL21pbmh0cmkxMjk2L3Byb2plY3QxL2ZpbGUtdXBsb2FkL3Rlc3QucG5nXCIsIHR5cGU6IG1lc3NEYXRhWzBdLnR5cGV9O1xuICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgLy9hZGREQihcIlJlbWluZGVyXCIsIHJlbWluZGVyLCBzZW5kZXJJRCk7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiRmluc2hlZCBjcmVhdGluZyByZW1pbmRlci5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTsgICAgICAgICAgICBcbiAgICAgICAgICBmbGlwQ3JlYXRpbmcoZmFsc2UsIHNlbmRlcklEKTtcbiAgICAgICAgICByZXBsYWNlQ291bnRlcigwLHNlbmRlcklEKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1Y2Nlc3MhXCIpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlbWluZGVyKTtcbiAgICAgICAgICByZW1pbmRlci5kYXRlLnNldEhvdXJzKHJlbWluZGVyLmRhdGUuZ2V0SG91cnMoKS10aW1lem9uZSk7XG4gICAgICAgICAgYWRkREIoXCJSZW1pbmRlclwiLCByZW1pbmRlciwgc2VuZGVySUQsIGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICB2YXIgZG9jID0gZG9jLm9wc1swXTtcbiAgICAgICAgICAgIHNjaGVkdWxlLnNjaGVkdWxlSm9iKHJlbWluZGVyLmRhdGUsIGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiUmVtaW5kZXJcIik7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5maW5kKHtcIl9pZFwiOiBPYmplY3RJZChkb2MuX2lkKX0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKXtcbiAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgICAgICAgICAgICAgICAgaWYoZG9jcy5sZW5ndGggIT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1pbmRlci5hdHRhY2htZW50KXsgIFxuICAgICAgICAgICAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXR0YWNobWVudFwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogcmVtaW5kZXIuYXR0YWNobWVudC50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGF5bG9hZFwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IHJlbWluZGVyLmF0dGFjaG1lbnQudXJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlbWluZGVyLmxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBKU09OLnBhcnNlKHJlbWluZGVyLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhdHRhY2htZW50XCI6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOlwidGVtcGxhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBheWxvYWRcIjp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRlbXBsYXRlX3R5cGVcIjpcImdlbmVyaWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZWxlbWVudHNcIjpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBsb2NhdGlvbi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImltYWdlX3VybFwiOlwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3N0YXRpY21hcD9jZW50ZXI9XCIrbG9jYXRpb24ubGF0aXR1ZGUrXCIsXCIrbG9jYXRpb24ubG9uZ2l0dWRlK1wiJnpvb209MTUmc2l6ZT02MDB4MzAwJm1hcHR5cGU9cm9hZG1hcCZtYXJrZXJzPWNvbG9yOnJlZHxcIitsb2NhdGlvbi5sYXRpdHVkZStcIixcIitsb2NhdGlvbi5sb25naXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJ0aXRsZVwiOiBcIkhlcmUgaXMgc29tZXRoaW5nIHlvdSBuZWVkIHRvIGRvIGF0IHRoaXMgbG9jYXRpb246IFxcXCJcIiArIHJlbWluZGVyLmNvbnRlbnQgKyBcIlxcXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJ1dHRvbnNcIjpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOlwid2ViX3VybFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOlwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3BsYWNlL1wiK2xvY2F0aW9uLm5hbWUrXCIvQFwiK2xvY2F0aW9uLmxhdGl0dWRlK1wiLFwiK2xvY2F0aW9uLmxvbmdpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOlwiZ28gdG8gR29vZ2xlIE1hcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgcmVtaW5kZXIuY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucmVtb3ZlKHtcIl9pZFwiOiBPYmplY3RJZChkb2MuX2lkKX0pO1xuICAgICAgICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LmJpbmQobnVsbCwgZG9jKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXNzYWdlOiByZXNwb25kVGV4dFxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhcInRlc3RcIik7XG4gICAgICAgIGNhbGxTZW5kQVBJKG1lc3NhZ2VEYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coY291bnRlcik7XG4gICAgICAgIGNoYW5nZVJlbWluZGVyKHNlbmRlcklELCByZW1pbmRlcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG5cblxuLy8gU2V0IEV4cHJlc3MgdG8gbGlzdGVuIG91dCBmb3IgSFRUUCByZXF1ZXN0c1xudmFyIHNlcnZlciA9IGFwcC5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnNvbGUubG9nKFwiTGlzdGVuaW5nIG9uIHBvcnQgJXNcIiwgc2VydmVyLmFkZHJlc3MoKS5wb3J0KTtcbn0pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "bot.js"
      ],
      "names": [
        "ObjectId",
        "require",
        "ObjectID",
        "schedule",
        "watson",
        "mongodb",
        "express",
        "bodyParser",
        "request",
        "path",
        "http",
        "fs",
        "messengerButton",
        "userName",
        "conversation",
        "username",
        "password",
        "version",
        "version_date",
        "context",
        "app",
        "use",
        "json",
        "urlencoded",
        "extended",
        "MongoClient",
        "url1",
        "get",
        "req",
        "res",
        "query",
        "process",
        "env",
        "VERIFY_TOKEN",
        "console",
        "log",
        "status",
        "send",
        "error",
        "sendStatus",
        "writeHead",
        "write",
        "end",
        "post",
        "data",
        "body",
        "object",
        "entry",
        "forEach",
        "pageID",
        "id",
        "timeOfEvent",
        "time",
        "messaging",
        "event",
        "callUserProfileAPI",
        "sender",
        "userData",
        "userid",
        "counter",
        "keywords",
        "creating",
        "reminder",
        "timezone",
        "collection",
        "message",
        "receivedMessage",
        "postback",
        "receivedPostback",
        "senderID",
        "recipientID",
        "recipient",
        "timeOfMessage",
        "timestamp",
        "messageId",
        "mid",
        "messageText",
        "text",
        "messageAttachments",
        "attachments",
        "p",
        "newReminder",
        "sendTextMessage",
        "getAttachment",
        "payload",
        "url",
        "type",
        "timeOfPostback",
        "name",
        "fist_name",
        "sendWelcomeMessage",
        "location",
        "JSON",
        "parse",
        "messageData",
        "callSendAPI",
        "workspace_id",
        "input",
        "err",
        "response",
        "intents",
        "command",
        "intent",
        "respond",
        "str",
        "options",
        "weekday",
        "year",
        "month",
        "day",
        "content",
        "date",
        "toLocaleTimeString",
        "sendHelpMessage",
        "list",
        "index",
        "Number",
        "substr",
        "length",
        "_id",
        "connect",
        "db",
        "remove",
        "doc",
        "funnyQuotes",
        "i",
        "Math",
        "floor",
        "random",
        "senderId",
        "fileType",
        "replace",
        "urlReq",
        "uri",
        "method",
        "countAttachment",
        "find",
        "count",
        "result",
        "qs",
        "access_token",
        "PAGE_ACCESS_TOKEN",
        "statusCode",
        "recipientId",
        "recipient_id",
        "message_id",
        "cb",
        "first_name",
        "last_name",
        "messData",
        "respondText",
        "parts",
        "Date",
        "setHours",
        "getHours",
        "ops",
        "scheduleJob",
        "x",
        "toArray",
        "docs",
        "close",
        "bind",
        "places",
        "long",
        "lat",
        "buttons",
        "min",
        "button",
        "title",
        "stringify",
        "push",
        "attachment",
        "template_type",
        "latitude",
        "longitude",
        "server",
        "listen",
        "PORT",
        "address",
        "port"
      ],
      "mappings": "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",
      "file": "bot.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\nconst ObjectId = require('mongodb').ObjectID;\nconst schedule = require('node-schedule');\nconst watson = require('watson-developer-cloud');\nconst mongodb = require(\"mongodb\")\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst request = require('request');\nconst path = require('path');\nimport {getSortedList, incrementCounter, replaceCounter, flipCreating, \n        addDB, getDB, changeReminder, getProperty, getList} from './dbUtil';\nimport {nextReminder, checkDate, containsObject, list, getLocation} from './Util.js';\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nlet app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function(req, res) {\n  if (req.query['hub.mode'] === 'subscribe' &&\n      req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);          \n  }\n});\n\n// Display the web page\napp.get('/', function(req, res) {\n  res.writeHead(200, {'Content-Type': 'text/html'});\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {    \n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function(entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function(event) {\n        callUserProfileAPI(event.sender.id, function(body){\n          var userData = {userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone};\n          getDB(\"User\", function(collection){\n            if(!containsObject(event.sender.id, collection)){\n              addDB(\"User\", userData, event.sender.id);              \n            }\n            if (event.message) {\n              receivedMessage(event); \n            } else if (event.postback) {\n              receivedPostback(event); \n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n        \n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", \n    senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n  \n  if (messageText) {\n    getProperty(senderID, \"User\", \"creating\", function(p){\n      if(p) newReminder(senderID, messageText);\n      else{\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n      getProperty(senderID, \"User\", \"creating\", function(p){\n        if(p) newReminder(senderID, messageAttachments);\n        else getAttachment(senderID, messageAttachments[0].payload.url, messageAttachments[0].type,\"Attachment\");\n      })      \n  }\n}\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \n    \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n  \n  //Do Something after users clicked Get Started button \n  if(event.postback.payload === \"GET_STARTED_PAYLOAD\"){\n    callUserProfileAPI(senderID, function(body){\n      console.log(body);\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, userName);\n    })\n    \n  }\n  else{\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      //console.log(payload);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip if none\"\n        }\n      };\n      changeReminder(senderID, reminder);\n      incrementCounter(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: {'text': messageText},\n    context: context\n  },  function(err, response) {\n    if (err)\n      console.log('error:', err);\n    else{\n      \n      var messageData;\n      if(response.intents[0]){\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n        case 'list':\n          list(senderID, function(str){\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: str\n              }\n            });\n          });\n        break;\n        case 'next':\n          nextReminder(senderID, function(str){\n            var options = { weekday: \"long\", year: \"numeric\", month: \"short\",  \n              day: \"numeric\" };  \n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n              }\n            });\n          });\n        break;\n        case 'create':\n          respond = \"What do you want to remind about?\";\n          flipCreating(true, senderID);\n        break;\n        case 'help':                      \n          sendHelpMessage(senderID);          \n        break;\n        case 'delete':\n            getSortedList(senderID, \"Reminder\", function(list){\n              var index = Number(messageText.substr(messageText.length-1, 1))-1;\n              if(index >= 0 && index < list.length){\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({\"_id\": ObjectId(id)}, function(err, doc){\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n        break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            respond = \"Good bye!\";\n            break;\n          case 'who':\n            respond = \"My name is Bob\";\n            break;\n        default:\n          respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        }\n      }\n      else{\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous',\n                          'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington',\n                          'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates',\n                          'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous',\n                          'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner',\n                          'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random()*6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        }\n      }\n      if(messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" +\n      \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \n      \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \n      \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\\n\" +\n      \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n\nfunction getAttachment(senderID, url, fileType, message){\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\"+url+\"&type=\"+fileType+\"&userid=\"+senderID;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function(error, response, body) {\n      console.log(\"DONE!\");\n  })\n}\n\nfunction countAttachment(senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"Attachments\");\n    collection.find({\"userid\": senderID}).count(function(err, result){\n      console.log(count);\n      var count = result;\n    });\n  })\n}\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });  \n}\n\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb){\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function(error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if(cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\n\nfunction newReminder(senderID, messData){\n  var respondText;\n  getProperty(senderID, \"User\", \"counter\", function(counter){\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      getProperty(senderID, \"User\", \"timezone\", function(timezone){\n        console.log(counter);\n        if (counter == 0){\n          reminder.userid = senderID;\n          reminder.content = messData;\n          incrementCounter(senderID);\n          respondText = {\n                          text: \"When? (mm/dd/yy-hh:mm)\"\n                        };\n        }\n        else if (counter == 1){\n          var parts =  messData;\n          reminder.date = new Date(20+parts.substr(6,2),Number(parts.substr(0,2))-1,parts.substr(3,2), Number(parts.substr(9,2)),parts.substr(12,2));\n          var text = checkDate(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") incrementCounter(senderID);\n          respondText = {\n                          text: text\n                        };\n        }\n        else if(counter == 2){\n          if(messData !== \"Y\" && messData !== \"N\"){\n            respondText = {\n                          text: \"Invalid character, type again (Y/N).\"\n                        };\n          }\n          else if(messData == \"N\"){\n            flipCreating(false, senderID);\n            reminder.date.setHours(reminder.date.getHours()-timezone);\n            addDB(\"Reminder\", reminder, senderID, function(doc){\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function(x){\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                    if (err) throw err\n                    if(docs.length != 0){\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };            \n            replaceCounter(0 ,senderID);\n            reminder = {};\n          }\n          else{\n            respondText = {\n                          text: \"What is the location? Type skip if none\"\n                        };  \n            incrementCounter(senderID);\n          }\n        }\n        else if(counter == 3){\n          if(messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = getLocation(messData);\n            var long, lat;\n            var buttons = [];\n            for(var i=0; i<Math.min(3, places.length); i++){\n              var button = {type:\"postback\",\n                            title:places[i]['name'],\n                            payload: JSON.stringify(places[i])}\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment:{\n                type:\"template\",\n                payload:{\n                  template_type:\"button\",\n                  text:\"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };  \n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      \"message\":respondText\n                        \n          })\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          }\n          else{\n          respondText = {\n                          text: \"Attach any files. Type skip of none\"\n                        };  \n            incrementCounter(senderID);\n          }\n          \n          \n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        }\n        else if (counter == 4){\n          console.log(reminder);\n          reminder.attachment = {url: \"\", type: \"\"}\n          if (messData[0].type){\n            getAttachment(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = {url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type};\n          }\n                    \n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n                          text: \"Finshed creating reminder.\"\n                        };            \n          flipCreating(false, senderID);\n          replaceCounter(0,senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours()-timezone);\n          addDB(\"Reminder\", reminder, senderID, function(doc){\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function(x){\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err\n                var collection = db.collection(\"Reminder\");\n                collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                  if (err) throw err\n                  if(docs.length != 0){\n                    if (reminder.attachment){  \n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\":{\n                          \"attachment\":{\n                            \"type\": reminder.attachment.type,\n                            \"payload\":{\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      })\n                    }                    \n                    if(reminder.location){\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\":{\n                            \"type\":\"template\",\n                            \"payload\":{\n                              \"template_type\":\"generic\",\n                              \"elements\":[\n                                 {\n                                  \"title\": location.name,\n                                   \"image_url\":\"https://maps.googleapis.com/maps/api/staticmap?center=\"+location.latitude+\",\"+location.longitude+\"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\"+location.latitude+\",\"+location.longitude,\n                                  \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                  \"buttons\":[\n                                    {\n                                      \"type\":\"web_url\",\n                                      \"url\":\"https://www.google.com/maps/place/\"+location.name+\"/@\"+location.latitude+\",\"+location.longitude,\n                                      \"title\":\"go to Google Map\"\n                                    }\n                                  ]      \n                                }\n                              ]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                    else{\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        changeReminder(senderID, reminder);\n      });\n    });\n  });\n}\n\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n"
      ]
    },
    "mtime": 1520898426000
  },
  "{\"filename\":\"/app/dbUtil.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/dbUtil.js",
      "filenameRelative": "/app/dbUtil.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "dbUtil.js",
      "sourceFileName": "dbUtil.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "dbUtil"
    },
    "ignored": false,
    "code": "\"use strict\";\n\nvar mongodb = require(\"mongodb\");\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function (senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }, { \"sort\": [\"date\"] }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n};\nexports.incrementCounter = function (senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $inc: { \"counter\": 1 } });\n  });\n};\nexports.replaceCounter = function (value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"counter\": value } });\n  });\n};\nexports.flipCreating = function (value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"creating\": value } });\n  });\n};\n//Function for database (#database)\nexports.addDB = function (name, object, senderID, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.insert(object, function (err, docs) {\n      if (err) console.log(err);\n      if (cb) cb(docs);\n      db.close();\n    });\n  });\n};\nexports.getDB = function (name, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.find({}, { _id: 0 }).toArray(function (err, docs) {\n      db.close();\n      cb(docs);\n    });\n  });\n};\nexports.changeReminder = function (senderID, value) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"reminder\": value } });\n  });\n};\nexports.getProperty = function (senderID, collectionName, property, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.findOne({ \"userid\": senderID }, function (err, ret) {\n      cb(ret[property]);\n    });\n  });\n};\nexports.getList = function (senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiVXRpbC5qcyJdLCJuYW1lcyI6WyJtb25nb2RiIiwicmVxdWlyZSIsIk1vbmdvQ2xpZW50IiwidXJsMSIsImV4cG9ydHMiLCJnZXRTb3J0ZWRMaXN0Iiwic2VuZGVySUQiLCJjb2xsZWN0aW9uTmFtZSIsImNiIiwiY29ubmVjdCIsImVyciIsImRiIiwiY29sbGVjdGlvbiIsImZpbmQiLCJ0b0FycmF5IiwiZG9jcyIsImluY3JlbWVudENvdW50ZXIiLCJmaW5kT25lQW5kVXBkYXRlIiwiJGluYyIsInJlcGxhY2VDb3VudGVyIiwidmFsdWUiLCIkc2V0IiwiZmxpcENyZWF0aW5nIiwiYWRkREIiLCJuYW1lIiwib2JqZWN0IiwiaW5zZXJ0IiwiY29uc29sZSIsImxvZyIsImNsb3NlIiwiZ2V0REIiLCJfaWQiLCJjaGFuZ2VSZW1pbmRlciIsImdldFByb3BlcnR5IiwicHJvcGVydHkiLCJmaW5kT25lIiwicmV0IiwiZ2V0TGlzdCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxVQUFVQyxRQUFRLFNBQVIsQ0FBaEI7QUFDQSxJQUFJQyxjQUFjRixRQUFRRSxXQUExQjtBQUNBLElBQUlDLE9BQU8sb0VBQVg7QUFDQUMsUUFBUUMsYUFBUixHQUF3QixVQUFTQyxRQUFULEVBQW1CQyxjQUFuQixFQUFtQ0MsRUFBbkMsRUFBc0M7QUFDNUROLGNBQVlPLE9BQVosQ0FBb0JOLElBQXBCLEVBQTBCLFVBQVVPLEdBQVYsRUFBZUMsRUFBZixFQUFtQjtBQUMzQyxRQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULFFBQUlFLGFBQWFELEdBQUdDLFVBQUgsQ0FBY0wsY0FBZCxDQUFqQjtBQUNBSyxlQUFXQyxJQUFYLENBQWdCLEVBQUMsVUFBVVAsUUFBWCxFQUFoQixFQUFzQyxFQUFDLFFBQU8sQ0FBQyxNQUFELENBQVIsRUFBdEMsRUFBeURRLE9BQXpELENBQWlFLFVBQVNKLEdBQVQsRUFBY0ssSUFBZCxFQUFtQjtBQUNsRlAsU0FBR08sSUFBSDtBQUNELEtBRkQ7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RFAsU0FBR08sSUFBSDtBQUNELEtBRkQ7QUFHRCxHQU5EO0FBT0QsQ0FSRCIsImZpbGUiOiJkYlV0aWwuanMiLCJzb3VyY2VSb290IjoiL2FwcCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvZGIgPSByZXF1aXJlKFwibW9uZ29kYlwiKVxudmFyIE1vbmdvQ2xpZW50ID0gbW9uZ29kYi5Nb25nb0NsaWVudFxudmFyIHVybDEgPSBcIm1vbmdvZGI6Ly90aWVuYW5oMjAwNzpEaWVuMTIzNEBkczE1NzA0MC5tbGFiLmNvbTo1NzA0MC9yZW1pbmRlcmJvdFwiO1xuZXhwb3J0cy5nZXRTb3J0ZWRMaXN0ID0gZnVuY3Rpb24oc2VuZGVySUQsIGNvbGxlY3Rpb25OYW1lLCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZCh7XCJ1c2VyaWRcIjogc2VuZGVySUR9LCB7XCJzb3J0XCI6W1wiZGF0ZVwiXX0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKXtcbiAgICAgIGNiKGRvY3MpO1xuICAgIH0pO1xuICB9KVxufVxuZXhwb3J0cy5pbmNyZW1lbnRDb3VudGVyID0gZnVuY3Rpb24oc2VuZGVySUQpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskaW5jOntcImNvdW50ZXJcIjoxfX0pO1xuICB9KVxufVxuZXhwb3J0cy5yZXBsYWNlQ291bnRlciA9IGZ1bmN0aW9uKHZhbHVlLCBzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJVc2VyXCIpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZSh7XCJ1c2VyaWRcIjpzZW5kZXJJRH0seyRzZXQ6e1wiY291bnRlclwiIDogdmFsdWV9fSk7XG4gIH0pXG59XG5leHBvcnRzLmZsaXBDcmVhdGluZyA9IGZ1bmN0aW9uKHZhbHVlLCBzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJVc2VyXCIpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZSh7XCJ1c2VyaWRcIjpzZW5kZXJJRH0seyRzZXQ6e1wiY3JlYXRpbmdcIiA6IHZhbHVlfX0pO1xuICB9KVxufVxuLy9GdW5jdGlvbiBmb3IgZGF0YWJhc2UgKCNkYXRhYmFzZSlcbmV4cG9ydHMuYWRkREIgPSBmdW5jdGlvbihuYW1lLCBvYmplY3QsIHNlbmRlcklELCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24obmFtZSk7XG4gICAgY29sbGVjdGlvbi5pbnNlcnQob2JqZWN0LCBmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgaWYoZXJyKSBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgaWYoY2IpIGNiKGRvY3MpO1xuICAgICAgZGIuY2xvc2UoKTtcbiAgICB9KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0REIgPSBmdW5jdGlvbihuYW1lLCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24obmFtZSk7XG4gICAgY29sbGVjdGlvbi5maW5kKHt9LHtfaWQ6MH0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKSB7XG4gICAgICBkYi5jbG9zZSgpO1xuICAgICAgY2IoZG9jcyk7XG4gICAgfSlcbiAgfSlcbn1cbmV4cG9ydHMuY2hhbmdlUmVtaW5kZXIgPSBmdW5jdGlvbihzZW5kZXJJRCwgdmFsdWUpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskc2V0OntcInJlbWluZGVyXCIgOiB2YWx1ZX19KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0UHJvcGVydHkgPSBmdW5jdGlvbihzZW5kZXJJRCwgY29sbGVjdGlvbk5hbWUsIHByb3BlcnR5LCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZSh7XCJ1c2VyaWRcIjogc2VuZGVySUR9LCBmdW5jdGlvbihlcnIsIHJldCl7XG4gICAgICBjYihyZXRbcHJvcGVydHldKTtcbiAgICB9KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0TGlzdCA9IGZ1bmN0aW9uKHNlbmRlcklELCBjb2xsZWN0aW9uTmFtZSwgY2Ipe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe1widXNlcmlkXCI6IHNlbmRlcklEfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgY2IoZG9jcyk7XG4gICAgfSk7XG4gIH0pXG59Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "dbUtil.js"
      ],
      "names": [
        "mongodb",
        "require",
        "MongoClient",
        "url1",
        "exports",
        "getSortedList",
        "senderID",
        "collectionName",
        "cb",
        "connect",
        "err",
        "db",
        "collection",
        "find",
        "toArray",
        "docs",
        "incrementCounter",
        "findOneAndUpdate",
        "$inc",
        "replaceCounter",
        "value",
        "$set",
        "flipCreating",
        "addDB",
        "name",
        "object",
        "insert",
        "console",
        "log",
        "close",
        "getDB",
        "_id",
        "changeReminder",
        "getProperty",
        "property",
        "findOne",
        "ret",
        "getList"
      ],
      "mappings": ";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAIC,cAAcF,QAAQE,WAA1B;AACA,IAAIC,OAAO,oEAAX;AACAC,QAAQC,aAAR,GAAwB,UAASC,QAAT,EAAmBC,cAAnB,EAAmCC,EAAnC,EAAsC;AAC5DN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcL,cAAd,CAAjB;AACAK,eAAWC,IAAX,CAAgB,EAAC,UAAUP,QAAX,EAAhB,EAAsC,EAAC,QAAO,CAAC,MAAD,CAAR,EAAtC,EAAyDQ,OAAzD,CAAiE,UAASJ,GAAT,EAAcK,IAAd,EAAmB;AAClFP,SAAGO,IAAH;AACD,KAFD;AAGD,GAND;AAOD,CARD;AASAX,QAAQY,gBAAR,GAA2B,UAASV,QAAT,EAAkB;AAC3CJ,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAc,MAAd,CAAjB;AACAA,eAAWK,gBAAX,CAA4B,EAAC,UAASX,QAAV,EAA5B,EAAgD,EAACY,MAAK,EAAC,WAAU,CAAX,EAAN,EAAhD;AACD,GAJD;AAKD,CAND;AAOAd,QAAQe,cAAR,GAAyB,UAASC,KAAT,EAAgBd,QAAhB,EAAyB;AAChDJ,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAc,MAAd,CAAjB;AACAA,eAAWK,gBAAX,CAA4B,EAAC,UAASX,QAAV,EAA5B,EAAgD,EAACe,MAAK,EAAC,WAAYD,KAAb,EAAN,EAAhD;AACD,GAJD;AAKD,CAND;AAOAhB,QAAQkB,YAAR,GAAuB,UAASF,KAAT,EAAgBd,QAAhB,EAAyB;AAC9CJ,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAc,MAAd,CAAjB;AACAA,eAAWK,gBAAX,CAA4B,EAAC,UAASX,QAAV,EAA5B,EAAgD,EAACe,MAAK,EAAC,YAAaD,KAAd,EAAN,EAAhD;AACD,GAJD;AAKD,CAND;AAOA;AACAhB,QAAQmB,KAAR,GAAgB,UAASC,IAAT,EAAeC,MAAf,EAAuBnB,QAAvB,EAAiCE,EAAjC,EAAoC;AAClDN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcY,IAAd,CAAjB;AACAZ,eAAWc,MAAX,CAAkBD,MAAlB,EAA0B,UAASf,GAAT,EAAcK,IAAd,EAAmB;AAC3C,UAAGL,GAAH,EAAQiB,QAAQC,GAAR,CAAYlB,GAAZ;AACR,UAAGF,EAAH,EAAOA,GAAGO,IAAH;AACPJ,SAAGkB,KAAH;AACD,KAJD;AAKD,GARD;AASD,CAVD;AAWAzB,QAAQ0B,KAAR,GAAgB,UAASN,IAAT,EAAehB,EAAf,EAAkB;AAChCN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcY,IAAd,CAAjB;AACAZ,eAAWC,IAAX,CAAgB,EAAhB,EAAmB,EAACkB,KAAI,CAAL,EAAnB,EAA4BjB,OAA5B,CAAoC,UAASJ,GAAT,EAAcK,IAAd,EAAoB;AACtDJ,SAAGkB,KAAH;AACArB,SAAGO,IAAH;AACD,KAHD;AAID,GAPD;AAQD,CATD;AAUAX,QAAQ4B,cAAR,GAAyB,UAAS1B,QAAT,EAAmBc,KAAnB,EAAyB;AAChDlB,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAc,MAAd,CAAjB;AACAA,eAAWK,gBAAX,CAA4B,EAAC,UAASX,QAAV,EAA5B,EAAgD,EAACe,MAAK,EAAC,YAAaD,KAAd,EAAN,EAAhD;AACD,GAJD;AAKD,CAND;AAOAhB,QAAQ6B,WAAR,GAAsB,UAAS3B,QAAT,EAAmBC,cAAnB,EAAmC2B,QAAnC,EAA6C1B,EAA7C,EAAgD;AACpEN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcL,cAAd,CAAjB;AACAK,eAAWuB,OAAX,CAAmB,EAAC,UAAU7B,QAAX,EAAnB,EAAyC,UAASI,GAAT,EAAc0B,GAAd,EAAkB;AACzD5B,SAAG4B,IAAIF,QAAJ,CAAH;AACD,KAFD;AAGD,GAND;AAOD,CARD;AASA9B,QAAQiC,OAAR,GAAkB,UAAS/B,QAAT,EAAmBC,cAAnB,EAAmCC,EAAnC,EAAsC;AACtDN,cAAYO,OAAZ,CAAoBN,IAApB,EAA0B,UAAUO,GAAV,EAAeC,EAAf,EAAmB;AAC3C,QAAID,GAAJ,EAAS,MAAMA,GAAN;AACT,QAAIE,aAAaD,GAAGC,UAAH,CAAcL,cAAd,CAAjB;AACAK,eAAWC,IAAX,CAAgB,EAAC,UAAUP,QAAX,EAAhB,EAAsCQ,OAAtC,CAA8C,UAASJ,GAAT,EAAcK,IAAd,EAAmB;AAC/DP,SAAGO,IAAH;AACD,KAFD;AAGD,GAND;AAOD,CARD",
      "file": "dbUtil.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "const mongodb = require(\"mongodb\")\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}, {\"sort\":[\"date\"]}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}\nexports.incrementCounter = function(senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$inc:{\"counter\":1}});\n  })\n}\nexports.replaceCounter = function(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"counter\" : value}});\n  })\n}\nexports.flipCreating = function(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"creating\" : value}});\n  })\n}\n//Function for database (#database)\nexports.addDB = function(name, object, senderID, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.insert(object, function(err, docs){\n      if(err) console.log(err);\n      if(cb) cb(docs);\n      db.close();\n    });\n  })\n}\nexports.getDB = function(name, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.find({},{_id:0}).toArray(function(err, docs) {\n      db.close();\n      cb(docs);\n    })\n  })\n}\nexports.changeReminder = function(senderID, value){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"reminder\" : value}});\n  })\n}\nexports.getProperty = function(senderID, collectionName, property, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.findOne({\"userid\": senderID}, function(err, ret){\n      cb(ret[property]);\n    });\n  })\n}\nexports.getList = function(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}"
      ]
    },
    "mtime": 1520898427000
  },
  "{\"filename\":\"/app/Util.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.24.1": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./dbUtil",
            "imported": [
              "getList",
              "getProperty",
              "getSortedList"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getList",
                "local": "getList"
              },
              {
                "kind": "named",
                "imported": "getProperty",
                "local": "getProperty"
              },
              {
                "kind": "named",
                "imported": "getSortedList",
                "local": "getSortedList"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/Util.js",
      "filenameRelative": "/app/Util.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "Util.js",
      "sourceFileName": "Util.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "Util"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _dbUtil = require('./dbUtil');\n\nvar sRequest = require('sync-request');\nexports.nextReminder = function (senderID, cb) {\n  (0, _dbUtil.getList)(senderID, \"Reminder\", function (list) {\n    if (list[0]) {\n      cb(list[0]);\n    } else cb(\"No Reminder\");\n  });\n};\nexports.list = function (senderID, cb) {\n  (0, _dbUtil.getProperty)(senderID, \"User\", \"timezone\", function (timezone) {\n    (0, _dbUtil.getSortedList)(senderID, \"Reminder\", function (list) {\n      var i = 1;\n      var str = \"\";\n      list.forEach(function (reminder) {\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours() + timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\") + \"\\n\";\n        i++;\n      });\n      if (!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n};\nexports.containsObject = function (id, list) {\n  var i;\n  for (i = 0; i < list.length; i++) {\n    if (list[i].userid == id) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexports.checkDate = function (testDate, parts, timezone) {\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours() - timezone);\n  var year = Number(20 + parts.substr(6, 2));\n  var month = Number(parts.substr(0, 2)) - 1;\n  var date = Number(parts.substr(3, 2));\n  var hour = Number(parts.substr(9, 2));\n  var minute = Number(parts.substr(12, 2));\n  if (curDate.getTime() > testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours() + timezone);\n  if (year != testDate.getFullYear() || month != testDate.getMonth() || date != testDate.getDate() || hour != testDate.getHours() || minute != testDate.getMinutes()) {\n    return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n};\nexports.getLocation = function (location) {\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n    timeout: 10000\n  });\n  var data = JSON.parse(res.getBody('utf8'));\n\n  for (var i = 0; i < data.results.length; i++) {\n    var place = { \"name\": data.results[i][\"formatted_address\"],\n      \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n      \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n    };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }\n  return places;\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWwuanMiXSwibmFtZXMiOlsic1JlcXVlc3QiLCJyZXF1aXJlIiwiZXhwb3J0cyIsIm5leHRSZW1pbmRlciIsInNlbmRlcklEIiwiY2IiLCJsaXN0IiwidGltZXpvbmUiLCJpIiwic3RyIiwiZm9yRWFjaCIsInJlbWluZGVyIiwiZGF5IiwiZGF0ZSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwiaG91ciIsImdldEhvdXJzIiwibWludXRlIiwiZ2V0TWludXRlcyIsImNvbnRlbnQiLCJsb2NhdGlvbiIsInVuZGVmaW5lZCIsIkpTT04iLCJwYXJzZSIsIm5hbWUiLCJjb250YWluc09iamVjdCIsImlkIiwibGVuZ3RoIiwidXNlcmlkIiwiY2hlY2tEYXRlIiwidGVzdERhdGUiLCJwYXJ0cyIsImN1ckRhdGUiLCJEYXRlIiwic2V0SG91cnMiLCJOdW1iZXIiLCJzdWJzdHIiLCJnZXRUaW1lIiwiZ2V0TG9jYXRpb24iLCJwbGFjZXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0FQSV9LRVkiLCJyZXMiLCJ0aW1lb3V0IiwiZGF0YSIsImdldEJvZHkiLCJyZXN1bHRzIiwicGxhY2UiLCJwdXNoIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBLElBQU1BLFdBQVdDLFFBQVEsY0FBUixDQUFqQjtBQUNBQyxRQUFRQyxZQUFSLEdBQXVCLFVBQVNDLFFBQVQsRUFBbUJDLEVBQW5CLEVBQXNCO0FBQzNDLHVCQUFRRCxRQUFSLEVBQWtCLFVBQWxCLEVBQThCLFVBQVNFLElBQVQsRUFBYztBQUMxQyxRQUFHQSxLQUFLLENBQUwsQ0FBSCxFQUFXO0FBQ1RELFNBQUdDLEtBQUssQ0FBTCxDQUFIO0FBQ0QsS0FGRCxNQUdLRCxHQUFHLGFBQUg7QUFDTixHQUxEO0FBTUQsQ0FQRDtBQVFBSCxRQUFRSSxJQUFSLEdBQWUsVUFBU0YsUUFBVCxFQUFtQkMsRUFBbkIsRUFBc0I7QUFDbkMsMkJBQVlELFFBQVosRUFBc0Is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M0gsRUFBaUo7QUFDakosV0FBTyx5Q0FBUDtBQUNDO0FBQ0QsU0FBTyx5REFBUDtBQUNELENBZEQ7QUFlQXBCLFFBQVF3QyxXQUFSLEdBQXNCLFVBQVNsQixRQUFULEVBQWtCO0FBQ3RDLE1BQUltQixTQUFTLEVBQWI7QUFDQSxNQUFJQyxNQUFNLHNFQUFzRXBCLFFBQXRFLEdBQWlGLE9BQWpGLEdBQTJGcUIsUUFBUUMsR0FBUixDQUFZQyxjQUFqSDtBQUNBLE1BQUlDLE1BQU1oRCxTQUFTLEtBQVQsRUFBZ0I0QyxHQUFoQixFQUFxQjtBQUNyQkssYUFBUztBQURZLEdBQXJCLENBQVY7QUFHQSxNQUFJQyxPQUFReEIsS0FBS0MsS0FBTCxDQUFXcUIsSUFBSUcsT0FBSixDQUFZLE1BQVosQ0FBWCxDQUFaOztBQUVBLE9BQUssSUFBSTNDLElBQUksQ0FBYixFQUFnQkEsSUFBSTBDLEtBQUtFLE9BQUwsQ0FBYXJCLE1BQWpDLEVBQXlDdkIsR0FBekMsRUFBNkM7QUFDM0MsUUFBSTZDLFFBQVEsRUFBQyxRQUFRSCxLQUFLRSxPQUFMLENBQWE1QyxDQUFiLEVBQWdCLG1CQUFoQixDQUFUO0FBQ0Esa0JBQVkwQyxLQUFLRSxPQUFMLENBQWE1QyxDQUFiLEVBQWdCLFVBQWhCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQXhDLENBRFo7QUFFQSxtQkFBYTBDLEtBQUtFLE9BQUwsQ0FBYTVDLENBQWIsRUFBZ0IsVUFBaEIsRUFBNEIsVUFBNUIsRUFBd0MsS0FBeEM7QUFGYixLQUFaO0FBSUE7QUFDQW1DLFdBQU9XLElBQVAsQ0FBWUQsS0FBWjtBQUNBO0FBQ0Q7QUFDRCxTQUFPVixNQUFQO0FBQ0QsQ0FsQkQiLCJmaWxlIjoiVXRpbC5qcyIsInNvdXJjZVJvb3QiOiIvYXBwIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtnZXRMaXN0LCBnZXRQcm9wZXJ0eSwgZ2V0U29ydGVkTGlzdH0gZnJvbSAnLi9kYlV0aWwnO1xuY29uc3Qgc1JlcXVlc3QgPSByZXF1aXJlKCdzeW5jLXJlcXVlc3QnKTtcbmV4cG9ydHMubmV4dFJlbWluZGVyID0gZnVuY3Rpb24oc2VuZGVySUQsIGNiKXtcbiAgZ2V0TGlzdChzZW5kZXJJRCwgXCJSZW1pbmRlclwiLCBmdW5jdGlvbihsaXN0KXtcbiAgICBpZihsaXN0WzBdKXtcbiAgICAgIGNiKGxpc3RbMF0pO1xuICAgIH0gXG4gICAgZWxzZSBjYihcIk5vIFJlbWluZGVyXCIpO1xuICB9KTtcbn1cbmV4cG9ydHMubGlzdCA9IGZ1bmN0aW9uKHNlbmRlcklELCBjYil7XG4gIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJ0aW1lem9uZVwiLCBmdW5jdGlvbih0aW1lem9uZSl7XG4gICAgZ2V0U29ydGVkTGlzdChzZW5kZXJJRCwgXCJSZW1pbmRlclwiLCBmdW5jdGlvbihsaXN0KXtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgICAgdmFyIGRheSA9IHJlbWluZGVyLmRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICB2YXIgbW9udGggPSByZW1pbmRlci5kYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgICAgICB2YXIgeWVhciA9IHJlbWluZGVyLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgdmFyIGhvdXIgPSByZW1pbmRlci5kYXRlLmdldEhvdXJzKCkrdGltZXpvbmU7XG4gICAgICAgIHZhciBtaW51dGUgPSByZW1pbmRlci5kYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgc3RyICs9IGkgKyBcIi4gQ29udGVudDogXCIgKyByZW1pbmRlci5jb250ZW50ICsgXCJcXG4gICBEYXRlOiBcIiArIG1vbnRoICsgXCIvXCIgKyBkYXkgKyBcIi9cIiArIHllYXIgXG4gICAgICAgICAgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZSArIFwiXFxuICAgTG9jYXRpb246IFwiICsgKHJlbWluZGVyLmxvY2F0aW9uICE9PSB1bmRlZmluZWQgPyBKU09OLnBhcnNlKHJlbWluZGVyLmxvY2F0aW9uKS5uYW1lIDogXCJub25lXCIpKyBcIlxcblwiO1xuICAgICAgICBpKys7XG4gICAgICB9KTtcbiAgICAgIGlmKCFzdHIpIHN0ciA9IFwiTm8gcmVtaW5kZXJzXCI7XG4gICAgICBjYihzdHIpO1xuICAgIH0pO1xuICB9KTtcbn1cbmV4cG9ydHMuY29udGFpbnNPYmplY3QgPSBmdW5jdGlvbihpZCwgbGlzdCkge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChsaXN0W2ldLnVzZXJpZCA9PSBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cblxuZXhwb3J0cy5jaGVja0RhdGUgPSBmdW5jdGlvbih0ZXN0RGF0ZSwgcGFydHMsIHRpbWV6b25lKXtcbiAgdmFyIGN1ckRhdGUgPSBuZXcgRGF0ZSgpO1xuICB0ZXN0RGF0ZS5zZXRIb3Vycyh0ZXN0RGF0ZS5nZXRIb3VycygpLXRpbWV6b25lKTtcbiAgdmFyIHllYXIgPSBOdW1iZXIoMjArcGFydHMuc3Vic3RyKDYsMikpO1xuICB2YXIgbW9udGggPSBOdW1iZXIocGFydHMuc3Vic3RyKDAsMikpLTE7XG4gIHZhciBkYXRlID0gTnVtYmVyKHBhcnRzLnN1YnN0cigzLDIpKTtcbiAgdmFyIGhvdXIgPSBOdW1iZXIocGFydHMuc3Vic3RyKDksMikpO1xuICB2YXIgbWludXRlID0gTnVtYmVyKHBhcnRzLnN1YnN0cigxMiwyKSk7XG4gIGlmIChjdXJEYXRlLmdldFRpbWUoKT50ZXN0RGF0ZS5nZXRUaW1lKCkpIHJldHVybiBcIkludmFsaWQgZGF0ZSEgUGxlYXNlIGluc2VydCB0aW1lIGluIHRoZSBmdXR1cmUgZm9yIHlvdXIgcmVtaW5kZXJcIjtcbiAgdGVzdERhdGUuc2V0SG91cnModGVzdERhdGUuZ2V0SG91cnMoKSt0aW1lem9uZSk7XG4gIGlmICh5ZWFyIT10ZXN0RGF0ZS5nZXRGdWxsWWVhcigpfHxtb250aCE9dGVzdERhdGUuZ2V0TW9udGgoKXx8ZGF0ZSE9dGVzdERhdGUuZ2V0RGF0ZSgpfHxob3VyIT10ZXN0RGF0ZS5nZXRIb3VycygpfHxtaW51dGUhPXRlc3REYXRlLmdldE1pbnV0ZXMoKSl7XG4gIHJldHVybiBcIkludmFsaWQgZGF0ZSBmb3JtYXQhIFBsZWFzZSB0eXBlIGFnYWluIVwiO1xuICB9XG4gIHJldHVybiBcIkRvIHlvdSB3YW50IGFkZCBtb3JlIGluZm9ybWF0aW9uPyAoWSBmb3IgeWVzLCBOIGZvciBObylcIjtcbn1cbmV4cG9ydHMuZ2V0TG9jYXRpb24gPSBmdW5jdGlvbihsb2NhdGlvbil7XG4gIHZhciBwbGFjZXMgPSBbXTtcbiAgdmFyIHVybCA9IFwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3BsYWNlL3RleHRzZWFyY2gvanNvbj9xdWVyeT1cIiArIGxvY2F0aW9uICsgXCIma2V5PVwiICsgcHJvY2Vzcy5lbnYuR09PR0xFX0FQSV9LRVk7XG4gIHZhciByZXMgPSBzUmVxdWVzdCgnR0VUJywgdXJsLCB7XG4gICAgICAgICAgICB0aW1lb3V0OiAxMDAwMCAgXG4gICAgICAgIH0pO1xuICB2YXIgZGF0YSA9ICBKU09OLnBhcnNlKHJlcy5nZXRCb2R5KCd1dGY4JykpO1xuICBcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnJlc3VsdHMubGVuZ3RoOyBpKyspe1xuICAgIHZhciBwbGFjZSA9IHtcIm5hbWVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZm9ybWF0dGVkX2FkZHJlc3NcIl0sIFxuICAgICAgICAgICAgICAgIFwibGF0aXR1ZGVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZ2VvbWV0cnlcIl1bXCJsb2NhdGlvblwiXVtcImxhdFwiXSxcbiAgICAgICAgICAgICAgICBcImxvbmdpdHVkZVwiOiBkYXRhLnJlc3VsdHNbaV1bXCJnZW9tZXRyeVwiXVtcImxvY2F0aW9uXCJdW1wibG5nXCJdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAvL3ZhciBtZXNzYWdlSWQgPSBib2R5Lm1lc3NhZ2VfaWQ7XG4gICAgcGxhY2VzLnB1c2gocGxhY2UpO1xuICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCBwbGFjZSBcIisgcGxhY2UubmFtZSArIFwiIGxvbmdpdHVkZSA9IFwiICsgcGxhY2UubG9uZ2l0dWRlKTtcbiAgfSAgXG4gIHJldHVybiBwbGFjZXM7XG59Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "Util.js"
      ],
      "names": [
        "sRequest",
        "require",
        "exports",
        "nextReminder",
        "senderID",
        "cb",
        "list",
        "timezone",
        "i",
        "str",
        "forEach",
        "reminder",
        "day",
        "date",
        "getDate",
        "month",
        "getMonth",
        "year",
        "getFullYear",
        "hour",
        "getHours",
        "minute",
        "getMinutes",
        "content",
        "location",
        "undefined",
        "JSON",
        "parse",
        "name",
        "containsObject",
        "id",
        "length",
        "userid",
        "checkDate",
        "testDate",
        "parts",
        "curDate",
        "Date",
        "setHours",
        "Number",
        "substr",
        "getTime",
        "getLocation",
        "places",
        "url",
        "process",
        "env",
        "GOOGLE_API_KEY",
        "res",
        "timeout",
        "data",
        "getBody",
        "results",
        "place",
        "push"
      ],
      "mappings": "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",
      "file": "Util.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "import {getList, getProperty, getSortedList} from './dbUtil';\nconst sRequest = require('sync-request');\nexports.nextReminder = function(senderID, cb){\n  getList(senderID, \"Reminder\", function(list){\n    if(list[0]){\n      cb(list[0]);\n    } \n    else cb(\"No Reminder\");\n  });\n}\nexports.list = function(senderID, cb){\n  getProperty(senderID, \"User\", \"timezone\", function(timezone){\n    getSortedList(senderID, \"Reminder\", function(list){\n      var i = 1;\n      var str = \"\";\n      list.forEach(function(reminder){\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours()+timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year \n          + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\")+ \"\\n\";\n        i++;\n      });\n      if(!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n}\nexports.containsObject = function(id, list) {\n    var i;\n    for (i = 0; i < list.length; i++) {\n        if (list[i].userid == id) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n\nexports.checkDate = function(testDate, parts, timezone){\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours()-timezone);\n  var year = Number(20+parts.substr(6,2));\n  var month = Number(parts.substr(0,2))-1;\n  var date = Number(parts.substr(3,2));\n  var hour = Number(parts.substr(9,2));\n  var minute = Number(parts.substr(12,2));\n  if (curDate.getTime()>testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours()+timezone);\n  if (year!=testDate.getFullYear()||month!=testDate.getMonth()||date!=testDate.getDate()||hour!=testDate.getHours()||minute!=testDate.getMinutes()){\n  return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n}\nexports.getLocation = function(location){\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n            timeout: 10000  \n        });\n  var data =  JSON.parse(res.getBody('utf8'));\n  \n  for (var i = 0; i < data.results.length; i++){\n    var place = {\"name\": data.results[i][\"formatted_address\"], \n                \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n                \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n                };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }  \n  return places;\n}"
      ]
    },
    "mtime": 1520898426000
  },
  "{\"filename\":\"/app/server.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/server.js",
      "filenameRelative": "/app/server.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "server.js",
      "sourceFileName": "server.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "server"
    },
    "ignored": false,
    "code": "'use strict';\n\nrequire('babel-register');\nrequire('./bot.js');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxRQUFRLGdCQUFSO0FBQ0FBLFFBQVEsVUFBUiIsImZpbGUiOiJzZXJ2ZXIuanMiLCJzb3VyY2VSb290IjoiL2FwcCIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2JhYmVsLXJlZ2lzdGVyJyk7ICBcbnJlcXVpcmUoJy4vYm90LmpzJyk7ICAiXX0=",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "server.js"
      ],
      "names": [
        "require"
      ],
      "mappings": ";;AAAAA,QAAQ,gBAAR;AACAA,QAAQ,UAAR",
      "file": "server.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "require('babel-register');  \nrequire('./bot.js');  "
      ]
    },
    "mtime": 1520898427000
  },
  "{\"filename\":\"/app/bot.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./dbUtil",
            "imported": [
              "getSortedList",
              "incrementCounter",
              "replaceCounter",
              "flipCreating",
              "addDB",
              "getDB",
              "changeReminder",
              "getProperty",
              "getList"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getSortedList",
                "local": "getSortedList"
              },
              {
                "kind": "named",
                "imported": "incrementCounter",
                "local": "incrementCounter"
              },
              {
                "kind": "named",
                "imported": "replaceCounter",
                "local": "replaceCounter"
              },
              {
                "kind": "named",
                "imported": "flipCreating",
                "local": "flipCreating"
              },
              {
                "kind": "named",
                "imported": "addDB",
                "local": "addDB"
              },
              {
                "kind": "named",
                "imported": "getDB",
                "local": "getDB"
              },
              {
                "kind": "named",
                "imported": "changeReminder",
                "local": "changeReminder"
              },
              {
                "kind": "named",
                "imported": "getProperty",
                "local": "getProperty"
              },
              {
                "kind": "named",
                "imported": "getList",
                "local": "getList"
              }
            ]
          },
          {
            "source": "./Util.js",
            "imported": [
              "nextReminder",
              "checkDate",
              "containsObject",
              "list",
              "getLocation"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "nextReminder",
                "local": "nextReminder"
              },
              {
                "kind": "named",
                "imported": "checkDate",
                "local": "checkDate"
              },
              {
                "kind": "named",
                "imported": "containsObject",
                "local": "containsObject"
              },
              {
                "kind": "named",
                "imported": "list",
                "local": "list"
              },
              {
                "kind": "named",
                "imported": "getLocation",
                "local": "getLocation"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/bot.js",
      "filenameRelative": "/app/bot.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "bot.js",
      "sourceFileName": "bot.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "bot"
    },
    "ignored": false,
    "code": "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\n\nvar _dbUtil = require('./dbUtil');\n\nvar _Util = require('./Util.js');\n\nvar ObjectId = require('mongodb').ObjectID;\nvar schedule = require('node-schedule');\nvar watson = require('watson-developer-cloud');\nvar mongodb = require(\"mongodb\");\nvar express = require('express');\nvar bodyParser = require('body-parser');\nvar request = require('request');\nvar path = require('path');\n\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nvar app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function (req, res) {\n  if (req.query['hub.mode'] === 'subscribe' && req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);\n  }\n});\n\n// Display the web page\napp.get('/', function (req, res) {\n  res.writeHead(200, { 'Content-Type': 'text/html' });\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {\n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function (entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function (event) {\n        callUserProfileAPI(event.sender.id, function (body) {\n          var userData = { userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone };\n          (0, _dbUtil.getDB)(\"User\", function (collection) {\n            if (!(0, _Util.containsObject)(event.sender.id, collection)) {\n              (0, _dbUtil.addDB)(\"User\", userData, event.sender.id);\n            }\n            if (event.message) {\n              receivedMessage(event);\n            } else if (event.postback) {\n              receivedPostback(event);\n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n\n  if (messageText) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageText);else {\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"creating\", function (p) {\n      if (p) newReminder(senderID, messageAttachments);else getAttachment(senderID, messageAttachments[0].payload.url, messageAttachments[0].type, \"Attachment\");\n    });\n  }\n}\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n\n  //Do Something after users clicked Get Started button \n  if (event.postback.payload === \"GET_STARTED_PAYLOAD\") {\n    callUserProfileAPI(senderID, function (body) {\n      console.log(body);\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, userName);\n    });\n  } else {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"reminder\", function (reminder) {\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      //console.log(payload);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip if none\"\n        }\n      };\n      (0, _dbUtil.changeReminder)(senderID, reminder);\n      (0, _dbUtil.incrementCounter)(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: { 'text': messageText },\n    context: context\n  }, function (err, response) {\n    if (err) console.log('error:', err);else {\n\n      var messageData;\n      if (response.intents[0]) {\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n          case 'list':\n            (0, _Util.list)(senderID, function (str) {\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: str\n                }\n              });\n            });\n            break;\n          case 'next':\n            (0, _Util.nextReminder)(senderID, function (str) {\n              var options = { weekday: \"long\", year: \"numeric\", month: \"short\",\n                day: \"numeric\" };\n              callSendAPI({\n                recipient: {\n                  id: senderID\n                },\n                message: {\n                  text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n                }\n              });\n            });\n            break;\n          case 'create':\n            respond = \"What do you want to remind about?\";\n            (0, _dbUtil.flipCreating)(true, senderID);\n            break;\n          case 'help':\n            sendHelpMessage(senderID);\n            break;\n          case 'delete':\n            (0, _dbUtil.getSortedList)(senderID, \"Reminder\", function (list) {\n              var index = Number(messageText.substr(messageText.length - 1, 1)) - 1;\n              if (index >= 0 && index < list.length) {\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({ \"_id\": ObjectId(id) }, function (err, doc) {\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n            break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            respond = \"Good bye!\";\n            break;\n          case 'who':\n            respond = \"My name is Bob\";\n            break;\n          default:\n            respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        };\n      } else {\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous', 'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington', 'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates', 'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous', 'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner', 'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random() * 6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        };\n      }\n      if (messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" + \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\\n\" + \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\nfunction getAttachment(senderID, url, fileType, message) {\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\" + url + \"&type=\" + fileType + \"&userid=\" + senderID;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function (error, response, body) {\n    console.log(\"DONE!\");\n  });\n}\n\nfunction countAttachment(senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"Attachments\");\n    collection.find({ \"userid\": senderID }).count(function (err, result) {\n      console.log(count);\n      var count = result;\n    });\n  });\n}\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });\n}\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if (cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\nfunction newReminder(senderID, messData) {\n  var respondText;\n  (0, _dbUtil.getProperty)(senderID, \"User\", \"counter\", function (counter) {\n    (0, _dbUtil.getProperty)(senderID, \"User\", \"reminder\", function (reminder) {\n      (0, _dbUtil.getProperty)(senderID, \"User\", \"timezone\", function (timezone) {\n        console.log(counter);\n        if (counter == 0) {\n          reminder.userid = senderID;\n          reminder.content = messData;\n          (0, _dbUtil.incrementCounter)(senderID);\n          respondText = {\n            text: \"When? (mm/dd/yy-hh:mm)\"\n          };\n        } else if (counter == 1) {\n          var parts = messData;\n          reminder.date = new Date(20 + parts.substr(6, 2), Number(parts.substr(0, 2)) - 1, parts.substr(3, 2), Number(parts.substr(9, 2)), parts.substr(12, 2));\n          var text = (0, _Util.checkDate)(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") (0, _dbUtil.incrementCounter)(senderID);\n          respondText = {\n            text: text\n          };\n        } else if (counter == 2) {\n          if (messData !== \"Y\" && messData !== \"N\") {\n            respondText = {\n              text: \"Invalid character, type again (Y/N).\"\n            };\n          } else if (messData == \"N\") {\n            (0, _dbUtil.flipCreating)(false, senderID);\n            reminder.date.setHours(reminder.date.getHours() - timezone);\n            (0, _dbUtil.addDB)(\"Reminder\", reminder, senderID, function (doc) {\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function (x) {\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err;\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                    if (err) throw err;\n                    if (docs.length != 0) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };\n            (0, _dbUtil.replaceCounter)(0, senderID);\n            reminder = {};\n          } else {\n            respondText = {\n              text: \"What is the location? Type skip if none\"\n            };\n            (0, _dbUtil.incrementCounter)(senderID);\n          }\n        } else if (counter == 3) {\n          if (messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = (0, _Util.getLocation)(messData);\n            var long, lat;\n            var buttons = [];\n            for (var i = 0; i < Math.min(3, places.length); i++) {\n              var button = { type: \"postback\",\n                title: places[i]['name'],\n                payload: JSON.stringify(places[i]) };\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment: {\n                type: \"template\",\n                payload: {\n                  template_type: \"button\",\n                  text: \"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };\n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              \"message\": respondText\n\n            });\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          } else {\n            respondText = {\n              text: \"Attach any files. Type skip of none\"\n            };\n            (0, _dbUtil.incrementCounter)(senderID);\n          }\n\n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        } else if (counter == 4) {\n          console.log(reminder);\n          reminder.attachment = { url: \"\", type: \"\" };\n          if (messData[0].type) {\n            getAttachment(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = { url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type };\n          }\n\n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n            text: \"Finshed creating reminder.\"\n          };\n          (0, _dbUtil.flipCreating)(false, senderID);\n          (0, _dbUtil.replaceCounter)(0, senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours() - timezone);\n          (0, _dbUtil.addDB)(\"Reminder\", reminder, senderID, function (doc) {\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function (x) {\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err;\n                var collection = db.collection(\"Reminder\");\n                collection.find({ \"_id\": ObjectId(doc._id) }).toArray(function (err, docs) {\n                  if (err) throw err;\n                  if (docs.length != 0) {\n                    if (reminder.attachment) {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\": {\n                          \"attachment\": {\n                            \"type\": reminder.attachment.type,\n                            \"payload\": {\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      });\n                    }\n                    if (reminder.location) {\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\": {\n                            \"type\": \"template\",\n                            \"payload\": {\n                              \"template_type\": \"generic\",\n                              \"elements\": [{\n                                \"title\": location.name,\n                                \"image_url\": \"https://maps.googleapis.com/maps/api/staticmap?center=\" + location.latitude + \",\" + location.longitude + \"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\" + location.latitude + \",\" + location.longitude,\n                                \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                \"buttons\": [{\n                                  \"type\": \"web_url\",\n                                  \"url\": \"https://www.google.com/maps/place/\" + location.name + \"/@\" + location.latitude + \",\" + location.longitude,\n                                  \"title\": \"go to Google Map\"\n                                }]\n                              }]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    } else {\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({ \"_id\": ObjectId(doc._id) });\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        (0, _dbUtil.changeReminder)(senderID, reminder);\n      });\n    });\n  });\n}\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvdC5qcyJdLCJuYW1lcyI6WyJPYmplY3RJZCIsInJlcXVpcmUiLCJPYmplY3RJRCIsInNjaGVkdWxlIiwid2F0c29uIiwibW9uZ29kYiIsImV4cHJlc3MiLCJib2R5UGFyc2VyIiwicmVxdWVzdCIsInBhdGgiLCJodHRwIiwiZnMiLCJtZXNzZW5nZXJCdXR0b24iLCJ1c2VyTmFtZSIsImNvbnZlcnNhdGlvbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJ2ZXJzaW9uIiwidmVyc2lvbl9kYXRlIiwiY29udGV4dCIsImFwcCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJNb25nb0NsaWVudCIsInVybDEiLCJnZXQiLCJyZXEiLCJyZXMiLCJxdWVyeSIsInByb2Nlc3MiLCJlbnYiLCJWRVJJRllfVE9LRU4iLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwic2VuZCIsImVycm9yIiwic2VuZFN0YXR1cyIsIndyaXRlSGVhZCIsIndyaXRlIiwiZW5kIiwicG9zdCIsImRhdGEiLCJib2R5Iiwib2JqZWN0IiwiZW50cnkiLCJmb3JFYWNoIiwicGFnZUlEIiwiaWQiLCJ0aW1lT2ZFdmVudCIsInRpbWUiLCJtZXNzYWdpbmciLCJldmVudCIsImNhbGxVc2VyUHJvZmlsZUFQSSIsInNlbmRlciIsInVzZXJEYXRhIiwidXNlcmlkIiwiY291bnRlciIsImtleXdvcmRzIiwiY3JlYXRpbmciLCJyZW1pbmRlciIsInRpbWV6b25lIiwiY29sbGVjdGlvbiIsIm1lc3NhZ2UiLCJyZWNlaXZlZE1lc3NhZ2UiLCJwb3N0YmFjayIsInJlY2VpdmVkUG9zdGJhY2siLCJzZW5kZXJJRCIsInJlY2lwaWVudElEIiwicmVjaXBpZW50IiwidGltZU9mTWVzc2FnZSIsInRpbWVzdGFtcCIsIm1lc3NhZ2VJZCIsIm1pZCIsIm1lc3NhZ2VUZXh0IiwidGV4dCIsIm1lc3NhZ2VBdHRhY2htZW50cyIsImF0dGFjaG1lbnRzIiwicCIsIm5ld1JlbWluZGVyIiwic2VuZFRleHRNZXNzYWdlIiwiZ2V0QXR0YWNobWVudCIsInBheWxvYWQiLCJ1cmwiLCJ0eXBlIiwidGltZU9mUG9zdGJhY2siLCJuYW1lIiwiZmlzdF9uYW1lIiwic2VuZFdlbGNvbWVNZXNzYWdlIiwibG9jYXRpb24iLCJKU09OIiwicGFyc2UiLCJtZXNzYWdlRGF0YSIsImNhbGxTZW5kQVBJIiwid29ya3NwYWNlX2lkIiwiaW5wdXQiLCJlcnIiLCJyZXNwb25zZSIsImludGVudHMiLCJjb21tYW5kIiwiaW50ZW50IiwicmVzcG9uZCIsInN0ciIsIm9wdGlvbnMiLCJ3ZWVrZGF5IiwieWVhciIsIm1vbnRoIiwiZGF5IiwiY29udGVudCIsImRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJzZW5kSGVscE1lc3NhZ2UiLCJsaXN0IiwiaW5kZXgiLCJOdW1iZXIiLCJzdWJzdHIiLCJsZW5ndGgiLCJfaWQiLCJjb25uZWN0IiwiZGIiLCJyZW1vdmUiLCJkb2MiLCJmdW5ueVF1b3RlcyIsImkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzZW5kZXJJZCIsImZpbGVUeXBlIiwicmVwbGFjZSIsInVybFJlcSIsInVyaSIsIm1ldGhvZCIsImNvdW50QXR0YWNobWVudCIsImZpbmQiLCJjb3VudCIsInJlc3VsdCIsInFzIiwiYWNjZXNzX3Rva2VuIiwiUEFHRV9BQ0NFU1NfVE9LRU4iLCJzdGF0dXNDb2RlIiwicmVjaXBpZW50SWQiLCJyZWNpcGllbnRfaWQiLCJtZXNzYWdlX2lkIiwiY2IiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwibWVzc0RhdGEiLCJyZXNwb25kVGV4dCIsInBhcnRzIiwiRGF0ZSIsInNldEhvdXJzIiwiZ2V0SG91cnMiLCJvcHMiLCJzY2hlZHVsZUpvYiIsIngiLCJ0b0FycmF5IiwiZG9jcyIsImNsb3NlIiwiYmluZCIsInBsYWNlcyIsImxvbmciLCJsYXQiLCJidXR0b25zIiwibWluIiwiYnV0dG9uIiwidGl0bGUiLCJzdHJpbmdpZnkiLCJwdXNoIiwiYXR0YWNobWVudCIsInRlbXBsYXRlX3R5cGUiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsInNlcnZlciIsImxpc3RlbiIsIlBPUlQiLCJhZGRyZXNzIiwicG9ydCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBU0E7O0FBRUE7O0FBVkEsSUFBTUEsV0FBV0MsUUFBUSxTQUFSLEVBQW1CQyxRQUFwQztBQUNBLElBQU1DLFdBQVdGLFFBQVEsZUFBUixDQUFqQjtBQUNBLElBQU1HLFNBQVNILFFBQVEsd0JBQVIsQ0FBZjtBQUNBLElBQU1JLFVBQVVKLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1LLFVBQVVMLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1NLGFBQWFOLFFBQVEsYUFBUixDQUFuQjtBQUNBLElBQU1PLFVBQVVQLFFBQVEsU0FBUixDQUFoQjtBQUNBLElBQU1RLE9BQU9SLFFBQVEsTUFBUixDQUFiOztBQUlBLElBQUlTLE9BQU9ULFFBQVEsT0FBUixDQUFYO0FBQ0EsSUFBSVUsS0FBS1YsUUFBUSxJQUFSLENBQVQ7O0FBRUEsSUFBSVcsa0JBQWtCLCtYQUF0QjtBQUNBO0FBQ0EsSUFBSUMsV0FBVyxNQUFmO0FBQ0E7QUFDQSxJQUFJQyxlQUFlVixPQUFPVSxZQUFQLENBQW9CO0FBQ3JDQyxZQUFVLHNDQUQyQjtBQUVyQ0MsWUFBVSxjQUYyQjtBQUdyQ0MsV0FBUyxJQUg0QjtBQUlyQ0MsZ0JBQWM7QUFKdUIsQ0FBcEIsQ0FBbkI7QUFNQSxJQUFJQyxVQUFVLEVBQWQ7QUFDQTtBQUNBLElBQUlDLE1BQU1kLFNBQVY7O0FBRUFjLElBQUlDLEdBQUosQ0FBUWQsV0FBV2UsSUFBWCxFQUFSO0FBQ0FGLElBQUlDLEdBQUosQ0FBUWQsV0FBV2dCLFVBQVgsQ0FBc0I7QUFDNUJDLFlBQVU7QUFEa0IsQ0FBdEIsQ0FBUjtBQUdBO0FBQ0EsSUFBSUMsY0FBY3BCLFFBQVFvQixXQUExQjtBQUNBLElBQUlDLE9BQU8sb0VBQVg7QUFDQTtBQUNBTixJQUFJTyxHQUFKLENBQVEsVUFBUixFQUFvQixVQUFTQyxHQUFULEVBQWND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QUFXakosUUFBUUMsR0FBUixDQUFZaUosSUFBWixJQUFvQixJQUEvQixFQUFxQyxZQUFZO0FBQzVEL0ksVUFBUUMsR0FBUixDQUFZLHNCQUFaLEVBQW9DNEksT0FBT0csT0FBUCxHQUFpQkMsSUFBckQ7QUFDRCxDQUZZLENBQWIiLCJmaWxlIjoiYm90LmpzIiwic291cmNlUm9vdCI6Ii9hcHAiLCJzb3VyY2VzQ29udGVudCI6WyIvL1xuLy8gVGhpcyBpcyBtYWluIGZpbGUgY29udGFpbmluZyBjb2RlIGltcGxlbWVudGluZyB0aGUgRXhwcmVzcyBzZXJ2ZXIgYW5kIGZ1bmN0aW9uYWxpdHkgZm9yIHRoZSBFeHByZXNzIGVjaG8gYm90LlxuLy9cbid1c2Ugc3RyaWN0JztcbmNvbnN0IE9iamVjdElkID0gcmVxdWlyZSgnbW9uZ29kYicpLk9iamVjdElEO1xuY29uc3Qgc2NoZWR1bGUgPSByZXF1aXJlKCdub2RlLXNjaGVkdWxlJyk7XG5jb25zdCB3YXRzb24gPSByZXF1aXJlKCd3YXRzb24tZGV2ZWxvcGVyLWNsb3VkJyk7XG5jb25zdCBtb25nb2RiID0gcmVxdWlyZShcIm1vbmdvZGJcIilcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcbmNvbnN0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0Jyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuaW1wb3J0IHtnZXRTb3J0ZWRMaXN0LCBpbmNyZW1lbnRDb3VudGVyLCByZXBsYWNlQ291bnRlciwgZmxpcENyZWF0aW5nLCBcbiAgICAgICAgYWRkREIsIGdldERCLCBjaGFuZ2VSZW1pbmRlciwgZ2V0UHJvcGVydHksIGdldExpc3R9IGZyb20gJy4vZGJVdGlsJztcbmltcG9ydCB7bmV4dFJlbWluZGVyLCBjaGVja0RhdGUsIGNvbnRhaW5zT2JqZWN0LCBsaXN0LCBnZXRMb2NhdGlvbn0gZnJvbSAnLi9VdGlsLmpzJztcbnZhciBodHRwID0gcmVxdWlyZSgnaHR0cHMnKTtcbnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbnZhciBtZXNzZW5nZXJCdXR0b24gPSBcIjxodG1sPjxoZWFkPjx0aXRsZT5GYWNlYm9vayBNZXNzZW5nZXIgQm90PC90aXRsZT48L2hlYWQ+PGJvZHk+PGgxPkZhY2Vib29rIE1lc3NlbmdlciBCb3Q8L2gxPlRoaXMgaXMgYSBib3QgYmFzZWQgb24gTWVzc2VuZ2VyIFBsYXRmb3JtIFF1aWNrU3RhcnQuIEZvciBtb3JlIGRldGFpbHMsIHNlZSB0aGVpciA8YSBocmVmPVxcXCJodHRwczovL2RldmVsb3BlcnMuZmFjZWJvb2suY29tL2RvY3MvbWVzc2VuZ2VyLXBsYXRmb3JtL2d1aWRlcy9xdWljay1zdGFydFxcXCI+ZG9jczwvYT4uPGZvb3RlciBpZD1cXFwiZ1dpZGdldFxcXCI+PC9mb290ZXI+PHNjcmlwdCBzcmM9XFxcImh0dHBzOi8vd2lkZ2V0LmdsaXRjaC5tZS93aWRnZXQubWluLmpzXFxcIj48L3NjcmlwdD48L2JvZHk+PC9odG1sPlwiO1xuLy9Vc2VyJ3MgZGF0YVxudmFyIHVzZXJOYW1lID0gXCJ0ZXN0XCI7XG4vLyBXYXRzb24gZGF0YVxudmFyIGNvbnZlcnNhdGlvbiA9IHdhdHNvbi5jb252ZXJzYXRpb24oe1xuICB1c2VybmFtZTogJ2ExNjJhY2I4LWQ1MTAtNGMxZS04ZTgxLWFhNTE0ZWUzYjc2OScsXG4gIHBhc3N3b3JkOiAna1dDNHhtZFdpUThaJyxcbiAgdmVyc2lvbjogJ3YxJyxcbiAgdmVyc2lvbl9kYXRlOiAnMjAxNy0wMi0wMydcbn0pO1xudmFyIGNvbnRleHQgPSB7fTtcbi8vIFRoZSByZXN0IG9mIHRoZSBjb2RlIGltcGxlbWVudHMgdGhlIHJvdXRlcyBmb3Igb3VyIEV4cHJlc3Mgc2VydmVyLlxubGV0IGFwcCA9IGV4cHJlc3MoKTtcblxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7XG4gIGV4dGVuZGVkOiB0cnVlXG59KSk7XG4vLyBkYXRhYmFzZSBjb25maWdcbnZhciBNb25nb0NsaWVudCA9IG1vbmdvZGIuTW9uZ29DbGllbnRcbnZhciB1cmwxID0gXCJtb25nb2RiOi8vdGllbmFuaDIwMDc6RGllbjEyMzRAZHMxNTcwNDAubWxhYi5jb206NTcwNDAvcmVtaW5kZXJib3RcIjtcbi8vIFdlYmhvb2sgdmFsaWRhdGlvblxuYXBwLmdldCgnL3dlYmhvb2snLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICBpZiAocmVxLnF1ZXJ5WydodWIubW9kZSddID09PSAnc3Vic2NyaWJlJyAmJlxuICAgICAgcmVxLnF1ZXJ5WydodWIudmVyaWZ5X3Rva2VuJ10gPT09IHByb2Nlc3MuZW52LlZFUklGWV9UT0tFTikge1xuICAgIGNvbnNvbGUubG9nKFwiVmFsaWRhdGluZyB3ZWJob29rXCIpO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlcS5xdWVyeVsnaHViLmNoYWxsZW5nZSddKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHZhbGlkYXRpb24uIE1ha2Ugc3VyZSB0aGUgdmFsaWRhdGlvbiB0b2tlbnMgbWF0Y2guXCIpO1xuICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7ICAgICAgICAgIFxuICB9XG59KTtcblxuLy8gRGlzcGxheSB0aGUgd2ViIHBhZ2VcbmFwcC5nZXQoJy8nLCBmdW5jdGlvbihyZXEsIHJlcykge1xuICByZXMud3JpdGVIZWFkKDIwMCwgeydDb250ZW50LVR5cGUnOiAndGV4dC9odG1sJ30pO1xuICByZXMud3JpdGUobWVzc2VuZ2VyQnV0dG9uKTtcbiAgcmVzLmVuZCgpO1xufSk7XG5cbi8vIE1lc3NhZ2UgcHJvY2Vzc2luZ1xuYXBwLnBvc3QoJy93ZWJob29rJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHZhciBkYXRhID0gcmVxLmJvZHk7XG4gIGlmIChkYXRhLm9iamVjdCA9PT0gJ3BhZ2UnKSB7ICAgIFxuICAgIC8vIEl0ZXJhdGUgb3ZlciBlYWNoIGVudHJ5IC0gdGhlcmUgbWF5IGJlIG11bHRpcGxlIGlmIGJhdGNoZWRcbiAgICBkYXRhLmVudHJ5LmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgIHZhciBwYWdlSUQgPSBlbnRyeS5pZDtcbiAgICAgIHZhciB0aW1lT2ZFdmVudCA9IGVudHJ5LnRpbWU7XG4gICAgICAvLyBJdGVyYXRlIG92ZXIgZWFjaCBtZXNzYWdpbmcgZXZlbnRcbiAgICAgIGVudHJ5Lm1lc3NhZ2luZy5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGNhbGxVc2VyUHJvZmlsZUFQSShldmVudC5zZW5kZXIuaWQsIGZ1bmN0aW9uKGJvZHkpe1xuICAgICAgICAgIHZhciB1c2VyRGF0YSA9IHt1c2VyaWQ6IGV2ZW50LnNlbmRlci5pZCwgY291bnRlcjogMCwga2V5d29yZHM6IFtdLCBjcmVhdGluZzogZmFsc2UsIHJlbWluZGVyOiB7fSwgdGltZXpvbmU6IGJvZHkudGltZXpvbmV9O1xuICAgICAgICAgIGdldERCKFwiVXNlclwiLCBmdW5jdGlvbihjb2xsZWN0aW9uKXtcbiAgICAgICAgICAgIGlmKCFjb250YWluc09iamVjdChldmVudC5zZW5kZXIuaWQsIGNvbGxlY3Rpb24pKXtcbiAgICAgICAgICAgICAgYWRkREIoXCJVc2VyXCIsIHVzZXJEYXRhLCBldmVudC5zZW5kZXIuaWQpOyAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlbnQubWVzc2FnZSkge1xuICAgICAgICAgICAgICByZWNlaXZlZE1lc3NhZ2UoZXZlbnQpOyBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQucG9zdGJhY2spIHtcbiAgICAgICAgICAgICAgcmVjZWl2ZWRQb3N0YmFjayhldmVudCk7IFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXZWJob29rIHJlY2VpdmVkIHVua25vd24gZXZlbnQ6IFwiLCBldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gQXNzdW1lIGFsbCB3ZW50IHdlbGwuXG4gICAgLy9cbiAgICAvLyBZb3UgbXVzdCBzZW5kIGJhY2sgYSAyMDAsIHdpdGhpbiAyMCBzZWNvbmRzLCB0byBsZXQgdXMga25vd1xuICAgIC8vIHlvdSd2ZSBzdWNjZXNzZnVsbHkgcmVjZWl2ZWQgdGhlIGNhbGxiYWNrLiBPdGhlcndpc2UsIHRoZSByZXF1ZXN0XG4gICAgLy8gd2lsbCB0aW1lIG91dCBhbmQgd2Ugd2lsbCBrZWVwIHRyeWluZyB0byByZXNlbmQuXG4gICAgcmVzLnNlbmRTdGF0dXMoMjAwKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIHJlY2VpdmVkTWVzc2FnZShldmVudCkge1xuICB2YXIgc2VuZGVySUQgPSBldmVudC5zZW5kZXIuaWQ7XG4gIHZhciByZWNpcGllbnRJRCA9IGV2ZW50LnJlY2lwaWVudC5pZDtcbiAgdmFyIHRpbWVPZk1lc3NhZ2UgPSBldmVudC50aW1lc3RhbXA7XG4gIHZhciBtZXNzYWdlID0gZXZlbnQubWVzc2FnZTtcblxuICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIG1lc3NhZ2UgZm9yIHVzZXIgJWQgYW5kIHBhZ2UgJWQgYXQgJWQgd2l0aCBtZXNzYWdlOlwiLCBcbiAgICBzZW5kZXJJRCwgcmVjaXBpZW50SUQsIHRpbWVPZk1lc3NhZ2UpO1xuXG4gIHZhciBtZXNzYWdlSWQgPSBtZXNzYWdlLm1pZDtcblxuICB2YXIgbWVzc2FnZVRleHQgPSBtZXNzYWdlLnRleHQ7XG4gIHZhciBtZXNzYWdlQXR0YWNobWVudHMgPSBtZXNzYWdlLmF0dGFjaG1lbnRzO1xuICBcbiAgaWYgKG1lc3NhZ2VUZXh0KSB7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcImNyZWF0aW5nXCIsIGZ1bmN0aW9uKHApe1xuICAgICAgaWYocCkgbmV3UmVtaW5kZXIoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KTtcbiAgICAgIGVsc2V7XG4gICAgICAgIHN3aXRjaCAobWVzc2FnZVRleHQpIHtcbiAgICAgICAgICAvL0Nhc2VzIHdoZXJlIHRoZSB0ZXh0IGRvZXNuJ3QgaGF2ZSB0byBnbyB0aHJvdWdoIEJsdWVNaXggQVBJIChOb3RoaW5nIHJpZ2h0IG5vdylcbiAgICAgICAgICAvLyBjYXNlICdnZW5lcmljJzpcbiAgICAgICAgICAvLyAgIHNlbmRHZW5lcmljTWVzc2FnZShzZW5kZXJJRCk7XG4gICAgICAgICAgLy8gICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgc2VuZFRleHRNZXNzYWdlKHNlbmRlcklELCBtZXNzYWdlVGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBpZiAobWVzc2FnZUF0dGFjaG1lbnRzKSB7XG4gICAgICBnZXRQcm9wZXJ0eShzZW5kZXJJRCwgXCJVc2VyXCIsIFwiY3JlYXRpbmdcIiwgZnVuY3Rpb24ocCl7XG4gICAgICAgIGlmKHApIG5ld1JlbWluZGVyKHNlbmRlcklELCBtZXNzYWdlQXR0YWNobWVudHMpO1xuICAgICAgICBlbHNlIGdldEF0dGFjaG1lbnQoc2VuZGVySUQsIG1lc3NhZ2VBdHRhY2htZW50c1swXS5wYXlsb2FkLnVybCwgbWVzc2FnZUF0dGFjaG1lbnRzWzBdLnR5cGUsXCJBdHRhY2htZW50XCIpO1xuICAgICAgfSkgICAgICBcbiAgfVxufVxuXG5mdW5jdGlvbiByZWNlaXZlZFBvc3RiYWNrKGV2ZW50KSB7XG4gIHZhciBzZW5kZXJJRCA9IGV2ZW50LnNlbmRlci5pZDtcbiAgdmFyIHJlY2lwaWVudElEID0gZXZlbnQucmVjaXBpZW50LmlkO1xuICB2YXIgdGltZU9mUG9zdGJhY2sgPSBldmVudC50aW1lc3RhbXA7XG5cbiAgLy8gVGhlICdwYXlsb2FkJyBwYXJhbSBpcyBhIGRldmVsb3Blci1kZWZpbmVkIGZpZWxkIHdoaWNoIGlzIHNldCBpbiBhIHBvc3RiYWNrIFxuICAvLyBidXR0b24gZm9yIFN0cnVjdHVyZWQgTWVzc2FnZXMuIFxuICB2YXIgcGF5bG9hZCA9IGV2ZW50LnBvc3RiYWNrLnBheWxvYWQ7XG5cbiAgY29uc29sZS5sb2coXCJSZWNlaXZlZCBwb3N0YmFjayBmb3IgdXNlciAlZCBhbmQgcGFnZSAlZCB3aXRoIHBheWxvYWQgJyVzJyBcIiArIFxuICAgIFwiYXQgJWRcIiwgc2VuZGVySUQsIHJlY2lwaWVudElELCBwYXlsb2FkLCB0aW1lT2ZQb3N0YmFjayk7XG5cbiAgLy8gV2hlbiBhIHBvc3RiYWNrIGlzIGNhbGxlZCwgd2UnbGwgc2VuZCBhIG1lc3NhZ2UgYmFjayB0byB0aGUgc2VuZGVyIHRvIFxuICAvLyBsZXQgdGhlbSBrbm93IGl0IHdhcyBzdWNjZXNzZnVsXG4gIFxuICAvL0RvIFNvbWV0aGluZyBhZnRlciB1c2VycyBjbGlja2VkIEdldCBTdGFydGVkIGJ1dHRvbiBcbiAgaWYoZXZlbnQucG9zdGJhY2sucGF5bG9hZCA9PT0gXCJHRVRfU1RBUlRFRF9QQVlMT0FEXCIpe1xuICAgIGNhbGxVc2VyUHJvZmlsZUFQSShzZW5kZXJJRCwgZnVuY3Rpb24oYm9keSl7XG4gICAgICBjb25zb2xlLmxvZyhib2R5KTtcbiAgICAgIHZhciBuYW1lID0gYm9keS5maXN0X25hbWUgKyBcIiBcIiArIGJvZHkuZmlzdF9uYW1lO1xuICAgICAgc2VuZFdlbGNvbWVNZXNzYWdlKHNlbmRlcklELCB1c2VyTmFtZSk7XG4gICAgfSlcbiAgICBcbiAgfVxuICBlbHNle1xuICAgIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJyZW1pbmRlclwiLCBmdW5jdGlvbihyZW1pbmRlcil7XG4gICAgICBjb25zb2xlLmxvZyhyZW1pbmRlcik7XG4gICAgICByZW1pbmRlci5sb2NhdGlvbiA9IHBheWxvYWQ7XG4gICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocGF5bG9hZCk7XG4gICAgICAvL2NvbnNvbGUubG9nKHBheWxvYWQpO1xuICAgICAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgfSxcbiAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgIHRleHQ6IFwiQXR0YWNoIGFueSBmaWxlcy4gVHlwZSBza2lwIGlmIG5vbmVcIlxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY2hhbmdlUmVtaW5kZXIoc2VuZGVySUQsIHJlbWluZGVyKTtcbiAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgIH0pO1xuICB9XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBTZW5kaW5nIGhlbHBlcnNcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5mdW5jdGlvbiBzZW5kVGV4dE1lc3NhZ2Uoc2VuZGVySUQsIG1lc3NhZ2VUZXh0KSB7XG4gIGNvbnZlcnNhdGlvbi5tZXNzYWdlKHtcbiAgICB3b3Jrc3BhY2VfaWQ6ICcxZTc1NzNmNS05MzlkLTQ3ZTMtODY5MC01ZWYxYzA5NDZiNjMnLFxuICAgIGlucHV0OiB7J3RleHQnOiBtZXNzYWdlVGV4dH0sXG4gICAgY29udGV4dDogY29udGV4dFxuICB9LCAgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkge1xuICAgIGlmIChlcnIpXG4gICAgICBjb25zb2xlLmxvZygnZXJyb3I6JywgZXJyKTtcbiAgICBlbHNle1xuICAgICAgXG4gICAgICB2YXIgbWVzc2FnZURhdGE7XG4gICAgICBpZihyZXNwb25zZS5pbnRlbnRzWzBdKXtcbiAgICAgICAgdmFyIGNvbW1hbmQgPSByZXNwb25zZS5pbnRlbnRzWzBdLmludGVudDtcbiAgICAgICAgdmFyIHJlc3BvbmQgPSBcIlwiO1xuICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgY2FzZSAnbGlzdCc6XG4gICAgICAgICAgbGlzdChzZW5kZXJJRCwgZnVuY3Rpb24oc3RyKXtcbiAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBzdHJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICduZXh0JzpcbiAgICAgICAgICBuZXh0UmVtaW5kZXIoc2VuZGVySUQsIGZ1bmN0aW9uKHN0cil7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHsgd2Vla2RheTogXCJsb25nXCIsIHllYXI6IFwibnVtZXJpY1wiLCBtb250aDogXCJzaG9ydFwiLCAgXG4gICAgICAgICAgICAgIGRheTogXCJudW1lcmljXCIgfTsgIFxuICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgc3RyLmNvbnRlbnQgKyBcIiBhZnRlciBcIiArIHN0ci5kYXRlLnRvTG9jYWxlVGltZVN0cmluZyhcImVuLVVTXCIsIG9wdGlvbnMpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICByZXNwb25kID0gXCJXaGF0IGRvIHlvdSB3YW50IHRvIHJlbWluZCBhYm91dD9cIjtcbiAgICAgICAgICBmbGlwQ3JlYXRpbmcodHJ1ZSwgc2VuZGVySUQpO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaGVscCc6ICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgIHNlbmRIZWxwTWVzc2FnZShzZW5kZXJJRCk7ICAgICAgICAgIFxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgIGdldFNvcnRlZExpc3Qoc2VuZGVySUQsIFwiUmVtaW5kZXJcIiwgZnVuY3Rpb24obGlzdCl7XG4gICAgICAgICAgICAgIHZhciBpbmRleCA9IE51bWJlcihtZXNzYWdlVGV4dC5zdWJzdHIobWVzc2FnZVRleHQubGVuZ3RoLTEsIDEpKS0xO1xuICAgICAgICAgICAgICBpZihpbmRleCA+PSAwICYmIGluZGV4IDwgbGlzdC5sZW5ndGgpe1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IGxpc3RbaW5kZXhdLl9pZDtcbiAgICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihcIlJlbWluZGVyXCIpO1xuICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGlkKX0sIGZ1bmN0aW9uKGVyciwgZG9jKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcImRlbGV0ZWQgXCIgKyBsaXN0W2luZGV4XS5jb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnaGknOlxuICAgICAgICAgICAgcmVzcG9uZCA9IFwiSGVsbG9cIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RoeCc6XG4gICAgICAgICAgICByZXNwb25kID0gXCJZb3UncmUgd2VsY29tZVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnYnllJzpcbiAgICAgICAgICAgIHJlc3BvbmQgPSBcIkdvb2QgYnllIVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnd2hvJzpcbiAgICAgICAgICAgIHJlc3BvbmQgPSBcIk15IG5hbWUgaXMgQm9iXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXNwb25kID0gY29tbWFuZDtcbiAgICAgICAgfTtcbiAgICAgICAgbWVzc2FnZURhdGEgPSB7XG4gICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgIHRleHQ6IHJlc3BvbmRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIHZhciBmdW5ueVF1b3RlcyA9IFsnXCJIb3cgZG8geW91IGdldCBhIHN3ZWV0IGxpdHRsZSA4MC15ZWFyLW9sZCBsYWR5IHRvIHNheSB0aGUgRiB3b3JkPyBHZXQgYW5vdGhlciBzd2VldCBsaXR0bGUgODAteWVhci1vbGQgbGFkeSB0byB5ZWxsIFwiQklOR08hXCIgLSBBbm9ueW1vdXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnS25vd2xlZGdlIGlzIGtub3dpbmcgYSB0b21hdG8gaXMgYSBmcnVpdDsgd2lzZG9tIGlzIG5vdCBwdXR0aW5nIGl0IGluIGEgZnJ1aXQgc2FsYWQuIC0gTWlsZXMgS2luZ3RvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdCeSBhbGwgbWVhbnMsIG1hcnJ5LiBJZiB5b3UgZ2V0IGEgZ29vZCB3aWZlLCB5b3XigJlsbCBiZWNvbWUgaGFwcHk7IGlmIHlvdSBnZXQgYSBiYWQgb25lLCB5b3XigJlsbCBiZWNvbWUgYSBwaGlsb3NvcGhlci4gLSBTb2NyYXRlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdUaGUgYmVzdCB3YXkgdG8gbGllIGlzIHRvIHRlbGwgdGhlIHRydXRoIC4gLiAuIGNhcmVmdWxseSBlZGl0ZWQgdHJ1dGguIC0gQW5vbnltb3VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lmIHlvdSBzdGVhbCBmcm9tIG9uZSBhdXRob3IsIGl04oCZcyBwbGFnaWFyaXNtOyBpZiB5b3Ugc3RlYWwgZnJvbSBtYW55LCBpdOKAmXMgcmVzZWFyY2guIC0gV2lsc29uIE1pem5lcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdJZiBldm9sdXRpb24gcmVhbGx5IHdvcmtzLCBob3cgY29tZSBtb3RoZXJzIG9ubHkgaGF2ZSB0d28gaGFuZHM/IC0gTWlsdG9uIEJlcmxlJ107XG4gICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjYpO1xuICAgICAgICBtZXNzYWdlRGF0YSA9IHtcbiAgICAgICAgICByZWNpcGllbnQ6IHtcbiAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgdGV4dDogZnVubnlRdW90ZXNbaV0gKyBcIlxcblNvcnJ5IGZvciBub3QgdW5kZXJzdGFuZGluZyB5b3UuIEJ1dCBhYm92ZSBpcyBhIGZ1bm55IHF1b3RlXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKG1lc3NhZ2VEYXRhLm1lc3NhZ2UudGV4dCkgY2FsbFNlbmRBUEkobWVzc2FnZURhdGEpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNlbmRXZWxjb21lTWVzc2FnZShzZW5kZXJJZCwgbmFtZSkge1xuICB2YXIgbWVzc2FnZURhdGEgPSB7XG4gICAgcmVjaXBpZW50OiB7XG4gICAgICBpZDogc2VuZGVySWRcbiAgICB9LFxuICAgIG1lc3NhZ2U6IHtcbiAgICAgIHRleHQ6IFwiV2VsY29tZSBhYm9hcmQgXCIgKyBuYW1lICsgXCIhIE15IG5hbWUgaXMgQm9iLiBSaWdodCBub3cgSSdtIGdvbm5hIHdhbGsgeW91IHRocm91Z2ggdGhlIGJhc2ljIHN0ZXBzLlxcblwiICtcbiAgICAgIFwiVG8gdGFsayB0byBtZSwgeW91IGRvbid0IGhhdmUgdG8gc2F5IGV4YWN0IGNvbW1hbmRzIGV2ZXJ5dGltZS4gRm9yIGV4YW1wbGU6XFxuXCIgKyBcbiAgICAgIFwiLSBTZXQgdXAgbmV3IHJlbWluZGVyczogJ0kgd2FudCB0byBtYWtlL2NyZWF0ZS9oYXZlIG5ldyByZW1pbmRlcidcXG5cIiArIFxuICAgICAgXCItIFJldHJpZXZlIHRoZSBuZXh0IHJlbWluZGVyOiAnSSB3YW50IHRvIHNlZSB0aGUgbmV4dC91cGNvbWluZy9mb2xsb3dpbmcgcmVtaW5kZXInXFxuXCIgKyBcbiAgICAgIFwiLSBSZXRyaWV2ZSB0aGUgbGlzdCBvZiByZW1pbmRlcnM6ICdJIHdhbnQgdG8gbGlzdC9zaG93L2dldCBhbGwgcmVtaW5kZXJzJ1xcbmFuZCBtYW55IG1vcmUuLi5cIlxuICAgIH1cbiAgfTtcblxuICBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSk7XG59XG5cbi8vU2VuZCB0aGUgbWVzc2FnZSB3aGVuIHRoZSB1c2VyIHVzZSAnaGVscCcgY29tbWFuZFxuZnVuY3Rpb24gc2VuZEhlbHBNZXNzYWdlKHNlbmRlcklkKSB7XG4gIHZhciBtZXNzYWdlRGF0YSA9IHtcbiAgICByZWNpcGllbnQ6IHtcbiAgICAgIGlkOiBzZW5kZXJJZFxuICAgIH0sXG4gICAgbWVzc2FnZToge1xuICAgICAgdGV4dDogXCItIFNldCB1cCBuZXcgcmVtaW5kZXJzOiAnSSB3YW50IHRvIG1ha2UvY3JlYXRlL2hhdmUgbmV3IHJlbWluZGVyJ1xcblwiICsgXG4gICAgICBcIi0gUmV0cmlldmUgdGhlIG5leHQgcmVtaW5kZXI6ICdJIHdhbnQgdG8gc2VlIHRoZSBuZXh0L3VwY29taW5nL2ZvbGxvd2luZyByZW1pbmRlcidcXG5cIiArIFxuICAgICAgXCItIFJldHJpZXZlIHRoZSBsaXN0IG9mIHJlbWluZGVyczogJ0kgd2FudCB0byBsaXN0L3Nob3cvZ2V0IGFsbCByZW1pbmRlcnMnXFxuXCIgKyBcbiAgICAgIFwiLSBEZWxldGUgYSByZW1pbmRlcjogJ0kgd2FudCB0byByZW1vdmUvZGVsZXRlL2Rlc3Ryb3knIFtpbmRleF0gKGluZGV4IGlzIHRoZSBpbmRleCBudW1iZXIgb2YgdGhlIHJlbWluZGVyIGluIHRoZSBsaXN0IG9mIHJlbWluZGVycylcXG5cIiArXG4gICAgICBcIi0gSGVscDogJ2hlbHAvaW5zdHJ1Y3Rpb24vY29tbWFuZCdcIlxuICAgIH1cbiAgfTtcblxuICBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSk7XG59XG5cblxuZnVuY3Rpb24gZ2V0QXR0YWNobWVudChzZW5kZXJJRCwgdXJsLCBmaWxlVHlwZSwgbWVzc2FnZSl7XG4gIHVybCA9IHVybC5yZXBsYWNlKC8mL2csICclMjYnKTtcbiAgdmFyIHVybFJlcSA9IFwiaHR0cHM6Ly9wcm9qZWN0MS1taW5odHJpMTI5Ni5jOXVzZXJzLmlvL3Rlc3Q/dXJsPVwiK3VybCtcIiZ0eXBlPVwiK2ZpbGVUeXBlK1wiJnVzZXJpZD1cIitzZW5kZXJJRDtcbiAgY29uc29sZS5sb2codXJsUmVxKTtcbiAgcmVxdWVzdCh7XG4gICAgdXJpOiB1cmxSZXEsXG4gICAgbWV0aG9kOiAnR0VUJ1xuICB9LCBmdW5jdGlvbihlcnJvciwgcmVzcG9uc2UsIGJvZHkpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRE9ORSFcIik7XG4gIH0pXG59XG5cbmZ1bmN0aW9uIGNvdW50QXR0YWNobWVudChzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJBdHRhY2htZW50c1wiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe1widXNlcmlkXCI6IHNlbmRlcklEfSkuY291bnQoZnVuY3Rpb24oZXJyLCByZXN1bHQpe1xuICAgICAgY29uc29sZS5sb2coY291bnQpO1xuICAgICAgdmFyIGNvdW50ID0gcmVzdWx0O1xuICAgIH0pO1xuICB9KVxufVxuXG5mdW5jdGlvbiBjYWxsU2VuZEFQSShtZXNzYWdlRGF0YSkge1xuICByZXF1ZXN0KHtcbiAgICB1cmk6ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92Mi42L21lL21lc3NhZ2VzJyxcbiAgICBxczogeyBhY2Nlc3NfdG9rZW46IHByb2Nlc3MuZW52LlBBR0VfQUNDRVNTX1RPS0VOIH0sXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAganNvbjogbWVzc2FnZURhdGFcblxuICB9LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgaWYgKCFlcnJvciAmJiByZXNwb25zZS5zdGF0dXNDb2RlID09IDIwMCkge1xuICAgICAgdmFyIHJlY2lwaWVudElkID0gYm9keS5yZWNpcGllbnRfaWQ7XG4gICAgICB2YXIgbWVzc2FnZUlkID0gYm9keS5tZXNzYWdlX2lkO1xuXG4gICAgICAvL2NvbnNvbGUubG9nKFwiU3VjY2Vzc2Z1bGx5IHNlbnQgZ2VuZXJpYyBtZXNzYWdlIHdpdGggaWQgJXMgdG8gcmVjaXBpZW50ICVzXCIsIG1lc3NhZ2VJZCwgcmVjaXBpZW50SWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICBjb25zb2xlLmVycm9yKHJlc3BvbnNlKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfSk7ICBcbn1cblxuXG4vL0dldCB0aGUgVXNlciBQcm9maWxlIEFQSVxuZnVuY3Rpb24gY2FsbFVzZXJQcm9maWxlQVBJKHNlbmRlcklELCBjYil7XG4gIHJlcXVlc3Qoe1xuICAgIHVyaTogJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YyLjYvJyArIHNlbmRlcklEICsgJz9maWVsZHM9Zmlyc3RfbmFtZSxsYXN0X25hbWUsdGltZXpvbmUmYWNjZXNzX3Rva2VuPScgKyBwcm9jZXNzLmVudi5QQUdFX0FDQ0VTU19UT0tFTixcbiAgICBtZXRob2Q6ICdHRVQnXG4gIH0sIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSwgYm9keSkge1xuICAgIGlmICghZXJyb3IgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9PSAyMDApIHtcbiAgICAgIGJvZHkgPSBKU09OLnBhcnNlKGJvZHkpO1xuICAgICAgdXNlck5hbWUgPSBib2R5LmZpcnN0X25hbWUgKyBcIiBcIiArIGJvZHkubGFzdF9uYW1lO1xuICAgICAgY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCB0aGUgbmFtZSBcIiArIGJvZHkuZmlyc3RfbmFtZSArIFwiIFwiICsgYm9keS5sYXN0X25hbWUpO1xuICAgICAgaWYoY2IpIGNiKGJvZHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIHNlbmQgbWVzc2FnZS5cIik7XG4gICAgICAvL2NvbnNvbGUuZXJyb3IocmVzcG9uc2UpO1xuICAgICAgLy9jb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuXG5cbmZ1bmN0aW9uIG5ld1JlbWluZGVyKHNlbmRlcklELCBtZXNzRGF0YSl7XG4gIHZhciByZXNwb25kVGV4dDtcbiAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcImNvdW50ZXJcIiwgZnVuY3Rpb24oY291bnRlcil7XG4gICAgZ2V0UHJvcGVydHkoc2VuZGVySUQsIFwiVXNlclwiLCBcInJlbWluZGVyXCIsIGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJ0aW1lem9uZVwiLCBmdW5jdGlvbih0aW1lem9uZSl7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvdW50ZXIpO1xuICAgICAgICBpZiAoY291bnRlciA9PSAwKXtcbiAgICAgICAgICByZW1pbmRlci51c2VyaWQgPSBzZW5kZXJJRDtcbiAgICAgICAgICByZW1pbmRlci5jb250ZW50ID0gbWVzc0RhdGE7XG4gICAgICAgICAgaW5jcmVtZW50Q291bnRlcihzZW5kZXJJRCk7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiV2hlbj8gKG1tL2RkL3l5LWhoOm1tKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvdW50ZXIgPT0gMSl7XG4gICAgICAgICAgdmFyIHBhcnRzID0gIG1lc3NEYXRhO1xuICAgICAgICAgIHJlbWluZGVyLmRhdGUgPSBuZXcgRGF0ZSgyMCtwYXJ0cy5zdWJzdHIoNiwyKSxOdW1iZXIocGFydHMuc3Vic3RyKDAsMikpLTEscGFydHMuc3Vic3RyKDMsMiksIE51bWJlcihwYXJ0cy5zdWJzdHIoOSwyKSkscGFydHMuc3Vic3RyKDEyLDIpKTtcbiAgICAgICAgICB2YXIgdGV4dCA9IGNoZWNrRGF0ZShyZW1pbmRlci5kYXRlLCBwYXJ0cywgdGltZXpvbmUpO1xuICAgICAgICAgIGlmICh0ZXh0ID09IFwiRG8geW91IHdhbnQgYWRkIG1vcmUgaW5mb3JtYXRpb24/IChZIGZvciB5ZXMsIE4gZm9yIE5vKVwiKSBpbmNyZW1lbnRDb3VudGVyKHNlbmRlcklEKTtcbiAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGNvdW50ZXIgPT0gMil7XG4gICAgICAgICAgaWYobWVzc0RhdGEgIT09IFwiWVwiICYmIG1lc3NEYXRhICE9PSBcIk5cIil7XG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJJbnZhbGlkIGNoYXJhY3RlciwgdHlwZSBhZ2FpbiAoWS9OKS5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZihtZXNzRGF0YSA9PSBcIk5cIil7XG4gICAgICAgICAgICBmbGlwQ3JlYXRpbmcoZmFsc2UsIHNlbmRlcklEKTtcbiAgICAgICAgICAgIHJlbWluZGVyLmRhdGUuc2V0SG91cnMocmVtaW5kZXIuZGF0ZS5nZXRIb3VycygpLXRpbWV6b25lKTtcbiAgICAgICAgICAgIGFkZERCKFwiUmVtaW5kZXJcIiwgcmVtaW5kZXIsIHNlbmRlcklELCBmdW5jdGlvbihkb2Mpe1xuICAgICAgICAgICAgICB2YXIgZG9jID0gZG9jLm9wc1swXTtcbiAgICAgICAgICAgICAgc2NoZWR1bGUuc2NoZWR1bGVKb2IoZG9jLmRhdGUsIGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICAgIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiUmVtaW5kZXJcIik7XG4gICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmZpbmQoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICAgICAgICAgICAgICAgICAgaWYoZG9jcy5sZW5ndGggIT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJIZXJlIGlzIHNvbWV0aGluZyB5b3UgbmVlZCB0byBkbzogXCIgKyB4LmNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnJlbW92ZSh7XCJfaWRcIjogT2JqZWN0SWQoZG9jLl9pZCl9KTtcbiAgICAgICAgICAgICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfS5iaW5kKG51bGwsIGRvYykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgdGV4dDogXCJFdmVudCBhZGRlZCBzdWNjZXNzZnVsbHkhXCJcbiAgICAgICAgICAgIH07ICAgICAgICAgICAgXG4gICAgICAgICAgICByZXBsYWNlQ291bnRlcigwICxzZW5kZXJJRCk7XG4gICAgICAgICAgICByZW1pbmRlciA9IHt9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiV2hhdCBpcyB0aGUgbG9jYXRpb24/IFR5cGUgc2tpcCBpZiBub25lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07ICBcbiAgICAgICAgICAgIGluY3JlbWVudENvdW50ZXIoc2VuZGVySUQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGNvdW50ZXIgPT0gMyl7XG4gICAgICAgICAgaWYobWVzc0RhdGEgIT0gXCJza2lwXCIpIHtcbiAgICAgICAgICAgIC8vcmVtaW5kZXIubG9jYXRpb24gPSBtZXNzYWdlVGV4dDtcbiAgICAgICAgICAgIHZhciBwbGFjZXMgPSBnZXRMb2NhdGlvbihtZXNzRGF0YSk7XG4gICAgICAgICAgICB2YXIgbG9uZywgbGF0O1xuICAgICAgICAgICAgdmFyIGJ1dHRvbnMgPSBbXTtcbiAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpPE1hdGgubWluKDMsIHBsYWNlcy5sZW5ndGgpOyBpKyspe1xuICAgICAgICAgICAgICB2YXIgYnV0dG9uID0ge3R5cGU6XCJwb3N0YmFja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOnBsYWNlc1tpXVsnbmFtZSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KHBsYWNlc1tpXSl9XG4gICAgICAgICAgICAgIGJ1dHRvbnMucHVzaChidXR0b24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXNwb25kVGV4dCA9IHtcbiAgICAgICAgICAgICAgYXR0YWNobWVudDp7XG4gICAgICAgICAgICAgICAgdHlwZTpcInRlbXBsYXRlXCIsXG4gICAgICAgICAgICAgICAgcGF5bG9hZDp7XG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZV90eXBlOlwiYnV0dG9uXCIsXG4gICAgICAgICAgICAgICAgICB0ZXh0OlwiQ2hvb3NlIGEgbG9jYXRpb246IFwiLFxuICAgICAgICAgICAgICAgICAgYnV0dG9uczogYnV0dG9uc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTsgIFxuICAgICAgICAgICAgLy9yZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyA9IGJ1dHRvbnM7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGJ1dHRvbnMpO1xuICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjpyZXNwb25kVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHR5cGVvZiByZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25kVGV4dC5hdHRhY2htZW50LnBheWxvYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25kVGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiQXR0YWNoIGFueSBmaWxlcy4gVHlwZSBza2lwIG9mIG5vbmVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTsgIFxuICAgICAgICAgICAgaW5jcmVtZW50Q291bnRlcihzZW5kZXJJRCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIFxuICAgICAgICAgIC8vcmVzcG9uZFRleHQgPSBcIkF0dGFjaCBhbnkgZmlsZXMuIFR5cGUgc2tpcCBvZiBub25lXCI7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvdW50ZXIgPT0gNCl7XG4gICAgICAgICAgY29uc29sZS5sb2cocmVtaW5kZXIpO1xuICAgICAgICAgIHJlbWluZGVyLmF0dGFjaG1lbnQgPSB7dXJsOiBcIlwiLCB0eXBlOiBcIlwifVxuICAgICAgICAgIGlmIChtZXNzRGF0YVswXS50eXBlKXtcbiAgICAgICAgICAgIGdldEF0dGFjaG1lbnQoc2VuZGVySUQsIG1lc3NEYXRhWzBdLnBheWxvYWQudXJsLCBtZXNzRGF0YVswXS50eXBlLCBcIkF0dGFjaG1lbnRcIik7XG4gICAgICAgICAgICAvL0xhdGVyIHdpbGwgY2hlY2sgZm9yIHRvdGFsIGVsZW1lbnQgaW4gZGF0YWJhc2UgZmlsZXNcbiAgICAgICAgICAgIHJlbWluZGVyLmF0dGFjaG1lbnQgPSB7dXJsOiBcImh0dHBzOi8vcHJldmlldy5jOXVzZXJzLmlvL21pbmh0cmkxMjk2L3Byb2plY3QxL2ZpbGUtdXBsb2FkL3Rlc3QucG5nXCIsIHR5cGU6IG1lc3NEYXRhWzBdLnR5cGV9O1xuICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgLy9hZGREQihcIlJlbWluZGVyXCIsIHJlbWluZGVyLCBzZW5kZXJJRCk7XG4gICAgICAgICAgcmVzcG9uZFRleHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiRmluc2hlZCBjcmVhdGluZyByZW1pbmRlci5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTsgICAgICAgICAgICBcbiAgICAgICAgICBmbGlwQ3JlYXRpbmcoZmFsc2UsIHNlbmRlcklEKTtcbiAgICAgICAgICByZXBsYWNlQ291bnRlcigwLHNlbmRlcklEKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlN1Y2Nlc3MhXCIpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHJlbWluZGVyKTtcbiAgICAgICAgICByZW1pbmRlci5kYXRlLnNldEhvdXJzKHJlbWluZGVyLmRhdGUuZ2V0SG91cnMoKS10aW1lem9uZSk7XG4gICAgICAgICAgYWRkREIoXCJSZW1pbmRlclwiLCByZW1pbmRlciwgc2VuZGVySUQsIGZ1bmN0aW9uKGRvYyl7XG4gICAgICAgICAgICB2YXIgZG9jID0gZG9jLm9wc1swXTtcbiAgICAgICAgICAgIHNjaGVkdWxlLnNjaGVkdWxlSm9iKHJlbWluZGVyLmRhdGUsIGZ1bmN0aW9uKHgpe1xuICAgICAgICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiUmVtaW5kZXJcIik7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5maW5kKHtcIl9pZFwiOiBPYmplY3RJZChkb2MuX2lkKX0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKXtcbiAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHRocm93IGVyclxuICAgICAgICAgICAgICAgICAgaWYoZG9jcy5sZW5ndGggIT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZW1pbmRlci5hdHRhY2htZW50KXsgIFxuICAgICAgICAgICAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXR0YWNobWVudFwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogcmVtaW5kZXIuYXR0YWNobWVudC50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGF5bG9hZFwiOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IHJlbWluZGVyLmF0dGFjaG1lbnQudXJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlbWluZGVyLmxvY2F0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBKU09OLnBhcnNlKHJlbWluZGVyLmxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgY2FsbFNlbmRBUEkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZW5kZXJJRFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhdHRhY2htZW50XCI6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOlwidGVtcGxhdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBheWxvYWRcIjp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRlbXBsYXRlX3R5cGVcIjpcImdlbmVyaWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZWxlbWVudHNcIjpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBsb2NhdGlvbi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImltYWdlX3VybFwiOlwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3N0YXRpY21hcD9jZW50ZXI9XCIrbG9jYXRpb24ubGF0aXR1ZGUrXCIsXCIrbG9jYXRpb24ubG9uZ2l0dWRlK1wiJnpvb209MTUmc2l6ZT02MDB4MzAwJm1hcHR5cGU9cm9hZG1hcCZtYXJrZXJzPWNvbG9yOnJlZHxcIitsb2NhdGlvbi5sYXRpdHVkZStcIixcIitsb2NhdGlvbi5sb25naXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJ0aXRsZVwiOiBcIkhlcmUgaXMgc29tZXRoaW5nIHlvdSBuZWVkIHRvIGRvIGF0IHRoaXMgbG9jYXRpb246IFxcXCJcIiArIHJlbWluZGVyLmNvbnRlbnQgKyBcIlxcXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJ1dHRvbnNcIjpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOlwid2ViX3VybFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOlwiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYXBzL3BsYWNlL1wiK2xvY2F0aW9uLm5hbWUrXCIvQFwiK2xvY2F0aW9uLmxhdGl0dWRlK1wiLFwiK2xvY2F0aW9uLmxvbmdpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOlwiZ28gdG8gR29vZ2xlIE1hcFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5yZW1vdmUoe1wiX2lkXCI6IE9iamVjdElkKGRvYy5faWQpfSk7XG4gICAgICAgICAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgIGNhbGxTZW5kQVBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2VuZGVySURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiSGVyZSBpcyBzb21ldGhpbmcgeW91IG5lZWQgdG8gZG86IFwiICsgcmVtaW5kZXIuY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucmVtb3ZlKHtcIl9pZFwiOiBPYmplY3RJZChkb2MuX2lkKX0pO1xuICAgICAgICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LmJpbmQobnVsbCwgZG9jKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lc3NhZ2VEYXRhID0ge1xuICAgICAgICAgIHJlY2lwaWVudDoge1xuICAgICAgICAgICAgaWQ6IHNlbmRlcklEXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXNzYWdlOiByZXNwb25kVGV4dFxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhcInRlc3RcIik7XG4gICAgICAgIGNhbGxTZW5kQVBJKG1lc3NhZ2VEYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coY291bnRlcik7XG4gICAgICAgIGNoYW5nZVJlbWluZGVyKHNlbmRlcklELCByZW1pbmRlcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG5cblxuLy8gU2V0IEV4cHJlc3MgdG8gbGlzdGVuIG91dCBmb3IgSFRUUCByZXF1ZXN0c1xudmFyIHNlcnZlciA9IGFwcC5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnNvbGUubG9nKFwiTGlzdGVuaW5nIG9uIHBvcnQgJXNcIiwgc2VydmVyLmFkZHJlc3MoKS5wb3J0KTtcbn0pO1xuIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "bot.js"
      ],
      "names": [
        "ObjectId",
        "require",
        "ObjectID",
        "schedule",
        "watson",
        "mongodb",
        "express",
        "bodyParser",
        "request",
        "path",
        "http",
        "fs",
        "messengerButton",
        "userName",
        "conversation",
        "username",
        "password",
        "version",
        "version_date",
        "context",
        "app",
        "use",
        "json",
        "urlencoded",
        "extended",
        "MongoClient",
        "url1",
        "get",
        "req",
        "res",
        "query",
        "process",
        "env",
        "VERIFY_TOKEN",
        "console",
        "log",
        "status",
        "send",
        "error",
        "sendStatus",
        "writeHead",
        "write",
        "end",
        "post",
        "data",
        "body",
        "object",
        "entry",
        "forEach",
        "pageID",
        "id",
        "timeOfEvent",
        "time",
        "messaging",
        "event",
        "callUserProfileAPI",
        "sender",
        "userData",
        "userid",
        "counter",
        "keywords",
        "creating",
        "reminder",
        "timezone",
        "collection",
        "message",
        "receivedMessage",
        "postback",
        "receivedPostback",
        "senderID",
        "recipientID",
        "recipient",
        "timeOfMessage",
        "timestamp",
        "messageId",
        "mid",
        "messageText",
        "text",
        "messageAttachments",
        "attachments",
        "p",
        "newReminder",
        "sendTextMessage",
        "getAttachment",
        "payload",
        "url",
        "type",
        "timeOfPostback",
        "name",
        "fist_name",
        "sendWelcomeMessage",
        "location",
        "JSON",
        "parse",
        "messageData",
        "callSendAPI",
        "workspace_id",
        "input",
        "err",
        "response",
        "intents",
        "command",
        "intent",
        "respond",
        "str",
        "options",
        "weekday",
        "year",
        "month",
        "day",
        "content",
        "date",
        "toLocaleTimeString",
        "sendHelpMessage",
        "list",
        "index",
        "Number",
        "substr",
        "length",
        "_id",
        "connect",
        "db",
        "remove",
        "doc",
        "funnyQuotes",
        "i",
        "Math",
        "floor",
        "random",
        "senderId",
        "fileType",
        "replace",
        "urlReq",
        "uri",
        "method",
        "countAttachment",
        "find",
        "count",
        "result",
        "qs",
        "access_token",
        "PAGE_ACCESS_TOKEN",
        "statusCode",
        "recipientId",
        "recipient_id",
        "message_id",
        "cb",
        "first_name",
        "last_name",
        "messData",
        "respondText",
        "parts",
        "Date",
        "setHours",
        "getHours",
        "ops",
        "scheduleJob",
        "x",
        "toArray",
        "docs",
        "close",
        "bind",
        "places",
        "long",
        "lat",
        "buttons",
        "min",
        "button",
        "title",
        "stringify",
        "push",
        "attachment",
        "template_type",
        "latitude",
        "longitude",
        "server",
        "listen",
        "PORT",
        "address",
        "port"
      ],
      "mappings": "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",
      "file": "bot.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "//\n// This is main file containing code implementing the Express server and functionality for the Express echo bot.\n//\n'use strict';\nconst ObjectId = require('mongodb').ObjectID;\nconst schedule = require('node-schedule');\nconst watson = require('watson-developer-cloud');\nconst mongodb = require(\"mongodb\")\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst request = require('request');\nconst path = require('path');\nimport {getSortedList, incrementCounter, replaceCounter, flipCreating, \n        addDB, getDB, changeReminder, getProperty, getList} from './dbUtil';\nimport {nextReminder, checkDate, containsObject, list, getLocation} from './Util.js';\nvar http = require('https');\nvar fs = require('fs');\n\nvar messengerButton = \"<html><head><title>Facebook Messenger Bot</title></head><body><h1>Facebook Messenger Bot</h1>This is a bot based on Messenger Platform QuickStart. For more details, see their <a href=\\\"https://developers.facebook.com/docs/messenger-platform/guides/quick-start\\\">docs</a>.<footer id=\\\"gWidget\\\"></footer><script src=\\\"https://widget.glitch.me/widget.min.js\\\"></script></body></html>\";\n//User's data\nvar userName = \"test\";\n// Watson data\nvar conversation = watson.conversation({\n  username: 'a162acb8-d510-4c1e-8e81-aa514ee3b769',\n  password: 'kWC4xmdWiQ8Z',\n  version: 'v1',\n  version_date: '2017-02-03'\n});\nvar context = {};\n// The rest of the code implements the routes for our Express server.\nlet app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\n// database config\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\n// Webhook validation\napp.get('/webhook', function(req, res) {\n  if (req.query['hub.mode'] === 'subscribe' &&\n      req.query['hub.verify_token'] === process.env.VERIFY_TOKEN) {\n    console.log(\"Validating webhook\");\n    res.status(200).send(req.query['hub.challenge']);\n  } else {\n    console.error(\"Failed validation. Make sure the validation tokens match.\");\n    res.sendStatus(403);          \n  }\n});\n\n// Display the web page\napp.get('/', function(req, res) {\n  res.writeHead(200, {'Content-Type': 'text/html'});\n  res.write(messengerButton);\n  res.end();\n});\n\n// Message processing\napp.post('/webhook', function (req, res) {\n  var data = req.body;\n  if (data.object === 'page') {    \n    // Iterate over each entry - there may be multiple if batched\n    data.entry.forEach(function(entry) {\n      var pageID = entry.id;\n      var timeOfEvent = entry.time;\n      // Iterate over each messaging event\n      entry.messaging.forEach(function(event) {\n        callUserProfileAPI(event.sender.id, function(body){\n          var userData = {userid: event.sender.id, counter: 0, keywords: [], creating: false, reminder: {}, timezone: body.timezone};\n          getDB(\"User\", function(collection){\n            if(!containsObject(event.sender.id, collection)){\n              addDB(\"User\", userData, event.sender.id);              \n            }\n            if (event.message) {\n              receivedMessage(event); \n            } else if (event.postback) {\n              receivedPostback(event); \n            } else {\n              console.log(\"Webhook received unknown event: \", event);\n            }\n          });\n        });\n        \n      });\n    });\n\n    // Assume all went well.\n    //\n    // You must send back a 200, within 20 seconds, to let us know\n    // you've successfully received the callback. Otherwise, the request\n    // will time out and we will keep trying to resend.\n    res.sendStatus(200);\n  }\n});\n\nfunction receivedMessage(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfMessage = event.timestamp;\n  var message = event.message;\n\n  console.log(\"Received message for user %d and page %d at %d with message:\", \n    senderID, recipientID, timeOfMessage);\n\n  var messageId = message.mid;\n\n  var messageText = message.text;\n  var messageAttachments = message.attachments;\n  \n  if (messageText) {\n    getProperty(senderID, \"User\", \"creating\", function(p){\n      if(p) newReminder(senderID, messageText);\n      else{\n        switch (messageText) {\n          //Cases where the text doesn't have to go through BlueMix API (Nothing right now)\n          // case 'generic':\n          //   sendGenericMessage(senderID);\n          //   break;\n          default:\n            sendTextMessage(senderID, messageText);\n        }\n      }\n    });\n  }\n  if (messageAttachments) {\n      getProperty(senderID, \"User\", \"creating\", function(p){\n        if(p) newReminder(senderID, messageAttachments);\n        else getAttachment(senderID, messageAttachments[0].payload.url, messageAttachments[0].type,\"Attachment\");\n      })      \n  }\n}\n\nfunction receivedPostback(event) {\n  var senderID = event.sender.id;\n  var recipientID = event.recipient.id;\n  var timeOfPostback = event.timestamp;\n\n  // The 'payload' param is a developer-defined field which is set in a postback \n  // button for Structured Messages. \n  var payload = event.postback.payload;\n\n  console.log(\"Received postback for user %d and page %d with payload '%s' \" + \n    \"at %d\", senderID, recipientID, payload, timeOfPostback);\n\n  // When a postback is called, we'll send a message back to the sender to \n  // let them know it was successful\n  \n  //Do Something after users clicked Get Started button \n  if(event.postback.payload === \"GET_STARTED_PAYLOAD\"){\n    callUserProfileAPI(senderID, function(body){\n      console.log(body);\n      var name = body.fist_name + \" \" + body.fist_name;\n      sendWelcomeMessage(senderID, userName);\n    })\n    \n  }\n  else{\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      console.log(reminder);\n      reminder.location = payload;\n      var data = JSON.parse(payload);\n      //console.log(payload);\n      var messageData = {\n        recipient: {\n          id: senderID\n        },\n        message: {\n          text: \"Attach any files. Type skip if none\"\n        }\n      };\n      changeReminder(senderID, reminder);\n      incrementCounter(senderID);\n      callSendAPI(messageData);\n    });\n  }\n}\n\n//////////////////////////\n// Sending helpers\n//////////////////////////\nfunction sendTextMessage(senderID, messageText) {\n  conversation.message({\n    workspace_id: '1e7573f5-939d-47e3-8690-5ef1c0946b63',\n    input: {'text': messageText},\n    context: context\n  },  function(err, response) {\n    if (err)\n      console.log('error:', err);\n    else{\n      \n      var messageData;\n      if(response.intents[0]){\n        var command = response.intents[0].intent;\n        var respond = \"\";\n        switch (command) {\n        case 'list':\n          list(senderID, function(str){\n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: str\n              }\n            });\n          });\n        break;\n        case 'next':\n          nextReminder(senderID, function(str){\n            var options = { weekday: \"long\", year: \"numeric\", month: \"short\",  \n              day: \"numeric\" };  \n            callSendAPI({\n              recipient: {\n                id: senderID\n              },\n              message: {\n                text: \"Here is something you need to do: \" + str.content + \" after \" + str.date.toLocaleTimeString(\"en-US\", options)\n              }\n            });\n          });\n        break;\n        case 'create':\n          respond = \"What do you want to remind about?\";\n          flipCreating(true, senderID);\n        break;\n        case 'help':                      \n          sendHelpMessage(senderID);          \n        break;\n        case 'delete':\n            getSortedList(senderID, \"Reminder\", function(list){\n              var index = Number(messageText.substr(messageText.length-1, 1))-1;\n              if(index >= 0 && index < list.length){\n                var id = list[index]._id;\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.remove({\"_id\": ObjectId(id)}, function(err, doc){\n                    callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      message: {\n                        text: \"deleted \" + list[index].content\n                      }\n                    });\n                  });\n                });\n              }\n            });\n        break;\n          case 'hi':\n            respond = \"Hello\";\n            break;\n          case 'thx':\n            respond = \"You're welcome\";\n            break;\n          case 'bye':\n            respond = \"Good bye!\";\n            break;\n          case 'who':\n            respond = \"My name is Bob\";\n            break;\n        default:\n          respond = command;\n        };\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: respond\n          }\n        }\n      }\n      else{\n        var funnyQuotes = ['\"How do you get a sweet little 80-year-old lady to say the F word? Get another sweet little 80-year-old lady to yell \"BINGO!\" - Anonymous',\n                          'Knowledge is knowing a tomato is a fruit; wisdom is not putting it in a fruit salad. - Miles Kington',\n                          'By all means, marry. If you get a good wife, you’ll become happy; if you get a bad one, you’ll become a philosopher. - Socrates',\n                          'The best way to lie is to tell the truth . . . carefully edited truth. - Anonymous',\n                          'If you steal from one author, it’s plagiarism; if you steal from many, it’s research. - Wilson Mizner',\n                          'If evolution really works, how come mothers only have two hands? - Milton Berle'];\n        var i = Math.floor(Math.random()*6);\n        messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: {\n            text: funnyQuotes[i] + \"\\nSorry for not understanding you. But above is a funny quote\"\n          }\n        }\n      }\n      if(messageData.message.text) callSendAPI(messageData);\n    }\n  });\n}\n\nfunction sendWelcomeMessage(senderId, name) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"Welcome aboard \" + name + \"! My name is Bob. Right now I'm gonna walk you through the basic steps.\\n\" +\n      \"To talk to me, you don't have to say exact commands everytime. For example:\\n\" + \n      \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\nand many more...\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n//Send the message when the user use 'help' command\nfunction sendHelpMessage(senderId) {\n  var messageData = {\n    recipient: {\n      id: senderId\n    },\n    message: {\n      text: \"- Set up new reminders: 'I want to make/create/have new reminder'\\n\" + \n      \"- Retrieve the next reminder: 'I want to see the next/upcoming/following reminder'\\n\" + \n      \"- Retrieve the list of reminders: 'I want to list/show/get all reminders'\\n\" + \n      \"- Delete a reminder: 'I want to remove/delete/destroy' [index] (index is the index number of the reminder in the list of reminders)\\n\" +\n      \"- Help: 'help/instruction/command'\"\n    }\n  };\n\n  callSendAPI(messageData);\n}\n\n\nfunction getAttachment(senderID, url, fileType, message){\n  url = url.replace(/&/g, '%26');\n  var urlReq = \"https://project1-minhtri1296.c9users.io/test?url=\"+url+\"&type=\"+fileType+\"&userid=\"+senderID;\n  console.log(urlReq);\n  request({\n    uri: urlReq,\n    method: 'GET'\n  }, function(error, response, body) {\n      console.log(\"DONE!\");\n  })\n}\n\nfunction countAttachment(senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"Attachments\");\n    collection.find({\"userid\": senderID}).count(function(err, result){\n      console.log(count);\n      var count = result;\n    });\n  })\n}\n\nfunction callSendAPI(messageData) {\n  request({\n    uri: 'https://graph.facebook.com/v2.6/me/messages',\n    qs: { access_token: process.env.PAGE_ACCESS_TOKEN },\n    method: 'POST',\n    json: messageData\n\n  }, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n      var recipientId = body.recipient_id;\n      var messageId = body.message_id;\n\n      //console.log(\"Successfully sent generic message with id %s to recipient %s\", messageId, recipientId);\n    } else {\n      console.error(\"Unable to send message.\");\n      console.error(response);\n      console.error(error);\n    }\n  });  \n}\n\n\n//Get the User Profile API\nfunction callUserProfileAPI(senderID, cb){\n  request({\n    uri: 'https://graph.facebook.com/v2.6/' + senderID + '?fields=first_name,last_name,timezone&access_token=' + process.env.PAGE_ACCESS_TOKEN,\n    method: 'GET'\n  }, function(error, response, body) {\n    if (!error && response.statusCode == 200) {\n      body = JSON.parse(body);\n      userName = body.first_name + \" \" + body.last_name;\n      console.log(\"Successfully sent generic message with the name \" + body.first_name + \" \" + body.last_name);\n      if(cb) cb(body);\n    } else {\n      console.error(\"Unable to send message.\");\n      //console.error(response);\n      //console.error(error);\n    }\n  });\n}\n\n\nfunction newReminder(senderID, messData){\n  var respondText;\n  getProperty(senderID, \"User\", \"counter\", function(counter){\n    getProperty(senderID, \"User\", \"reminder\", function(reminder){\n      getProperty(senderID, \"User\", \"timezone\", function(timezone){\n        console.log(counter);\n        if (counter == 0){\n          reminder.userid = senderID;\n          reminder.content = messData;\n          incrementCounter(senderID);\n          respondText = {\n                          text: \"When? (mm/dd/yy-hh:mm)\"\n                        };\n        }\n        else if (counter == 1){\n          var parts =  messData;\n          reminder.date = new Date(20+parts.substr(6,2),Number(parts.substr(0,2))-1,parts.substr(3,2), Number(parts.substr(9,2)),parts.substr(12,2));\n          var text = checkDate(reminder.date, parts, timezone);\n          if (text == \"Do you want add more information? (Y for yes, N for No)\") incrementCounter(senderID);\n          respondText = {\n                          text: text\n                        };\n        }\n        else if(counter == 2){\n          if(messData !== \"Y\" && messData !== \"N\"){\n            respondText = {\n                          text: \"Invalid character, type again (Y/N).\"\n                        };\n          }\n          else if(messData == \"N\"){\n            flipCreating(false, senderID);\n            reminder.date.setHours(reminder.date.getHours()-timezone);\n            addDB(\"Reminder\", reminder, senderID, function(doc){\n              var doc = doc.ops[0];\n              schedule.scheduleJob(doc.date, function(x){\n                MongoClient.connect(url1, function (err, db) {\n                  if (err) throw err\n                  var collection = db.collection(\"Reminder\");\n                  collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                    if (err) throw err\n                    if(docs.length != 0){\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + x.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  });\n                });\n              }.bind(null, doc));\n            });\n            respondText = {\n              text: \"Event added successfully!\"\n            };            \n            replaceCounter(0 ,senderID);\n            reminder = {};\n          }\n          else{\n            respondText = {\n                          text: \"What is the location? Type skip if none\"\n                        };  \n            incrementCounter(senderID);\n          }\n        }\n        else if(counter == 3){\n          if(messData != \"skip\") {\n            //reminder.location = messageText;\n            var places = getLocation(messData);\n            var long, lat;\n            var buttons = [];\n            for(var i=0; i<Math.min(3, places.length); i++){\n              var button = {type:\"postback\",\n                            title:places[i]['name'],\n                            payload: JSON.stringify(places[i])}\n              buttons.push(button);\n            }\n\n            respondText = {\n              attachment:{\n                type:\"template\",\n                payload:{\n                  template_type:\"button\",\n                  text:\"Choose a location: \",\n                  buttons: buttons\n                }\n              }\n            };  \n            //respondText.attachment.payload.buttons = buttons;\n\n            console.log(buttons);\n            callSendAPI({\n                      recipient: {\n                        id: senderID\n                      },\n                      \"message\":respondText\n                        \n          })\n            // console.log(typeof respondText.attachment.payload.buttons);\n            // console.log(respondText.attachment.payload.buttons);\n            // console.log(respondText);\n          }\n          else{\n          respondText = {\n                          text: \"Attach any files. Type skip of none\"\n                        };  \n            incrementCounter(senderID);\n          }\n          \n          \n          //respondText = \"Attach any files. Type skip of none\";\n          return;\n        }\n        else if (counter == 4){\n          console.log(reminder);\n          reminder.attachment = {url: \"\", type: \"\"}\n          if (messData[0].type){\n            getAttachment(senderID, messData[0].payload.url, messData[0].type, \"Attachment\");\n            //Later will check for total element in database files\n            reminder.attachment = {url: \"https://preview.c9users.io/minhtri1296/project1/file-upload/test.png\", type: messData[0].type};\n          }\n                    \n          //addDB(\"Reminder\", reminder, senderID);\n          respondText = {\n                          text: \"Finshed creating reminder.\"\n                        };            \n          flipCreating(false, senderID);\n          replaceCounter(0,senderID);\n          console.log(\"Success!\");\n          console.log(reminder);\n          reminder.date.setHours(reminder.date.getHours()-timezone);\n          addDB(\"Reminder\", reminder, senderID, function(doc){\n            var doc = doc.ops[0];\n            schedule.scheduleJob(reminder.date, function(x){\n              MongoClient.connect(url1, function (err, db) {\n                if (err) throw err\n                var collection = db.collection(\"Reminder\");\n                collection.find({\"_id\": ObjectId(doc._id)}).toArray(function(err, docs){\n                  if (err) throw err\n                  if(docs.length != 0){\n                    if (reminder.attachment){  \n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        \"message\":{\n                          \"attachment\":{\n                            \"type\": reminder.attachment.type,\n                            \"payload\":{\n                              \"url\": reminder.attachment.url\n                            }\n                          }\n                        }\n                      })\n                    }                    \n                    if(reminder.location){\n                      var location = JSON.parse(reminder.location);\n                      console.log(location);\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          \"attachment\":{\n                            \"type\":\"template\",\n                            \"payload\":{\n                              \"template_type\":\"generic\",\n                              \"elements\":[\n                                 {\n                                  \"title\": location.name,\n                                   \"image_url\":\"https://maps.googleapis.com/maps/api/staticmap?center=\"+location.latitude+\",\"+location.longitude+\"&zoom=15&size=600x300&maptype=roadmap&markers=color:red|\"+location.latitude+\",\"+location.longitude,\n                                  \"subtitle\": \"Here is something you need to do at this location: \\\"\" + reminder.content + \"\\\"\",\n                                  \"buttons\":[\n                                    {\n                                      \"type\":\"web_url\",\n                                      \"url\":\"https://www.google.com/maps/place/\"+location.name+\"/@\"+location.latitude+\",\"+location.longitude,\n                                      \"title\":\"go to Google Map\"\n                                    }\n                                  ]      \n                                }\n                              ]\n                            }\n                          }\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                    else{\n                      callSendAPI({\n                        recipient: {\n                          id: senderID\n                        },\n                        message: {\n                          text: \"Here is something you need to do: \" + reminder.content\n                        }\n                      });\n                      collection.remove({\"_id\": ObjectId(doc._id)});\n                      db.close();\n                    }\n                  }\n                });\n              });\n            }.bind(null, doc));\n          });\n        }\n        var messageData = {\n          recipient: {\n            id: senderID\n          },\n          message: respondText\n        };\n        console.log(\"test\");\n        callSendAPI(messageData);\n        console.log(counter);\n        changeReminder(senderID, reminder);\n      });\n    });\n  });\n}\n\n\n// Set Express to listen out for HTTP requests\nvar server = app.listen(process.env.PORT || 3000, function () {\n  console.log(\"Listening on port %s\", server.address().port);\n});\n"
      ]
    },
    "mtime": 1520898426000
  },
  "{\"filename\":\"/app/dbUtil.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/dbUtil.js",
      "filenameRelative": "/app/dbUtil.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "dbUtil.js",
      "sourceFileName": "dbUtil.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "dbUtil"
    },
    "ignored": false,
    "code": "\"use strict\";\n\nvar mongodb = require(\"mongodb\");\nvar MongoClient = mongodb.MongoClient;\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function (senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }, { \"sort\": [\"date\"] }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n};\nexports.incrementCounter = function (senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $inc: { \"counter\": 1 } });\n  });\n};\nexports.replaceCounter = function (value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"counter\": value } });\n  });\n};\nexports.flipCreating = function (value, senderID) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"creating\": value } });\n  });\n};\n//Function for database (#database)\nexports.addDB = function (name, object, senderID, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.insert(object, function (err, docs) {\n      if (err) console.log(err);\n      if (cb) cb(docs);\n      db.close();\n    });\n  });\n};\nexports.getDB = function (name, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(name);\n    collection.find({}, { _id: 0 }).toArray(function (err, docs) {\n      db.close();\n      cb(docs);\n    });\n  });\n};\nexports.changeReminder = function (senderID, value) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({ \"userid\": senderID }, { $set: { \"reminder\": value } });\n  });\n};\nexports.getProperty = function (senderID, collectionName, property, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.findOne({ \"userid\": senderID }, function (err, ret) {\n      cb(ret[property]);\n    });\n  });\n};\nexports.getList = function (senderID, collectionName, cb) {\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err;\n    var collection = db.collection(collectionName);\n    collection.find({ \"userid\": senderID }).toArray(function (err, docs) {\n      cb(docs);\n    });\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiVXRpbC5qcyJdLCJuYW1lcyI6WyJtb25nb2RiIiwicmVxdWlyZSIsIk1vbmdvQ2xpZW50IiwidXJsMSIsImV4cG9ydHMiLCJnZXRTb3J0ZWRMaXN0Iiwic2VuZGVySUQiLCJjb2xsZWN0aW9uTmFtZSIsImNiIiwiY29ubmVjdCIsImVyciIsImRiIiwiY29sbGVjdGlvbiIsImZpbmQiLCJ0b0FycmF5IiwiZG9jcyIsImluY3JlbWVudENvdW50ZXIiLCJmaW5kT25lQW5kVXBkYXRlIiwiJGluYyIsInJlcGxhY2VDb3VudGVyIiwidmFsdWUiLCIkc2V0IiwiZmxpcENyZWF0aW5nIiwiYWRkREIiLCJuYW1lIiwib2JqZWN0IiwiaW5zZXJ0IiwiY29uc29sZSIsImxvZyIsImNsb3NlIiwiZ2V0REIiLCJfaWQiLCJjaGFuZ2VSZW1pbmRlciIsImdldFByb3BlcnR5IiwicHJvcGVydHkiLCJmaW5kT25lIiwicmV0IiwiZ2V0TGlzdCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxVQUFVQyxRQUFRLFNBQVIsQ0FBaEI7QUFDQSxJQUFJQyxjQUFjRixRQUFRRSxXQUExQjtBQUNBLElBQUlDLE9BQU8sb0VBQVg7QUFDQUMsUUFBUUMsYUFBUixHQUF3QixVQUFTQyxRQUFULEVBQW1CQyxjQUFuQixFQUFtQ0MsRUFBbkMsRUFBc0M7QUFDNUROLGNBQVlPLE9BQVosQ0FBb0JOLElBQXBCLEVBQTBCLFVBQVVPLEdBQVYsRUFBZUMsRUFBZixFQUFtQjtBQUMzQyxRQUFJRCxHQUFKLEVBQVMsTUFBTUEsR0FBTjtBQUNULFFBQUlFLGFBQWFELEdBQUdDLFVBQUgsQ0FBY0wsY0FBZCxDQUFqQjtBQUNBSyxlQUFXQyxJQUFYLENBQWdCLEVBQUMsVUFBVVAsUUFBWCxFQUFoQixFQUFzQyxFQUFDLFFBQU8sQ0FBQyxNQUFELENBQVIsRUFBdEMsRUFBeURRLE9BQXpELENBQWlFLFVBQVNKLEdBQVQsRUFBY0ssSUFBZCxFQUFtQjtBQUNsRlAsU0FBR08sSUFBSDtBQUNELEtBRkQ7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RFAsU0FBR08sSUFBSDtBQUNELEtBRkQ7QUFHRCxHQU5EO0FBT0QsQ0FSRCIsImZpbGUiOiJkYlV0aWwuanMiLCJzb3VyY2VSb290IjoiL2FwcCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvZGIgPSByZXF1aXJlKFwibW9uZ29kYlwiKVxudmFyIE1vbmdvQ2xpZW50ID0gbW9uZ29kYi5Nb25nb0NsaWVudFxudmFyIHVybDEgPSBcIm1vbmdvZGI6Ly90aWVuYW5oMjAwNzpEaWVuMTIzNEBkczE1NzA0MC5tbGFiLmNvbTo1NzA0MC9yZW1pbmRlcmJvdFwiO1xuZXhwb3J0cy5nZXRTb3J0ZWRMaXN0ID0gZnVuY3Rpb24oc2VuZGVySUQsIGNvbGxlY3Rpb25OYW1lLCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZCh7XCJ1c2VyaWRcIjogc2VuZGVySUR9LCB7XCJzb3J0XCI6W1wiZGF0ZVwiXX0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKXtcbiAgICAgIGNiKGRvY3MpO1xuICAgIH0pO1xuICB9KVxufVxuZXhwb3J0cy5pbmNyZW1lbnRDb3VudGVyID0gZnVuY3Rpb24oc2VuZGVySUQpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskaW5jOntcImNvdW50ZXJcIjoxfX0pO1xuICB9KVxufVxuZXhwb3J0cy5yZXBsYWNlQ291bnRlciA9IGZ1bmN0aW9uKHZhbHVlLCBzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJVc2VyXCIpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZSh7XCJ1c2VyaWRcIjpzZW5kZXJJRH0seyRzZXQ6e1wiY291bnRlclwiIDogdmFsdWV9fSk7XG4gIH0pXG59XG5leHBvcnRzLmZsaXBDcmVhdGluZyA9IGZ1bmN0aW9uKHZhbHVlLCBzZW5kZXJJRCl7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oXCJVc2VyXCIpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZSh7XCJ1c2VyaWRcIjpzZW5kZXJJRH0seyRzZXQ6e1wiY3JlYXRpbmdcIiA6IHZhbHVlfX0pO1xuICB9KVxufVxuLy9GdW5jdGlvbiBmb3IgZGF0YWJhc2UgKCNkYXRhYmFzZSlcbmV4cG9ydHMuYWRkREIgPSBmdW5jdGlvbihuYW1lLCBvYmplY3QsIHNlbmRlcklELCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24obmFtZSk7XG4gICAgY29sbGVjdGlvbi5pbnNlcnQob2JqZWN0LCBmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgaWYoZXJyKSBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgaWYoY2IpIGNiKGRvY3MpO1xuICAgICAgZGIuY2xvc2UoKTtcbiAgICB9KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0REIgPSBmdW5jdGlvbihuYW1lLCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24obmFtZSk7XG4gICAgY29sbGVjdGlvbi5maW5kKHt9LHtfaWQ6MH0pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCBkb2NzKSB7XG4gICAgICBkYi5jbG9zZSgpO1xuICAgICAgY2IoZG9jcyk7XG4gICAgfSlcbiAgfSlcbn1cbmV4cG9ydHMuY2hhbmdlUmVtaW5kZXIgPSBmdW5jdGlvbihzZW5kZXJJRCwgdmFsdWUpe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKFwiVXNlclwiKTtcbiAgICBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoe1widXNlcmlkXCI6c2VuZGVySUR9LHskc2V0OntcInJlbWluZGVyXCIgOiB2YWx1ZX19KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0UHJvcGVydHkgPSBmdW5jdGlvbihzZW5kZXJJRCwgY29sbGVjdGlvbk5hbWUsIHByb3BlcnR5LCBjYil7XG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsMSwgZnVuY3Rpb24gKGVyciwgZGIpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBlcnJcbiAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgIGNvbGxlY3Rpb24uZmluZE9uZSh7XCJ1c2VyaWRcIjogc2VuZGVySUR9LCBmdW5jdGlvbihlcnIsIHJldCl7XG4gICAgICBjYihyZXRbcHJvcGVydHldKTtcbiAgICB9KTtcbiAgfSlcbn1cbmV4cG9ydHMuZ2V0TGlzdCA9IGZ1bmN0aW9uKHNlbmRlcklELCBjb2xsZWN0aW9uTmFtZSwgY2Ipe1xuICBNb25nb0NsaWVudC5jb25uZWN0KHVybDEsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgaWYgKGVycikgdGhyb3cgZXJyXG4gICAgdmFyIGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbiAgICBjb2xsZWN0aW9uLmZpbmQoe1widXNlcmlkXCI6IHNlbmRlcklEfSkudG9BcnJheShmdW5jdGlvbihlcnIsIGRvY3Mpe1xuICAgICAgY2IoZG9jcyk7XG4gICAgfSk7XG4gIH0pXG59Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "dbUtil.js"
      ],
      "names": [
        "mongodb",
        "require",
        "MongoClient",
        "url1",
        "exports",
        "getSortedList",
        "senderID",
        "collectionName",
        "cb",
        "connect",
        "err",
        "db",
        "collection",
        "find",
        "toArray",
        "docs",
        "incrementCounter",
        "findOneAndUpdate",
        "$inc",
        "replaceCounter",
        "value",
        "$set",
        "flipCreating",
        "addDB",
        "name",
        "object",
        "insert",
        "console",
        "log",
        "close",
        "getDB",
        "_id",
        "changeReminder",
        "getProperty",
        "property",
        "findOne",
        "ret",
        "getList"
      ],
      "mappings": "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",
      "file": "dbUtil.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "const mongodb = require(\"mongodb\")\nvar MongoClient = mongodb.MongoClient\nvar url1 = \"mongodb://tienanh2007:Dien1234@ds157040.mlab.com:57040/reminderbot\";\nexports.getSortedList = function(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}, {\"sort\":[\"date\"]}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}\nexports.incrementCounter = function(senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$inc:{\"counter\":1}});\n  })\n}\nexports.replaceCounter = function(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"counter\" : value}});\n  })\n}\nexports.flipCreating = function(value, senderID){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"creating\" : value}});\n  })\n}\n//Function for database (#database)\nexports.addDB = function(name, object, senderID, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.insert(object, function(err, docs){\n      if(err) console.log(err);\n      if(cb) cb(docs);\n      db.close();\n    });\n  })\n}\nexports.getDB = function(name, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(name);\n    collection.find({},{_id:0}).toArray(function(err, docs) {\n      db.close();\n      cb(docs);\n    })\n  })\n}\nexports.changeReminder = function(senderID, value){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(\"User\");\n    collection.findOneAndUpdate({\"userid\":senderID},{$set:{\"reminder\" : value}});\n  })\n}\nexports.getProperty = function(senderID, collectionName, property, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.findOne({\"userid\": senderID}, function(err, ret){\n      cb(ret[property]);\n    });\n  })\n}\nexports.getList = function(senderID, collectionName, cb){\n  MongoClient.connect(url1, function (err, db) {\n    if (err) throw err\n    var collection = db.collection(collectionName);\n    collection.find({\"userid\": senderID}).toArray(function(err, docs){\n      cb(docs);\n    });\n  })\n}"
      ]
    },
    "mtime": 1520898427000
  },
  "{\"filename\":\"/app/Util.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.26.3": {
    "metadata": {
      "usedHelpers": [],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "./dbUtil",
            "imported": [
              "getList",
              "getProperty",
              "getSortedList"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "getList",
                "local": "getList"
              },
              {
                "kind": "named",
                "imported": "getProperty",
                "local": "getProperty"
              },
              {
                "kind": "named",
                "imported": "getSortedList",
                "local": "getSortedList"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/Util.js",
      "filenameRelative": "/app/Util.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "Util.js",
      "sourceFileName": "Util.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "Util"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _dbUtil = require('./dbUtil');\n\nvar sRequest = require('sync-request');\nexports.nextReminder = function (senderID, cb) {\n  (0, _dbUtil.getList)(senderID, \"Reminder\", function (list) {\n    if (list[0]) {\n      cb(list[0]);\n    } else cb(\"No Reminder\");\n  });\n};\nexports.list = function (senderID, cb) {\n  (0, _dbUtil.getProperty)(senderID, \"User\", \"timezone\", function (timezone) {\n    (0, _dbUtil.getSortedList)(senderID, \"Reminder\", function (list) {\n      var i = 1;\n      var str = \"\";\n      list.forEach(function (reminder) {\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours() + timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\") + \"\\n\";\n        i++;\n      });\n      if (!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n};\nexports.containsObject = function (id, list) {\n  var i;\n  for (i = 0; i < list.length; i++) {\n    if (list[i].userid == id) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexports.checkDate = function (testDate, parts, timezone) {\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours() - timezone);\n  var year = Number(20 + parts.substr(6, 2));\n  var month = Number(parts.substr(0, 2)) - 1;\n  var date = Number(parts.substr(3, 2));\n  var hour = Number(parts.substr(9, 2));\n  var minute = Number(parts.substr(12, 2));\n  if (curDate.getTime() > testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours() + timezone);\n  if (year != testDate.getFullYear() || month != testDate.getMonth() || date != testDate.getDate() || hour != testDate.getHours() || minute != testDate.getMinutes()) {\n    return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n};\nexports.getLocation = function (location) {\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n    timeout: 10000\n  });\n  var data = JSON.parse(res.getBody('utf8'));\n\n  for (var i = 0; i < data.results.length; i++) {\n    var place = { \"name\": data.results[i][\"formatted_address\"],\n      \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n      \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n    };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }\n  return places;\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWwuanMiXSwibmFtZXMiOlsic1JlcXVlc3QiLCJyZXF1aXJlIiwiZXhwb3J0cyIsIm5leHRSZW1pbmRlciIsInNlbmRlcklEIiwiY2IiLCJsaXN0IiwidGltZXpvbmUiLCJpIiwic3RyIiwiZm9yRWFjaCIsInJlbWluZGVyIiwiZGF5IiwiZGF0ZSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwiaG91ciIsImdldEhvdXJzIiwibWludXRlIiwiZ2V0TWludXRlcyIsImNvbnRlbnQiLCJsb2NhdGlvbiIsInVuZGVmaW5lZCIsIkpTT04iLCJwYXJzZSIsIm5hbWUiLCJjb250YWluc09iamVjdCIsImlkIiwibGVuZ3RoIiwidXNlcmlkIiwiY2hlY2tEYXRlIiwidGVzdERhdGUiLCJwYXJ0cyIsImN1ckRhdGUiLCJEYXRlIiwic2V0SG91cnMiLCJOdW1iZXIiLCJzdWJzdHIiLCJnZXRUaW1lIiwiZ2V0TG9jYXRpb24iLCJwbGFjZXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0FQSV9LRVkiLCJyZXMiLCJ0aW1lb3V0IiwiZGF0YSIsImdldEJvZHkiLCJyZXN1bHRzIiwicGxhY2UiLCJwdXNoIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBLElBQU1BLFdBQVdDLFFBQVEsY0FBUixDQUFqQjtBQUNBQyxRQUFRQyxZQUFSLEdBQXVCLFVBQVNDLFFBQVQsRUFBbUJDLEVBQW5CLEVBQXNCO0FBQzNDLHVCQUFRRCxRQUFSLEVBQWtCLFVBQWxCLEVBQThCLFVBQVNFLElBQVQsRUFBYztBQUMxQyxRQUFHQSxLQUFLLENBQUwsQ0FBSCxFQUFXO0FBQ1RELFNBQUdDLEtBQUssQ0FBTCxDQUFIO0FBQ0QsS0FGRCxNQUdLRCxHQUFHLGFBQUg7QUFDTixHQUxEO0FBTUQsQ0FQRDtBQVFBSCxRQUFRSSxJQUFSLEdBQWUsVUFBU0YsUUFBVCxFQUFtQkMsRUFBbkIsRUFBc0I7QUFDbkMsMkJBQVlELFFBQVosRUFBc0Is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M0gsRUFBaUo7QUFDakosV0FBTyx5Q0FBUDtBQUNDO0FBQ0QsU0FBTyx5REFBUDtBQUNELENBZEQ7QUFlQXBCLFFBQVF3QyxXQUFSLEdBQXNCLFVBQVNsQixRQUFULEVBQWtCO0FBQ3RDLE1BQUltQixTQUFTLEVBQWI7QUFDQSxNQUFJQyxNQUFNLHNFQUFzRXBCLFFBQXRFLEdBQWlGLE9BQWpGLEdBQTJGcUIsUUFBUUMsR0FBUixDQUFZQyxjQUFqSDtBQUNBLE1BQUlDLE1BQU1oRCxTQUFTLEtBQVQsRUFBZ0I0QyxHQUFoQixFQUFxQjtBQUNyQkssYUFBUztBQURZLEdBQXJCLENBQVY7QUFHQSxNQUFJQyxPQUFReEIsS0FBS0MsS0FBTCxDQUFXcUIsSUFBSUcsT0FBSixDQUFZLE1BQVosQ0FBWCxDQUFaOztBQUVBLE9BQUssSUFBSTNDLElBQUksQ0FBYixFQUFnQkEsSUFBSTBDLEtBQUtFLE9BQUwsQ0FBYXJCLE1BQWpDLEVBQXlDdkIsR0FBekMsRUFBNkM7QUFDM0MsUUFBSTZDLFFBQVEsRUFBQyxRQUFRSCxLQUFLRSxPQUFMLENBQWE1QyxDQUFiLEVBQWdCLG1CQUFoQixDQUFUO0FBQ0Esa0JBQVkwQyxLQUFLRSxPQUFMLENBQWE1QyxDQUFiLEVBQWdCLFVBQWhCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQXhDLENBRFo7QUFFQSxtQkFBYTBDLEtBQUtFLE9BQUwsQ0FBYTVDLENBQWIsRUFBZ0IsVUFBaEIsRUFBNEIsVUFBNUIsRUFBd0MsS0FBeEM7QUFGYixLQUFaO0FBSUE7QUFDQW1DLFdBQU9XLElBQVAsQ0FBWUQsS0FBWjtBQUNBO0FBQ0Q7QUFDRCxTQUFPVixNQUFQO0FBQ0QsQ0FsQkQiLCJmaWxlIjoiVXRpbC5qcyIsInNvdXJjZVJvb3QiOiIvYXBwIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtnZXRMaXN0LCBnZXRQcm9wZXJ0eSwgZ2V0U29ydGVkTGlzdH0gZnJvbSAnLi9kYlV0aWwnO1xuY29uc3Qgc1JlcXVlc3QgPSByZXF1aXJlKCdzeW5jLXJlcXVlc3QnKTtcbmV4cG9ydHMubmV4dFJlbWluZGVyID0gZnVuY3Rpb24oc2VuZGVySUQsIGNiKXtcbiAgZ2V0TGlzdChzZW5kZXJJRCwgXCJSZW1pbmRlclwiLCBmdW5jdGlvbihsaXN0KXtcbiAgICBpZihsaXN0WzBdKXtcbiAgICAgIGNiKGxpc3RbMF0pO1xuICAgIH0gXG4gICAgZWxzZSBjYihcIk5vIFJlbWluZGVyXCIpO1xuICB9KTtcbn1cbmV4cG9ydHMubGlzdCA9IGZ1bmN0aW9uKHNlbmRlcklELCBjYil7XG4gIGdldFByb3BlcnR5KHNlbmRlcklELCBcIlVzZXJcIiwgXCJ0aW1lem9uZVwiLCBmdW5jdGlvbih0aW1lem9uZSl7XG4gICAgZ2V0U29ydGVkTGlzdChzZW5kZXJJRCwgXCJSZW1pbmRlclwiLCBmdW5jdGlvbihsaXN0KXtcbiAgICAgIHZhciBpID0gMTtcbiAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKHJlbWluZGVyKXtcbiAgICAgICAgdmFyIGRheSA9IHJlbWluZGVyLmRhdGUuZ2V0RGF0ZSgpO1xuICAgICAgICB2YXIgbW9udGggPSByZW1pbmRlci5kYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgICAgICB2YXIgeWVhciA9IHJlbWluZGVyLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgdmFyIGhvdXIgPSByZW1pbmRlci5kYXRlLmdldEhvdXJzKCkrdGltZXpvbmU7XG4gICAgICAgIHZhciBtaW51dGUgPSByZW1pbmRlci5kYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgc3RyICs9IGkgKyBcIi4gQ29udGVudDogXCIgKyByZW1pbmRlci5jb250ZW50ICsgXCJcXG4gICBEYXRlOiBcIiArIG1vbnRoICsgXCIvXCIgKyBkYXkgKyBcIi9cIiArIHllYXIgXG4gICAgICAgICAgKyBcIiBcIiArIGhvdXIgKyBcIjpcIiArIG1pbnV0ZSArIFwiXFxuICAgTG9jYXRpb246IFwiICsgKHJlbWluZGVyLmxvY2F0aW9uICE9PSB1bmRlZmluZWQgPyBKU09OLnBhcnNlKHJlbWluZGVyLmxvY2F0aW9uKS5uYW1lIDogXCJub25lXCIpKyBcIlxcblwiO1xuICAgICAgICBpKys7XG4gICAgICB9KTtcbiAgICAgIGlmKCFzdHIpIHN0ciA9IFwiTm8gcmVtaW5kZXJzXCI7XG4gICAgICBjYihzdHIpO1xuICAgIH0pO1xuICB9KTtcbn1cbmV4cG9ydHMuY29udGFpbnNPYmplY3QgPSBmdW5jdGlvbihpZCwgbGlzdCkge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChsaXN0W2ldLnVzZXJpZCA9PSBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cblxuZXhwb3J0cy5jaGVja0RhdGUgPSBmdW5jdGlvbih0ZXN0RGF0ZSwgcGFydHMsIHRpbWV6b25lKXtcbiAgdmFyIGN1ckRhdGUgPSBuZXcgRGF0ZSgpO1xuICB0ZXN0RGF0ZS5zZXRIb3Vycyh0ZXN0RGF0ZS5nZXRIb3VycygpLXRpbWV6b25lKTtcbiAgdmFyIHllYXIgPSBOdW1iZXIoMjArcGFydHMuc3Vic3RyKDYsMikpO1xuICB2YXIgbW9udGggPSBOdW1iZXIocGFydHMuc3Vic3RyKDAsMikpLTE7XG4gIHZhciBkYXRlID0gTnVtYmVyKHBhcnRzLnN1YnN0cigzLDIpKTtcbiAgdmFyIGhvdXIgPSBOdW1iZXIocGFydHMuc3Vic3RyKDksMikpO1xuICB2YXIgbWludXRlID0gTnVtYmVyKHBhcnRzLnN1YnN0cigxMiwyKSk7XG4gIGlmIChjdXJEYXRlLmdldFRpbWUoKT50ZXN0RGF0ZS5nZXRUaW1lKCkpIHJldHVybiBcIkludmFsaWQgZGF0ZSEgUGxlYXNlIGluc2VydCB0aW1lIGluIHRoZSBmdXR1cmUgZm9yIHlvdXIgcmVtaW5kZXJcIjtcbiAgdGVzdERhdGUuc2V0SG91cnModGVzdERhdGUuZ2V0SG91cnMoKSt0aW1lem9uZSk7XG4gIGlmICh5ZWFyIT10ZXN0RGF0ZS5nZXRGdWxsWWVhcigpfHxtb250aCE9dGVzdERhdGUuZ2V0TW9udGgoKXx8ZGF0ZSE9dGVzdERhdGUuZ2V0RGF0ZSgpfHxob3VyIT10ZXN0RGF0ZS5nZXRIb3VycygpfHxtaW51dGUhPXRlc3REYXRlLmdldE1pbnV0ZXMoKSl7XG4gIHJldHVybiBcIkludmFsaWQgZGF0ZSBmb3JtYXQhIFBsZWFzZSB0eXBlIGFnYWluIVwiO1xuICB9XG4gIHJldHVybiBcIkRvIHlvdSB3YW50IGFkZCBtb3JlIGluZm9ybWF0aW9uPyAoWSBmb3IgeWVzLCBOIGZvciBObylcIjtcbn1cbmV4cG9ydHMuZ2V0TG9jYXRpb24gPSBmdW5jdGlvbihsb2NhdGlvbil7XG4gIHZhciBwbGFjZXMgPSBbXTtcbiAgdmFyIHVybCA9IFwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3BsYWNlL3RleHRzZWFyY2gvanNvbj9xdWVyeT1cIiArIGxvY2F0aW9uICsgXCIma2V5PVwiICsgcHJvY2Vzcy5lbnYuR09PR0xFX0FQSV9LRVk7XG4gIHZhciByZXMgPSBzUmVxdWVzdCgnR0VUJywgdXJsLCB7XG4gICAgICAgICAgICB0aW1lb3V0OiAxMDAwMCAgXG4gICAgICAgIH0pO1xuICB2YXIgZGF0YSA9ICBKU09OLnBhcnNlKHJlcy5nZXRCb2R5KCd1dGY4JykpO1xuICBcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnJlc3VsdHMubGVuZ3RoOyBpKyspe1xuICAgIHZhciBwbGFjZSA9IHtcIm5hbWVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZm9ybWF0dGVkX2FkZHJlc3NcIl0sIFxuICAgICAgICAgICAgICAgIFwibGF0aXR1ZGVcIjogZGF0YS5yZXN1bHRzW2ldW1wiZ2VvbWV0cnlcIl1bXCJsb2NhdGlvblwiXVtcImxhdFwiXSxcbiAgICAgICAgICAgICAgICBcImxvbmdpdHVkZVwiOiBkYXRhLnJlc3VsdHNbaV1bXCJnZW9tZXRyeVwiXVtcImxvY2F0aW9uXCJdW1wibG5nXCJdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAvL3ZhciBtZXNzYWdlSWQgPSBib2R5Lm1lc3NhZ2VfaWQ7XG4gICAgcGxhY2VzLnB1c2gocGxhY2UpO1xuICAgIC8vY29uc29sZS5sb2coXCJTdWNjZXNzZnVsbHkgc2VudCBnZW5lcmljIG1lc3NhZ2Ugd2l0aCBwbGFjZSBcIisgcGxhY2UubmFtZSArIFwiIGxvbmdpdHVkZSA9IFwiICsgcGxhY2UubG9uZ2l0dWRlKTtcbiAgfSAgXG4gIHJldHVybiBwbGFjZXM7XG59Il19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "Util.js"
      ],
      "names": [
        "sRequest",
        "require",
        "exports",
        "nextReminder",
        "senderID",
        "cb",
        "list",
        "timezone",
        "i",
        "str",
        "forEach",
        "reminder",
        "day",
        "date",
        "getDate",
        "month",
        "getMonth",
        "year",
        "getFullYear",
        "hour",
        "getHours",
        "minute",
        "getMinutes",
        "content",
        "location",
        "undefined",
        "JSON",
        "parse",
        "name",
        "containsObject",
        "id",
        "length",
        "userid",
        "checkDate",
        "testDate",
        "parts",
        "curDate",
        "Date",
        "setHours",
        "Number",
        "substr",
        "getTime",
        "getLocation",
        "places",
        "url",
        "process",
        "env",
        "GOOGLE_API_KEY",
        "res",
        "timeout",
        "data",
        "getBody",
        "results",
        "place",
        "push"
      ],
      "mappings": "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",
      "file": "Util.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "import {getList, getProperty, getSortedList} from './dbUtil';\nconst sRequest = require('sync-request');\nexports.nextReminder = function(senderID, cb){\n  getList(senderID, \"Reminder\", function(list){\n    if(list[0]){\n      cb(list[0]);\n    } \n    else cb(\"No Reminder\");\n  });\n}\nexports.list = function(senderID, cb){\n  getProperty(senderID, \"User\", \"timezone\", function(timezone){\n    getSortedList(senderID, \"Reminder\", function(list){\n      var i = 1;\n      var str = \"\";\n      list.forEach(function(reminder){\n        var day = reminder.date.getDate();\n        var month = reminder.date.getMonth() + 1;\n        var year = reminder.date.getFullYear();\n        var hour = reminder.date.getHours()+timezone;\n        var minute = reminder.date.getMinutes();\n        str += i + \". Content: \" + reminder.content + \"\\n   Date: \" + month + \"/\" + day + \"/\" + year \n          + \" \" + hour + \":\" + minute + \"\\n   Location: \" + (reminder.location !== undefined ? JSON.parse(reminder.location).name : \"none\")+ \"\\n\";\n        i++;\n      });\n      if(!str) str = \"No reminders\";\n      cb(str);\n    });\n  });\n}\nexports.containsObject = function(id, list) {\n    var i;\n    for (i = 0; i < list.length; i++) {\n        if (list[i].userid == id) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n\nexports.checkDate = function(testDate, parts, timezone){\n  var curDate = new Date();\n  testDate.setHours(testDate.getHours()-timezone);\n  var year = Number(20+parts.substr(6,2));\n  var month = Number(parts.substr(0,2))-1;\n  var date = Number(parts.substr(3,2));\n  var hour = Number(parts.substr(9,2));\n  var minute = Number(parts.substr(12,2));\n  if (curDate.getTime()>testDate.getTime()) return \"Invalid date! Please insert time in the future for your reminder\";\n  testDate.setHours(testDate.getHours()+timezone);\n  if (year!=testDate.getFullYear()||month!=testDate.getMonth()||date!=testDate.getDate()||hour!=testDate.getHours()||minute!=testDate.getMinutes()){\n  return \"Invalid date format! Please type again!\";\n  }\n  return \"Do you want add more information? (Y for yes, N for No)\";\n}\nexports.getLocation = function(location){\n  var places = [];\n  var url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=\" + location + \"&key=\" + process.env.GOOGLE_API_KEY;\n  var res = sRequest('GET', url, {\n            timeout: 10000  \n        });\n  var data =  JSON.parse(res.getBody('utf8'));\n  \n  for (var i = 0; i < data.results.length; i++){\n    var place = {\"name\": data.results[i][\"formatted_address\"], \n                \"latitude\": data.results[i][\"geometry\"][\"location\"][\"lat\"],\n                \"longitude\": data.results[i][\"geometry\"][\"location\"][\"lng\"]\n                };\n    //var messageId = body.message_id;\n    places.push(place);\n    //console.log(\"Successfully sent generic message with place \"+ place.name + \" longitude = \" + place.longitude);\n  }  \n  return places;\n}"
      ]
    },
    "mtime": 1520898426000
  }
}